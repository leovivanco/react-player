var ReactPlayer=function(e){function t(t){for(var n,i,o=t[0],a=t[1],s=0,c=[];s<o.length;s++)i=o[s],Object.prototype.hasOwnProperty.call(r,i)&&r[i]&&c.push(r[i][0]),r[i]=0;for(n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n]);for(u&&u(t);c.length;)c.shift()()}var n={},r={0:0};function i(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.e=function(){return Promise.resolve()},i.m=e,i.c=n,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i.oe=function(e){throw console.error(e),e};var o=window.webpackJsonpReactPlayer=window.webpackJsonpReactPlayer||[],a=o.push.bind(o);o.push=t,o=o.slice();for(var s=0;s<o.length;s++)t(o[s]);var u=a;return i(i.s=11)}([function(e,t){e.exports=React},function(e,t,n){"use strict";n.d(t,"f",(function(){return d})),n.d(t,"e",(function(){return p})),n.d(t,"h",(function(){return h})),n.d(t,"g",(function(){return y})),n.d(t,"b",(function(){return g})),n.d(t,"d",(function(){return b})),n.d(t,"a",(function(){return w})),n.d(t,"c",(function(){return S})),n.d(t,"i",(function(){return T}));var r=n(7),i=n.n(r);n(5);function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var s=/[?&#](?:start|t)=([0-9hms]+)/,u=/[?&#]end=([0-9hms]+)/,c=/(\d+)(h|m|s)/g,l=/^\d+$/;function f(e,t){if(!(e instanceof Array)){var n=e.match(t);if(n){var r=n[1];if(r.match(c))return function(e){var t=0,n=c.exec(e);for(;null!==n;){var r=o(n,3),i=r[1],a=r[2];"h"===a&&(t+=60*parseInt(i,10)*60),"m"===a&&(t+=60*parseInt(i,10)),"s"===a&&(t+=parseInt(i,10)),n=c.exec(e)}return t}(r);if(l.test(r))return parseInt(r)}}}function d(e){return f(e,s)}function p(e){return f(e,u)}function h(){return Math.random().toString(36).substr(2,5)}function y(e){return Object.keys(e).map((function(t){return"".concat(t,"=").concat(e[t])})).join("&")}function m(e){return window[e]?window[e]:window.exports&&window.exports[e]?window.exports[e]:window.module&&window.module.exports&&window.module.exports[e]?window.module.exports[e]:null}var v={};function g(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){return!0},o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:i.a,a=m(t);return a&&r(a)?Promise.resolve(a):new Promise((function(r,i){if(v[e])v[e].push({resolve:r,reject:i});else{v[e]=[{resolve:r,reject:i}];var a=function(t){v[e].forEach((function(e){return e.resolve(t)}))};if(n){var s=window[n];window[n]=function(){s&&s(),a(m(t))}}o(e,(function(r){r?(v[e].forEach((function(e){return e.reject(r)})),v[e]=null):n||a(m(t))}))}}))}function b(e){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];for(var o=(t=[]).concat.apply(t,r),a={},s=Object.keys(e),u=0,c=s;u<c.length;u++){var l=c[u];-1===o.indexOf(l)&&(a[l]=e[l])}return a}function w(e){var t;if(!this.player||!this.player[e]){var n="ReactPlayer: ".concat(this.constructor.displayName," player could not call %c").concat(e,"%c â€“ ");return this.player?this.player[e]||(n+="The method was not available"):n+="The player was not available",console.warn(n,"font-weight: bold",""),null}for(var r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];return(t=this.player)[e].apply(t,i)}function S(e){return"undefined"!=typeof window&&void 0!==window.MediaStream&&e instanceof window.MediaStream}function T(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.createElement("video"),t=!1===/iPhone|iPod/.test(navigator.userAgent);return e.webkitSupportsPresentationMode&&"function"==typeof e.webkitSetPresentationMode&&t}},function(e,t,n){"use strict";n.d(t,"k",(function(){return a})),n.d(t,"f",(function(){return l})),n.d(t,"j",(function(){return f})),n.d(t,"h",(function(){return d})),n.d(t,"g",(function(){return p})),n.d(t,"d",(function(){return h})),n.d(t,"e",(function(){return y})),n.d(t,"i",(function(){return m})),n.d(t,"a",(function(){return v})),n.d(t,"c",(function(){return b})),n.d(t,"b",(function(){return w})),n.d(t,"l",(function(){return S}));var r=n(1);function i(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,u=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return s=e.done,e},e:function(e){u=!0,a=e},f:function(){try{s||null==n.return||n.return()}finally{if(u)throw a}}}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var a=/(?:youtu\.be\/|youtube(?:-nocookie)?\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))((\w|-){11})|youtube\.com\/playlist\?list=|youtube\.com\/user\//,s=/(?:soundcloud\.com|snd\.sc)\/[^.]+$/,u=/vimeo\.com\/.+/,c=/^https?:\/\/(www\.)?facebook\.com.*\/(video(s)?|watch|story)(\.php?|\/).+$/,l=/streamable\.com\/([a-z0-9]+)$/,f=/(?:wistia\.com|wi\.st)\/(?:medias|embed)\/(.*)$/,d=/(?:www\.|go\.)?twitch\.tv\/videos\/(\d+)($|\?)/,p=/(?:www\.|go\.)?twitch\.tv\/([a-zA-Z0-9_]+)($|\?)/,h=/^(?:(?:https?):)?(?:\/\/)?(?:www\.)?(?:(?:dailymotion\.com(?:\/embed)?\/video)|dai\.ly)\/([a-zA-Z0-9]+)(?:_[\w_-]+)?$/,y=/mixcloud\.com\/([^/]+\/[^/]+)/,m=/vidyard.com\/(?:watch\/)?([a-zA-Z0-9-]+)/,v=/\.(m4a|mp4a|mpga|mp2|mp2a|mp3|m2a|m3a|wav|weba|aac|oga|spx)($|\?)/i,g=/\.(mp4|og[gv]|webm|mov|m4v)($|\?)/i,b=/\.(m3u8)($|\?)/i,w=/\.(mpd)($|\?)/i,S={youtube:function(e){return e instanceof Array?e.every((function(e){return a.test(e)})):a.test(e)},soundcloud:function(e){return s.test(e)&&!v.test(e)},vimeo:function(e){return u.test(e)&&!g.test(e)&&!b.test(e)},facebook:function(e){return c.test(e)},streamable:function(e){return l.test(e)},wistia:function(e){return f.test(e)},twitch:function(e){return d.test(e)||p.test(e)},dailymotion:function(e){return h.test(e)},mixcloud:function(e){return y.test(e)},vidyard:function(e){return m.test(e)},file:function e(t){if(t instanceof Array){var n,o=i(t);try{for(o.s();!(n=o.n()).done;){var a=n.value;if("string"==typeof a&&e(a))return!0;if(e(a.src))return!0}}catch(e){o.e(e)}finally{o.f()}return!1}return!!Object(r.c)(t)||(v.test(t)||g.test(t)||b.test(t)||w.test(t))}}},function(e,t,n){e.exports=n(8)()},function(e,t){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var r="undefined"!=typeof Element,i="function"==typeof Map,o="function"==typeof Set,a="function"==typeof ArrayBuffer&&!!ArrayBuffer.isView;e.exports=function(e,t){try{return function e(t,s){if(t===s)return!0;if(t&&s&&"object"==n(t)&&"object"==n(s)){if(t.constructor!==s.constructor)return!1;var u,c,l,f;if(Array.isArray(t)){if((u=t.length)!=s.length)return!1;for(c=u;0!=c--;)if(!e(t[c],s[c]))return!1;return!0}if(i&&t instanceof Map&&s instanceof Map){if(t.size!==s.size)return!1;for(f=t.entries();!(c=f.next()).done;)if(!s.has(c.value[0]))return!1;for(f=t.entries();!(c=f.next()).done;)if(!e(c.value[1],s.get(c.value[0])))return!1;return!0}if(o&&t instanceof Set&&s instanceof Set){if(t.size!==s.size)return!1;for(f=t.entries();!(c=f.next()).done;)if(!s.has(c.value[0]))return!1;return!0}if(a&&ArrayBuffer.isView(t)&&ArrayBuffer.isView(s)){if((u=t.length)!=s.length)return!1;for(c=u;0!=c--;)if(t[c]!==s[c])return!1;return!0}if(t.constructor===RegExp)return t.source===s.source&&t.flags===s.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===s.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===s.toString();if((u=(l=Object.keys(t)).length)!==Object.keys(s).length)return!1;for(c=u;0!=c--;)if(!Object.prototype.hasOwnProperty.call(s,l[c]))return!1;if(r&&t instanceof Element)return!1;for(c=u;0!=c--;)if(("_owner"!==l[c]&&"__v"!==l[c]&&"__o"!==l[c]||!t.$$typeof)&&!e(t[l[c]],s[l[c]]))return!1;return!0}return t!=t&&s!=s}(e,t)}catch(e){if((e.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw e}}},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var i=function(e){return function(e){return!!e&&"object"===r(e)}(e)&&!function(e){var t=Object.prototype.toString.call(e);return"[object RegExp]"===t||"[object Date]"===t||function(e){return e.$$typeof===o}(e)}(e)};var o="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function a(e,t){return!1!==t.clone&&t.isMergeableObject(e)?f((n=e,Array.isArray(n)?[]:{}),e,t):e;var n}function s(e,t,n){return e.concat(t).map((function(e){return a(e,n)}))}function u(e){return Object.keys(e).concat(function(e){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e).filter((function(t){return e.propertyIsEnumerable(t)})):[]}(e))}function c(e,t){try{return t in e}catch(e){return!1}}function l(e,t,n){var r={};return n.isMergeableObject(e)&&u(e).forEach((function(t){r[t]=a(e[t],n)})),u(t).forEach((function(i){(function(e,t){return c(e,t)&&!(Object.hasOwnProperty.call(e,t)&&Object.propertyIsEnumerable.call(e,t))})(e,i)||(c(e,i)&&n.isMergeableObject(t[i])?r[i]=function(e,t){if(!t.customMerge)return f;var n=t.customMerge(e);return"function"==typeof n?n:f}(i,n)(e[i],t[i],n):r[i]=a(t[i],n))})),r}function f(e,t,n){(n=n||{}).arrayMerge=n.arrayMerge||s,n.isMergeableObject=n.isMergeableObject||i,n.cloneUnlessOtherwiseSpecified=a;var r=Array.isArray(t);return r===Array.isArray(e)?r?n.arrayMerge(e,t,n):l(e,t,n):a(t,n)}f.all=function(e,t){if(!Array.isArray(e))throw new Error("first argument should be an array");return e.reduce((function(e,n){return f(e,n,t)}),{})};var d=f;e.exports=d},function(e,t,n){(function(e){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}
/*
 @license
 Shaka Player
 Copyright 2016 Google LLC
 SPDX-License-Identifier: Apache-2.0
*/!function(){var r="undefined"!=typeof window?window:e,i={};for(var o in function(e,t,r){var i,o="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){e!=Array.prototype&&e!=Object.prototype&&(e[t]=n.value)},a=void 0!==e&&e===this?this:void 0!==t&&null!=t?t:this;function s(){s=function(){},a.Symbol||(a.Symbol=c)}var u,c=(u=0,function(e){return"jscomp_symbol_"+(e||"")+u++});function l(){s();var e=a.Symbol.iterator;e||(e=a.Symbol.iterator=a.Symbol("iterator")),"function"!=typeof Array.prototype[e]&&o(Array.prototype,e,{configurable:!0,writable:!0,value:function(){return f(this)}}),l=function(){}}function f(e){var t=0;return d((function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}))}function d(e){return l(),(e={next:e})[a.Symbol.iterator]=function(){return this},e}function p(e){l();var t=e[Symbol.iterator];return t?t.call(e):f(e)}function h(e,t){if(t){for(var n=a,r=e.split("."),i=0;i<r.length-1;i++){var s=r[i];s in n||(n[s]={}),n=n[s]}(s=t(i=n[r=r[r.length-1]]))!=i&&null!=s&&o(n,r,{configurable:!0,writable:!0,value:s})}}function y(e){return function(e){function t(t){return e.next(t)}function n(t){return e.throw(t)}return new Promise((function(r,i){!function e(o){o.done?r(o.value):Promise.resolve(o.value).then(t,n).then(e,i)}(e.next())}))}(e())}h("Promise",(function(e){function t(e){this.b=0,this.g=void 0,this.a=[];var t=this.c();try{e(t.resolve,t.reject)}catch(e){t.reject(e)}}function r(){this.a=null}function i(e){return e instanceof t?e:new t((function(t){t(e)}))}if(e)return e;r.prototype.b=function(e){null==this.a&&(this.a=[],this.f()),this.a.push(e)},r.prototype.f=function(){var e=this;this.c((function(){e.h()}))};var o=a.setTimeout;r.prototype.c=function(e){o(e,0)},r.prototype.h=function(){for(;this.a&&this.a.length;){var e=this.a;this.a=[];for(var t=0;t<e.length;++t){var n=e[t];e[t]=null;try{n()}catch(e){this.g(e)}}}this.a=null},r.prototype.g=function(e){this.c((function(){throw e}))},t.prototype.c=function(){function e(e){return function(r){n||(n=!0,e.call(t,r))}}var t=this,n=!1;return{resolve:e(this.u),reject:e(this.f)}},t.prototype.u=function(e){if(e===this)this.f(new TypeError("A Promise cannot resolve to itself"));else if(e instanceof t)this.v(e);else{e:switch(n(e)){case"object":var r=null!=e;break e;case"function":r=!0;break e;default:r=!1}r?this.o(e):this.h(e)}},t.prototype.o=function(e){var t=void 0;try{t=e.then}catch(e){return void this.f(e)}"function"==typeof t?this.F(t,e):this.h(e)},t.prototype.f=function(e){this.i(2,e)},t.prototype.h=function(e){this.i(1,e)},t.prototype.i=function(e,t){if(0!=this.b)throw Error("Cannot settle("+e+", "+t+"): Promise already settled in state"+this.b);this.b=e,this.g=t,this.l()},t.prototype.l=function(){if(null!=this.a){for(var e=0;e<this.a.length;++e)s.b(this.a[e]);this.a=null}};var s=new r;return t.prototype.v=function(e){var t=this.c();e.kc(t.resolve,t.reject)},t.prototype.F=function(e,t){var n=this.c();try{e.call(t,n.resolve,n.reject)}catch(e){n.reject(e)}},t.prototype.then=function(e,n){function r(e,t){return"function"==typeof e?function(t){try{i(e(t))}catch(e){o(e)}}:t}var i,o,a=new t((function(e,t){i=e,o=t}));return this.kc(r(e,i),r(n,o)),a},t.prototype.catch=function(e){return this.then(void 0,e)},t.prototype.kc=function(e,t){function n(){switch(r.b){case 1:e(r.g);break;case 2:t(r.g);break;default:throw Error("Unexpected state: "+r.b)}}var r=this;null==this.a?s.b(n):this.a.push(n)},t.resolve=i,t.reject=function(e){return new t((function(t,n){n(e)}))},t.race=function(e){return new t((function(t,n){for(var r=p(e),o=r.next();!o.done;o=r.next())i(o.value).kc(t,n)}))},t.all=function(e){var n=p(e),r=n.next();return r.done?i([]):new t((function(e,t){function o(t){return function(n){a[t]=n,0==--s&&e(a)}}var a=[],s=0;do{a.push(void 0),s++,i(r.value).kc(o(a.length-1),t),r=n.next()}while(!r.done)}))},t})),h("Promise.prototype.finally",(function(e){return e||function(e){return this.then((function(t){return Promise.resolve(e()).then((function(){return t}))}),(function(t){return Promise.resolve(e()).then((function(){throw t}))}))}}));var m,v="function"==typeof Object.create?Object.create:function(e){function t(){}return t.prototype=e,new t};if("function"==typeof Object.setPrototypeOf)m=Object.setPrototypeOf;else{var g;e:{var b={};try{b.__proto__={Ne:!0},g=b.Ne;break e}catch(u){}g=!1}m=g?function(e,t){if(e.__proto__=t,e.__proto__!==t)throw new TypeError(e+" is not extensible");return e}:null}var w=m;function S(e,t){if(e.prototype=v(t.prototype),e.prototype.constructor=e,w)w(e,t);else for(var n in t)if("prototype"!=n)if(Object.defineProperties){var r=Object.getOwnPropertyDescriptor(t,n);r&&Object.defineProperty(e,n,r)}else e[n]=t[n];e.Dg=t.prototype}function T(){this.g=!1,this.c=null,this.s=void 0,this.j=1,this.b=this.f=0,this.i=this.a=null}function E(e){if(e.g)throw new TypeError("Generator is already running");e.g=!0}function P(e,t){e.a={Yd:t,ie:!0},e.j=e.f||e.b}function k(e,t,n){return e.j=n,{value:t}}function x(e){e.j=0}function A(e,t,n){e.f=t,null!=n&&(e.b=n)}function O(e,t){e.f=0,e.b=t||0}function M(e,t){e.j=t,e.f=0}function I(e){e.f=0;var t=e.a.Yd;return e.a=null,t}function R(e){e.i=[e.a],e.f=0,e.b=0}function C(e,t){var n=e.i.splice(0)[0];(n=e.a=e.a||n)?n.ie?e.j=e.f||e.b:null!=n.C&&e.b<n.C?(e.j=n.C,e.a=null):e.j=e.b:e.j=t}function D(e){this.a=new T,this.b=e}function j(e,t,n,r){try{var i=t.call(e.a.c,n);if(!(i instanceof Object))throw new TypeError("Iterator result "+i+" is not an object");if(!i.done)return e.a.g=!1,i;var o=i.value}catch(t){return e.a.c=null,P(e.a,t),N(e)}return e.a.c=null,r.call(e.a,o),N(e)}function N(e){for(;e.a.j;)try{var t=e.b(e.a);if(t)return e.a.g=!1,{value:t.value,done:!1}}catch(t){e.a.s=void 0,P(e.a,t)}if(e.a.g=!1,e.a.a){if(t=e.a.a,e.a.a=null,t.ie)throw t.Yd;return{value:t.return,done:!0}}return{value:void 0,done:!0}}function _(e){this.next=function(t){return E(e.a),e.a.c?t=j(e,e.a.c.next,t,e.a.h):(e.a.h(t),t=N(e)),t},this.throw=function(t){return E(e.a),e.a.c?t=j(e,e.a.c.throw,t,e.a.h):(P(e.a,t),t=N(e)),t},this.return=function(t){return function(e,t){E(e.a);var n=e.a.c;return n?j(e,"return"in n?n.return:function(e){return{value:e,done:!0}},t,e.a.return):(e.a.return(t),N(e))}(e,t)},l(),this[Symbol.iterator]=function(){return this}}function L(e,t){return _.prototype=e.prototype,new _(new D(t))}function U(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function K(e,t,n){e instanceof String&&(e=String(e));for(var r=e.length,i=0;i<r;i++){var o=e[i];if(t.call(n,o,i,e))return{fe:i,Ie:o}}return{fe:-1,Ie:void 0}}function B(e,t,n){if(null==e)throw new TypeError("The 'this' value for String.prototype."+n+" must not be null or undefined");if(t instanceof RegExp)throw new TypeError("First argument to String.prototype."+n+" must not be a regular expression");return e+""}T.prototype.h=function(e){this.s=e},T.prototype.return=function(e){this.a={return:e},this.j=this.b},T.prototype.C=function(e){this.j=e},h("WeakMap",(function(e){function t(e){if(this.a=(a+=Math.random()+1).toString(),e){s(),l(),e=p(e);for(var t;!(t=e.next()).done;)t=t.value,this.set(t[0],t[1])}}function n(e){U(e,i)||o(e,i,{value:{}})}function r(e){var t=Object[e];t&&(Object[e]=function(e){return n(e),t(e)})}if(function(){if(!e||!Object.seal)return!1;try{var t=Object.seal({}),n=Object.seal({}),r=new e([[t,2],[n,3]]);return 2==r.get(t)&&3==r.get(n)&&(r.delete(t),r.set(n,4),!r.has(t)&&4==r.get(n))}catch(e){return!1}}())return e;var i="$jscomp_hidden_"+Math.random();r("freeze"),r("preventExtensions"),r("seal");var a=0;return t.prototype.set=function(e,t){if(n(e),!U(e,i))throw Error("WeakMap key fail: "+e);return e[i][this.a]=t,this},t.prototype.get=function(e){return U(e,i)?e[i][this.a]:void 0},t.prototype.has=function(e){return U(e,i)&&U(e[i],this.a)},t.prototype.delete=function(e){return!(!U(e,i)||!U(e[i],this.a))&&delete e[i][this.a]},t})),h("Map",(function(e){function t(){var e={};return e.Ja=e.next=e.head=e}function r(e,t){var n=e.a;return d((function(){if(n){for(;n.head!=e.a;)n=n.Ja;for(;n.next!=n.head;)return n=n.next,{done:!1,value:t(n)};n=null}return{done:!0,value:void 0}}))}function i(e,t){var r=t&&n(t);"object"==r||"function"==r?a.has(t)?r=a.get(t):(r=""+ ++u,a.set(t,r)):r="p_"+t;var i=e.b[r];if(i&&U(e.b,r))for(var o=0;o<i.length;o++){var s=i[o];if(t!=t&&s.key!=s.key||t===s.key)return{id:r,list:i,index:o,ba:s}}return{id:r,list:i,index:-1,ba:void 0}}function o(e){if(this.b={},this.a=t(),this.size=0,e){e=p(e);for(var n;!(n=e.next()).done;)n=n.value,this.set(n[0],n[1])}}if(function(){if(!e||"function"!=typeof e||!e.prototype.entries||"function"!=typeof Object.seal)return!1;try{var t=Object.seal({x:4}),n=new e(p([[t,"s"]]));if("s"!=n.get(t)||1!=n.size||n.get({x:4})||n.set({x:4},"t")!=n||2!=n.size)return!1;var r=n.entries(),i=r.next();return!i.done&&i.value[0]==t&&"s"==i.value[1]&&!((i=r.next()).done||4!=i.value[0].x||"t"!=i.value[1]||!r.next().done)}catch(e){return!1}}())return e;s(),l();var a=new WeakMap;o.prototype.set=function(e,t){var n=i(this,e);return n.list||(n.list=this.b[n.id]=[]),n.ba?n.ba.value=t:(n.ba={next:this.a,Ja:this.a.Ja,head:this.a,key:e,value:t},n.list.push(n.ba),this.a.Ja.next=n.ba,this.a.Ja=n.ba,this.size++),this},o.prototype.delete=function(e){return!(!(e=i(this,e)).ba||!e.list)&&(e.list.splice(e.index,1),e.list.length||delete this.b[e.id],e.ba.Ja.next=e.ba.next,e.ba.next.Ja=e.ba.Ja,e.ba.head=null,this.size--,!0)},o.prototype.clear=function(){this.b={},this.a=this.a.Ja=t(),this.size=0},o.prototype.has=function(e){return!!i(this,e).ba},o.prototype.get=function(e){return(e=i(this,e).ba)&&e.value},o.prototype.entries=function(){return r(this,(function(e){return[e.key,e.value]}))},o.prototype.keys=function(){return r(this,(function(e){return e.key}))},o.prototype.values=function(){return r(this,(function(e){return e.value}))},o.prototype.forEach=function(e,t){for(var n,r=this.entries();!(n=r.next()).done;)n=n.value,e.call(t,n[1],n[0],this)},o.prototype[Symbol.iterator]=o.prototype.entries;var u=0;return o})),h("Set",(function(e){function t(e){if(this.a=new Map,e){e=p(e);for(var t;!(t=e.next()).done;)this.add(t.value)}this.size=this.a.size}return function(){if(!e||"function"!=typeof e||!e.prototype.entries||"function"!=typeof Object.seal)return!1;try{var t=Object.seal({x:4}),n=new e(p([t]));if(!n.has(t)||1!=n.size||n.add(t)!=n||1!=n.size||n.add({x:4})!=n||2!=n.size)return!1;var r=n.entries(),i=r.next();return!i.done&&i.value[0]==t&&i.value[1]==t&&(!(i=r.next()).done&&i.value[0]!=t&&4==i.value[0].x&&i.value[1]==i.value[0]&&r.next().done)}catch(e){return!1}}()?e:(s(),l(),t.prototype.add=function(e){return this.a.set(e,e),this.size=this.a.size,this},t.prototype.delete=function(e){return e=this.a.delete(e),this.size=this.a.size,e},t.prototype.clear=function(){this.a.clear(),this.size=0},t.prototype.has=function(e){return this.a.has(e)},t.prototype.entries=function(){return this.a.entries()},t.prototype.values=function(){return this.a.values()},t.prototype.keys=t.prototype.values,t.prototype[Symbol.iterator]=t.prototype.values,t.prototype.forEach=function(e,t){var n=this;this.a.forEach((function(r){return e.call(t,r,r,n)}))},t)})),h("Array.prototype.findIndex",(function(e){return e||function(e,t){return K(this,e,t).fe}})),h("Array.prototype.keys",(function(e){return e||function(){return function(e,t){l(),e instanceof String&&(e+="");var n=0,r={next:function(){if(n<e.length){var i=n++;return{value:t(i,e[i]),done:!1}}return r.next=function(){return{done:!0,value:void 0}},r.next()}};return r[Symbol.iterator]=function(){return r},r}(this,(function(e){return e}))}})),h("Object.is",(function(e){return e||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}})),h("Array.prototype.includes",(function(e){return e||function(e,t){var n=this;n instanceof String&&(n=String(n));var r=n.length,i=t||0;for(0>i&&(i=Math.max(i+r,0));i<r;i++){var o=n[i];if(o===e||Object.is(o,e))return!0}return!1}})),h("String.prototype.includes",(function(e){return e||function(e,t){return-1!==B(this,e,"includes").indexOf(e,t||0)}})),h("Array.from",(function(e){return e||function(e,t,n){l(),t=null!=t?t:function(e){return e};var r=[],i=e[Symbol.iterator];if("function"==typeof i)for(e=i.call(e);!(i=e.next()).done;)r.push(t.call(n,i.value));else{i=e.length;for(var o=0;o<i;o++)r.push(t.call(n,e[o]))}return r}})),h("String.prototype.startsWith",(function(e){return e||function(e,t){for(var n=B(this,e,"startsWith"),r=n.length,i=e.length,o=Math.max(0,Math.min(0|t,n.length)),a=0;a<i&&o<r;)if(n[o++]!=e[a++])return!1;return a>=i}})),h("Array.prototype.find",(function(e){return e||function(e,t){return K(this,e,t).Ie}}));var V="function"==typeof Object.assign?Object.assign:function(e,t){for(var n=1;n<arguments.length;n++){var r=arguments[n];if(r)for(var i in r)U(r,i)&&(e[i]=r[i])}return e};h("Object.assign",(function(e){return e||V}));var F=this;function H(e,t){var n,r=e.split("."),i=F;r[0]in i||!i.execScript||i.execScript("var "+r[0]);for(;r.length&&(n=r.shift());)r.length||void 0===t?i=i[n]?i[n]:i[n]={}:i[n]=t}function z(e,t){function n(){}n.prototype=t.prototype,e.Dg=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Og=function(e,n,r){return t.prototype[n].apply(e,Array.prototype.slice.call(arguments,2))}}function q(e){this.c=Math.exp(Math.log(.5)/e),this.b=this.a=0}function G(e,t,n){var r=Math.pow(e.c,t);n=n*(1-r)+r*e.a,isNaN(n)||(e.a=n,e.b+=t)}function W(e){return e.a/(1-Math.pow(e.c,e.b))}function X(){this.b=new q(2),this.c=new q(5),this.a=0}F.a=!0,X.prototype.getBandwidthEstimate=function(e){return 128e3>this.a?e:Math.min(W(this.b),W(this.c))};var Y={mb:0,jc:function(){},Z:function(){},error:function(){},m:function(){},info:function(){},debug:function(){},D:function(){},J:function(){}};e.console&&e.console.log.bind&&(Y.Z=console.warn.bind(console),Y.jc=console.error.bind(console),1<=Y.mb&&(Y.error=console.error.bind(console)),2<=Y.mb&&(Y.m=console.warn.bind(console)),3<=Y.mb&&(Y.info=console.info.bind(console)),4<=Y.mb&&(Y.debug=console.log.bind(console)),5<=Y.mb&&(Y.D=console.debug.bind(console)),6<=Y.mb&&(Y.J=console.debug.bind(console)));
/*
    @license
    Copyright 2008 The Closure Library Authors
    SPDX-License-Identifier: Apache-2.0
    */
var $=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#(.*))?$/;
/*
    @license
    Copyright 2006 The Closure Library Authors
    SPDX-License-Identifier: Apache-2.0
    */function J(e){var t;e instanceof J?(Q(this,e.xa),this.jb=e.jb,this.wa=e.wa,Z(this,e.Jb),this.la=e.la,ee(this,e.a.clone()),this.Xa=e.Xa):e&&(t=String(e).match($))?(Q(this,t[1]||"",!0),this.jb=te(t[2]||""),this.wa=te(t[3]||"",!0),Z(this,t[4]),this.la=te(t[5]||"",!0),ee(this,t[6]||"",!0),this.Xa=te(t[7]||"")):this.a=new ce(null)}function Q(e,t,n){e.xa=n?te(t,!0):t,e.xa&&(e.xa=e.xa.replace(/:$/,""))}function Z(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.Jb=t}else e.Jb=null}function ee(e,t,n){t instanceof ce?e.a=t:(n||(t=ne(t,se)),e.a=new ce(t))}function te(e,t){return e?t?decodeURI(e):decodeURIComponent(e):""}function ne(e,t,n){return"string"==typeof e?(e=encodeURI(e).replace(t,re),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function re(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}(i=J.prototype).xa="",i.jb="",i.wa="",i.Jb=null,i.la="",i.Xa="",i.toString=function(){var e=[],t=this.xa;if(t&&e.push(ne(t,ie,!0),":"),t=this.wa){e.push("//");var n=this.jb;n&&e.push(ne(n,ie,!0),"@"),e.push(encodeURIComponent(t).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(t=this.Jb)&&e.push(":",String(t))}return(t=this.la)&&(this.wa&&"/"!=t.charAt(0)&&e.push("/"),e.push(ne(t,"/"==t.charAt(0)?ae:oe,!0))),(t=this.a.toString())&&e.push("?",t),(t=this.Xa)&&e.push("#",ne(t,ue)),e.join("")},i.resolve=function(e){var t=this.clone();"data"===t.xa&&(t=new J);var n=!!e.xa;n?Q(t,e.xa):n=!!e.jb,n?t.jb=e.jb:n=!!e.wa,n?t.wa=e.wa:n=null!=e.Jb;var r=e.la;if(n)Z(t,e.Jb);else if(n=!!e.la){if("/"!=r.charAt(0))if(this.wa&&!this.la)r="/"+r;else{var i=t.la.lastIndexOf("/");-1!=i&&(r=t.la.substr(0,i+1)+r)}if(".."==r||"."==r)r="";else if(-1!=r.indexOf("./")||-1!=r.indexOf("/.")){i=0==r.lastIndexOf("/",0),r=r.split("/");for(var o=[],a=0;a<r.length;){var s=r[a++];"."==s?i&&a==r.length&&o.push(""):".."==s?((1<o.length||1==o.length&&""!=o[0])&&o.pop(),i&&a==r.length&&o.push("")):(o.push(s),i=!0)}r=o.join("/")}}return n?t.la=r:n=""!==e.a.toString(),n?ee(t,e.a.clone()):n=!!e.Xa,n&&(t.Xa=e.Xa),t},i.clone=function(){return new J(this)};var ie=/[#\/\?@]/g,oe=/[#\?:]/g,ae=/[#\?]/g,se=/[#\?@]/g,ue=/#/g;function ce(e){this.a=e||null}function le(e){this.b=e,this.a=null}function fe(e){this.b=e,this.a=null}function de(e,t){var n={maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:0};this.i=null==e.maxAttempts?n.maxAttempts:e.maxAttempts,this.f=null==e.baseDelay?n.baseDelay:e.baseDelay,this.h=null==e.fuzzFactor?n.fuzzFactor:e.fuzzFactor,this.g=null==e.backoffFactor?n.backoffFactor:e.backoffFactor,this.a=0,this.b=this.f,(this.c=void 0!==t&&t)&&(this.a=1)}function pe(e){return y((function t(){var n,r;return L(t,(function(t){switch(t.j){case 1:if(e.a>=e.i){if(!e.c)return t.return(Promise.reject());e.a=1,e.b=e.f}return n=e.a,e.a++,0==n?t.return():(r=e.b*(1+(2*Math.random()-1)*e.h),k(t,new Promise((function(e){new fe(e).T(r/1e3)})),2));case 2:e.b*=e.g,x(t)}}))}))}function he(e,t,n,r){for(var i=[],o=3;o<arguments.length;++o)i[o-3]=arguments[o];this.severity=e,this.category=t,this.code=n,this.data=i,this.handled=!1}function ye(){var e,t,n=new Promise((function(n,r){e=n,t=r}));return n.resolve=e,n.reject=t,n}function me(e,t){this.promise=e,this.me=t,this.a=!1}function ve(e){return new me(Promise.reject(e),(function(){return Promise.resolve()}))}function ge(){var e=Promise.reject(new he(2,7,7001));return e.catch((function(){})),new me(e,(function(){return Promise.resolve()}))}function be(e){return new me(Promise.resolve(e),(function(){return Promise.resolve()}))}function we(e){return new me(e,(function(){return e.catch((function(){}))}))}function Se(e){return new me(Promise.all(e.map((function(e){return e.promise}))),(function(){return Promise.all(e.map((function(e){return e.abort()})))}))}function Te(t,n){for(var r in n=void 0===n?{}:n)this[r]=n[r];this.defaultPrevented=this.cancelable=this.bubbles=!1,this.timeStamp=e.performance&&e.performance.now?e.performance.now():Date.now(),this.type=t,this.isTrusted=!1,this.target=this.currentTarget=null,this.a=!1}function Ee(){this.a={}}function Pe(){this.Sc=new Ee,this.gc=this}function ke(e){var t=new Set;return function e(r){switch(n(r)){case"undefined":case"boolean":case"number":case"string":case"symbol":case"function":return r;default:if(!r||r.buffer&&r.buffer.constructor==ArrayBuffer)return r;if(t.has(r))return null;var i=r.constructor==Array;if(r.constructor!=Object&&!i)return null;t.add(r);var o,a=i?[]:{};for(o in r)a[o]=e(r[o]);return i&&(a.length=r.length),a}}(e)}function xe(e,t){return!("number"!=typeof e||"number"!=typeof t||!isNaN(e)||!isNaN(t))||e===t}function Ae(e,t){var n=e.indexOf(t);-1<n&&e.splice(n,1)}function Oe(e,t,n){if(n||(n=xe),e.length!=t.length)return!1;t=t.slice();for(var r={},i=(e=p(e)).next();!i.done;r={item:r.item},i=e.next()){if(r.item=i.value,-1==(i=t.findIndex(function(e){return function(t){return n(e.item,t)}}(r))))return!1;t[i]=t[t.length-1],t.pop()}return 0==t.length}function Me(){this.a=[]}function Ie(e,t){e.a.push(t.finally((function(){Ae(e.a,t)})))}function Re(e){Pe.call(this),this.f=!1,this.g=new Me,this.a=new Set,this.b=new Set,this.c=e||null}(i=ce.prototype).ja=null,i.nc=null,i.add=function(e,t){if(!this.ja&&(this.ja={},this.nc=0,this.a))for(var n=this.a.split("&"),r=0;r<n.length;r++){var i=n[r].indexOf("="),o=null;if(0<=i){var a=n[r].substring(0,i);o=n[r].substring(i+1)}else a=n[r];a=decodeURIComponent(a.replace(/\+/g," ")),o=o||"",this.add(a,decodeURIComponent(o.replace(/\+/g," ")))}return this.a=null,(n=this.ja.hasOwnProperty(e)&&this.ja[e])||(this.ja[e]=n=[]),n.push(t),this.nc++,this},i.toString=function(){if(this.a)return this.a;if(!this.ja)return"";var e,t=[];for(e in this.ja)for(var n=encodeURIComponent(e),r=this.ja[e],i=0;i<r.length;i++){var o=n;""!==r[i]&&(o+="="+encodeURIComponent(r[i])),t.push(o)}return this.a=t.join("&")},i.clone=function(){var e=new ce;if(e.a=this.a,this.ja){var t,n={};for(t in this.ja)n[t]=this.ja[t].concat();e.ja=n,e.nc=this.nc}return e},le.prototype.T=function(t){var n=this;this.stop();var r=!0,i=null;return this.a=function(){e.clearTimeout(i),r=!1},i=e.setTimeout((function(){r&&n.b()}),1e3*t),this},le.prototype.stop=function(){this.a&&(this.a(),this.a=null)},H("shaka.util.Timer",fe),fe.prototype.Gc=function(){return this.stop(),this.b(),this},fe.prototype.tickNow=fe.prototype.Gc,fe.prototype.T=function(e){var t=this;return this.stop(),this.a=new le((function(){t.b()})).T(e),this},fe.prototype.tickAfter=fe.prototype.T,fe.prototype.Ra=function(e){var t=this;return this.stop(),this.a=new le((function(){t.a.T(e),t.b()})).T(e),this},fe.prototype.tickEvery=fe.prototype.Ra,fe.prototype.stop=function(){this.a&&(this.a.stop(),this.a=null)},fe.prototype.stop=fe.prototype.stop,H("shaka.util.Error",he),he.prototype.toString=function(){return"shaka.util.Error "+JSON.stringify(this,null,"  ")},he.Severity={RECOVERABLE:1,CRITICAL:2},he.Category={NETWORK:1,TEXT:2,MEDIA:3,MANIFEST:4,STREAMING:5,DRM:6,PLAYER:7,CAST:8,STORAGE:9},he.Code={UNSUPPORTED_SCHEME:1e3,BAD_HTTP_STATUS:1001,HTTP_ERROR:1002,TIMEOUT:1003,MALFORMED_DATA_URI:1004,UNKNOWN_DATA_URI_ENCODING:1005,REQUEST_FILTER_ERROR:1006,RESPONSE_FILTER_ERROR:1007,MALFORMED_TEST_URI:1008,UNEXPECTED_TEST_REQUEST:1009,INVALID_TEXT_HEADER:2e3,INVALID_TEXT_CUE:2001,UNABLE_TO_DETECT_ENCODING:2003,BAD_ENCODING:2004,INVALID_XML:2005,INVALID_MP4_TTML:2007,INVALID_MP4_VTT:2008,UNABLE_TO_EXTRACT_CUE_START_TIME:2009,BUFFER_READ_OUT_OF_BOUNDS:3e3,JS_INTEGER_OVERFLOW:3001,EBML_OVERFLOW:3002,EBML_BAD_FLOATING_POINT_SIZE:3003,MP4_SIDX_WRONG_BOX_TYPE:3004,MP4_SIDX_INVALID_TIMESCALE:3005,MP4_SIDX_TYPE_NOT_SUPPORTED:3006,WEBM_CUES_ELEMENT_MISSING:3007,WEBM_EBML_HEADER_ELEMENT_MISSING:3008,WEBM_SEGMENT_ELEMENT_MISSING:3009,WEBM_INFO_ELEMENT_MISSING:3010,WEBM_DURATION_ELEMENT_MISSING:3011,WEBM_CUE_TRACK_POSITIONS_ELEMENT_MISSING:3012,WEBM_CUE_TIME_ELEMENT_MISSING:3013,MEDIA_SOURCE_OPERATION_FAILED:3014,MEDIA_SOURCE_OPERATION_THREW:3015,VIDEO_ERROR:3016,QUOTA_EXCEEDED_ERROR:3017,TRANSMUXING_FAILED:3018,UNABLE_TO_GUESS_MANIFEST_TYPE:4e3,DASH_INVALID_XML:4001,DASH_NO_SEGMENT_INFO:4002,DASH_EMPTY_ADAPTATION_SET:4003,DASH_EMPTY_PERIOD:4004,DASH_WEBM_MISSING_INIT:4005,DASH_UNSUPPORTED_CONTAINER:4006,DASH_PSSH_BAD_ENCODING:4007,DASH_NO_COMMON_KEY_SYSTEM:4008,DASH_MULTIPLE_KEY_IDS_NOT_SUPPORTED:4009,DASH_CONFLICTING_KEY_IDS:4010,UNPLAYABLE_PERIOD:4011,RESTRICTIONS_CANNOT_BE_MET:4012,NO_PERIODS:4014,HLS_PLAYLIST_HEADER_MISSING:4015,INVALID_HLS_TAG:4016,HLS_INVALID_PLAYLIST_HIERARCHY:4017,DASH_DUPLICATE_REPRESENTATION_ID:4018,HLS_MULTIPLE_MEDIA_INIT_SECTIONS_FOUND:4020,HLS_COULD_NOT_GUESS_MIME_TYPE:4021,HLS_MASTER_PLAYLIST_NOT_PROVIDED:4022,HLS_REQUIRED_ATTRIBUTE_MISSING:4023,HLS_REQUIRED_TAG_MISSING:4024,HLS_COULD_NOT_GUESS_CODECS:4025,HLS_KEYFORMATS_NOT_SUPPORTED:4026,DASH_UNSUPPORTED_XLINK_ACTUATE:4027,DASH_XLINK_DEPTH_LIMIT:4028,HLS_COULD_NOT_PARSE_SEGMENT_START_TIME:4030,CONTENT_UNSUPPORTED_BY_BROWSER:4032,CANNOT_ADD_EXTERNAL_TEXT_TO_LIVE_STREAM:4033,HLS_AES_128_ENCRYPTION_NOT_SUPPORTED:4034,HLS_INTERNAL_SKIP_STREAM:4035,INVALID_STREAMS_CHOSEN:5005,NO_RECOGNIZED_KEY_SYSTEMS:6e3,REQUESTED_KEY_SYSTEM_CONFIG_UNAVAILABLE:6001,FAILED_TO_CREATE_CDM:6002,FAILED_TO_ATTACH_TO_VIDEO:6003,INVALID_SERVER_CERTIFICATE:6004,FAILED_TO_CREATE_SESSION:6005,FAILED_TO_GENERATE_LICENSE_REQUEST:6006,LICENSE_REQUEST_FAILED:6007,LICENSE_RESPONSE_REJECTED:6008,ENCRYPTED_CONTENT_WITHOUT_DRM_INFO:6010,NO_LICENSE_SERVER_GIVEN:6012,OFFLINE_SESSION_REMOVED:6013,EXPIRED:6014,SERVER_CERTIFICATE_REQUIRED:6015,INIT_DATA_TRANSFORM_ERROR:6016,LOAD_INTERRUPTED:7e3,OPERATION_ABORTED:7001,NO_VIDEO_ELEMENT:7002,CAST_API_UNAVAILABLE:8e3,NO_CAST_RECEIVERS:8001,ALREADY_CASTING:8002,UNEXPECTED_CAST_ERROR:8003,CAST_CANCELED_BY_USER:8004,CAST_CONNECTION_TIMED_OUT:8005,CAST_RECEIVER_APP_UNAVAILABLE:8006,STORAGE_NOT_SUPPORTED:9e3,INDEXED_DB_ERROR:9001,DEPRECATED_OPERATION_ABORTED:9002,REQUESTED_ITEM_NOT_FOUND:9003,MALFORMED_OFFLINE_URI:9004,CANNOT_STORE_LIVE_OFFLINE:9005,STORE_ALREADY_IN_PROGRESS:9006,NO_INIT_DATA_FOR_OFFLINE:9007,LOCAL_PLAYER_INSTANCE_REQUIRED:9008,NEW_KEY_OPERATION_NOT_SUPPORTED:9011,KEY_NOT_FOUND:9012,MISSING_STORAGE_CELL:9013},ye.prototype.resolve=function(){},ye.prototype.reject=function(){},H("shaka.util.AbortableOperation",me),me.failed=ve,me.aborted=ge,me.completed=be,me.notAbortable=we,me.prototype.abort=function(){return this.a=!0,this.me()},me.prototype.abort=me.prototype.abort,me.all=Se,me.prototype.finally=function(e){return this.promise.then((function(){return e(!0)}),(function(){return e(!1)})),this},me.prototype.finally=me.prototype.finally,me.prototype.Y=function(e,t){function n(n){return function(s){if(i.a&&n)o.reject(a);else{var u=n?e:t;u?r=function(e,t,n){try{var r=e(t);return r&&r.promise&&r.abort?(n.resolve(r.promise),function(){return r.abort()}):(n.resolve(r),function(){return Promise.resolve(r).then((function(){}),(function(){}))})}catch(e){return n.reject(e),function(){return Promise.resolve()}}}(u,s,o):(n?o.resolve:o.reject)(s)}}}function r(){return o.reject(a),i.abort()}var i=this,o=new ye,a=new he(2,7,7001);return this.promise.then(n(!0),n(!1)),new me(o,(function(){return r()}))},me.prototype.chain=me.prototype.Y,Te.prototype.preventDefault=function(){this.cancelable&&(this.defaultPrevented=!0)},Te.prototype.stopImmediatePropagation=function(){this.a=!0},Te.prototype.stopPropagation=function(){},(i=Ee.prototype).push=function(e,t){this.a.hasOwnProperty(e)?this.a[e].push(t):this.a[e]=[t]},i.get=function(e){return(e=this.a[e])?e.slice():null},i.getAll=function(){var e,t=[];for(e in this.a)t.push.apply(t,this.a[e]);return t},i.remove=function(e,t){var n=this.a[e];if(n)for(var r=0;r<n.length;++r)n[r]==t&&(n.splice(r,1),--r)},i.forEach=function(e){for(var t in this.a)e(t,this.a[t])},Pe.prototype.addEventListener=function(e,t){this.Sc.push(e,t)},Pe.prototype.removeEventListener=function(e,t){this.Sc.remove(e,t)},Pe.prototype.dispatchEvent=function(e){for(var t=this.Sc.get(e.type)||[],n=0;n<t.length;++n){e.target=this.gc,e.currentTarget=this.gc;var r=t[n];try{r.handleEvent?r.handleEvent(e):r.call(this,e)}catch(e){Y.error("Uncaught exception in event handler",e,e?e.message:null,e?e.stack:null)}if(e.a)break}return e.defaultPrevented},Me.prototype.destroy=function(){var e=[];return this.a.forEach((function(t){t.promise.catch((function(){})),e.push(t.abort())})),this.a=[],Promise.all(e)},z(Re,Pe),H("shaka.net.NetworkingEngine",Re),Re.RequestType={MANIFEST:0,SEGMENT:1,LICENSE:2,APP:3,TIMING:4},Re.PluginPriority={FALLBACK:1,PREFERRED:2,APPLICATION:3};var Ce={};function De(e,t,n){n=n||3;var r=Ce[e];(!r||n>=r.priority)&&(Ce[e]={priority:n,cg:t})}function je(e,t){return{uris:e,method:"GET",body:null,headers:{},allowCrossSiteCredentials:!1,retryParameters:t,licenseRequestType:null,sessionId:null}}function Ne(){this.a=0}function _e(e,t,n){me.call(this,e,t),this.b=n}function Le(){}function Ue(){this.a=new Ee}function Ke(e,t,n,r){this.target=e,this.type=t,this.listener=n,this.a=function(e,t){if(null==t)return!1;if("boolean"==typeof t)return t;var n=new Set(["passive","capture"]);return Object.keys(t).filter((function(e){return!n.has(e)})),function(e){var t=Be;if(null==t){t=!1;try{var n={},r={get:function(){return t=!0,!1}};Object.defineProperty(n,"passive",r),Object.defineProperty(n,"capture",r),r=function(){},e.addEventListener("test",r,n),e.removeEventListener("test",r,n)}catch(e){t=!1}Be=t}return t||!1}(e)?t:t.capture||!1}(e,r),this.target.addEventListener(t,n,this.a)}Re.registerScheme=De,Re.unregisterScheme=function(e){delete Ce[e]},Re.prototype.eg=function(e){this.a.add(e)},Re.prototype.registerRequestFilter=Re.prototype.eg,Re.prototype.Fg=function(e){this.a.delete(e)},Re.prototype.unregisterRequestFilter=Re.prototype.Fg,Re.prototype.Ve=function(){this.a.clear()},Re.prototype.clearAllRequestFilters=Re.prototype.Ve,Re.prototype.fg=function(e){this.b.add(e)},Re.prototype.registerResponseFilter=Re.prototype.fg,Re.prototype.Gg=function(e){this.b.delete(e)},Re.prototype.unregisterResponseFilter=Re.prototype.Gg,Re.prototype.We=function(){this.b.clear()},Re.prototype.clearAllResponseFilters=Re.prototype.We,Re.defaultRetryParameters=function(){return{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:0}},Re.makeRequest=je,Re.prototype.destroy=function(){return this.f=!0,this.a.clear(),this.b.clear(),this.g.destroy()},Re.prototype.destroy=Re.prototype.destroy,Re.prototype.request=function(e,t){var n=this,r=new Ne;if(this.f){var i=Promise.reject(new he(2,7,7001));return i.catch((function(){})),new _e(i,(function(){return Promise.resolve()}),r)}t.method=t.method||"GET",t.headers=t.headers||{},t.retryParameters=t.retryParameters?ke(t.retryParameters):{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:0},t.uris=ke(t.uris);var o=(i=function(e,t,n){for(var r=be(void 0),i={},o=(e=p(e.a)).next();!o.done;i={Ad:i.Ad},o=e.next())i.Ad=o.value,r=r.Y(function(e){return function(){return e.Ad(t,n)}}(i));return r.Y(void 0,(function(e){if(e&&7001==e.code)throw e;throw new he(2,1,1006,e)}))}(this,e,t)).Y((function(){return function e(t,n,r,i,o,a,s){var u=new J(r.uris[o]),c=u.xa,l=!1;c||(c=(c=location.protocol).slice(0,-1),Q(u,c),r.uris[o]=u.toString()),c=c.toLowerCase();var f,d=(c=Ce[c])?c.cg:null;return d?we(pe(i)).Y((function(){return t.f?ge():(f=Date.now(),d(r.uris[o],r,n,(function(e,r,i){t.c&&1==n&&(t.c(e,r),l=!0,s.a=i)})))})).Y((function(e){return null==e.timeMs&&(e.timeMs=Date.now()-f),{response:e,Df:l}}),(function(u){if(u&&7001==u.code)throw u;if(t.f)return ge();if(u&&1==u.severity)return t.dispatchEvent(new Te("retry",{error:u instanceof he?u:null})),o=(o+1)%r.uris.length,e(t,n,r,i,o,u,s);throw u||a})):ve(new he(2,1,1e3,u))}(n,e,t,new de(t.retryParameters,!1),0,null,r)})),a=o.Y((function(t){return function(e,t,n){for(var r=be(void 0),i=(e=p(e.b)).next();!i.done;i=e.next())r=r.Y(i.value.bind(null,t,n.response));return r.Y((function(){return n}),(function(e){if(e&&7001==e.code)throw e;var t=2;throw e instanceof he&&(t=e.severity),new he(t,1,1007,e)}))}(n,e,t)})),s=Date.now(),u=0;i.promise.then((function(){u=Date.now()-s}),(function(){}));var c=0;return o.promise.then((function(){c=Date.now()}),(function(){})),i=new _e((i=a.Y((function(t){var r=Date.now()-c,i=t.response;return i.timeMs+=u,i.timeMs+=r,t.Df||!n.c||i.fromCache||1!=e||n.c(i.timeMs,i.data.byteLength),i}),(function(e){throw e&&(e.severity=2),e}))).promise,i.me,r),Ie(this.g,i),i},Re.prototype.request=Re.prototype.request,Re.NumBytesRemainingClass=Ne,S(_e,me),Re.PendingRequest=_e,_e.all=Se,_e.notAbortable=we,_e.completed=be,_e.aborted=ge,_e.failed=ve,H("shaka.util.IReleasable",Le),Le.prototype.release=function(){},H("shaka.util.EventManager",Ue),Ue.prototype.release=function(){this.hb(),this.a=null},Ue.prototype.release=Ue.prototype.release,Ue.prototype.B=function(e,t,n,r){this.a&&(e=new Ke(e,t,n,r),this.a.push(t,e))},Ue.prototype.listen=Ue.prototype.B,Ue.prototype.ua=function(e,t,n,r){var i=this;this.B(e,t,(function r(o){i.pa(e,t,r),n(o)}),r)},Ue.prototype.listenOnce=Ue.prototype.ua,Ue.prototype.pa=function(e,t,n){if(this.a)for(var r=this.a.get(t)||[],i=(r=p(r)).next();!i.done;i=r.next())(i=i.value).target!=e||n!=i.listener&&n||(i.pa(),this.a.remove(t,i))},Ue.prototype.unlisten=Ue.prototype.pa,Ue.prototype.hb=function(){if(this.a){for(var e=this.a.getAll(),t=(e=p(e)).next();!t.done;t=e.next())t.value.pa();this.a.a={}}},Ue.prototype.removeAll=Ue.prototype.hb,Ke.prototype.pa=function(){this.target.removeEventListener(this.type,this.listener,this.a),this.listener=this.target=null,this.a=!1},Ke.prototype.unlisten=Ke.prototype.pa;var Be=void 0;function Ve(e){return new J(e=at(e)).wa}function Fe(e,t,n){function r(e){new DataView(i.buffer).setUint32(o,e.byteLength,!0),o+=4,i.set(e,o),o+=e.byteLength}if(!n||!n.byteLength)throw new he(2,6,6015);t="string"==typeof t?new Uint8Array(ut(t,!0)):new Uint8Array(t),e=ut(e=at(e),!0);var i=new Uint8Array(12+e.byteLength+t.byteLength+n.byteLength),o=0;return r(new Uint8Array(e)),r(t),r(new Uint8Array(n)),i}function He(e,t){for(var n=[],r=p(e),i=r.next();!i.done;i=r.next())n.push(t(i.value));return n}function ze(e,t){for(var n=p(e),r=n.next();!r.done;r=n.next())if(!t(r.value))return!1;return!0}function qe(e){var t=new Map;return Object.keys(e).forEach((function(n){t.set(n,e[n])})),t}function Ge(e){var t={};return e.forEach((function(e,n){t[n]=e})),t}function We(e,t){var n=e;return t&&(n+='; codecs="'+t+'"'),n}function Xe(e){var t=(e=e.split("."))[0];return e.pop(),[t,e.join(".")]}H("shaka.util.FairPlayUtils.defaultGetContentId",Ve),H("shaka.util.FairPlayUtils.initDataTransform",Fe);var Ye=(new Map).set("codecs","codecs").set("frameRate","framerate").set("bandwidth","bitrate").set("width","width").set("height","height").set("channelsCount","channels");function $e(){return!(!e.MediaSource||!MediaSource.isTypeSupported)}function Je(e){return""!=tt().canPlayType(e)}function Qe(){return!!navigator.vendor&&navigator.vendor.includes("Apple")&&!et("Tizen")}function Ze(){if(!Qe())return null;var e=navigator.userAgent.match(/Version\/(\d+)/);return e||(e=navigator.userAgent.match(/OS (\d+)(?:_\d+)?/))?parseInt(e[1],10):null}function et(e){return(navigator.userAgent||"").includes(e)}function tt(){return rt||(nt||(nt=new fe((function(){rt=null}))),(rt=document.getElementsByTagName("video")[0]||document.getElementsByTagName("audio")[0])||(rt=document.createElement("video")),nt.T(1),rt)}var nt=null,rt=null;function it(e){if(!e)return"";239==(e=new Uint8Array(e))[0]&&187==e[1]&&191==e[2]&&(e=e.subarray(3)),e=ct(e),e=escape(e);try{return decodeURIComponent(e)}catch(e){throw new he(2,2,2004)}}function ot(e,t,n){if(!e)return"";if(!n&&0!=e.byteLength%2)throw Y.error("Data has an incorrect length, must be even."),new he(2,2,2004);if(e instanceof ArrayBuffer)var r=e;else(n=new Uint8Array(e.byteLength)).set(new Uint8Array(e)),r=n.buffer;e=Math.floor(e.byteLength/2),n=new Uint16Array(e),r=new DataView(r);for(var i=0;i<e;i++)n[i]=r.getUint16(2*i,t);return ct(n)}function at(e){var t=new Uint8Array(e);if(239==t[0]&&187==t[1]&&191==t[2])return it(t);if(254==t[0]&&255==t[1])return ot(t.subarray(2),!1);if(255==t[0]&&254==t[1])return ot(t.subarray(2),!0);var n=function(e,t){return e.byteLength<=t||32<=e[t]&&126>=e[t]}.bind(null,t);if(Y.debug("Unable to find byte-order-mark, making an educated guess."),0==t[0]&&0==t[2])return ot(e,!1);if(0==t[1]&&0==t[3])return ot(e,!0);if(n(0)&&n(1)&&n(2)&&n(3))return it(e);throw new he(2,2,2003)}function st(e){e=encodeURIComponent(e),e=unescape(e);for(var t=new Uint8Array(e.length),n=0;n<e.length;++n)t[n]=e.charCodeAt(n);return t.buffer}function ut(e,t){for(var n=new Uint8Array(2*e.length),r=new DataView(n.buffer),i=0;i<e.length;++i)r.setUint16(2*i,e.charCodeAt(i),t);return n.buffer}function ct(e){if(!lt)for(var t=function(e){try{var t=new Uint8Array(e);return 0<String.fromCharCode.apply(null,t).length}catch(e){return!1}},n={size:65536};0<n.size;(n={size:n.size}).size/=2)if(t(n.size)){lt=function(e){return function(t){for(var n="",r=0;r<t.length;r+=e.size)n+=String.fromCharCode.apply(null,t.subarray(r,r+e.size));return n}}(n);break}return lt(e)}H("shaka.util.StringUtils.fromUTF8",it),H("shaka.util.StringUtils.fromUTF16",ot),H("shaka.util.StringUtils.fromBytesAutoDetect",at),H("shaka.util.StringUtils.toUTF8",st),H("shaka.util.StringUtils.toUTF16",ut);var lt=null;H("shaka.util.StringUtils.resetFromCharCode",(function(){lt=null}));var ft={Hc:function(t,n){var r=ct(t);return n=null==n||n,r=e.btoa(r).replace(/\+/g,"-").replace(/\//g,"_"),n?r:r.replace(/=*$/,"")}};function dt(e,t){var n=this;t=void 0===t?1:t,this.F=e,this.v=new Set,this.h=this.l=null,this.V=!1,this.K=0,this.a=null,this.i=new Ue,this.b=new Map,this.u=[],this.o=new ye,this.f=null,this.g=function(t){n.o.reject(t),e.onError(t)},this.sa=new Map,this.$=new Map,this.S=new fe((function(){return function(e){var t=e.sa,n=e.$;n.clear(),t.forEach((function(e,t){return n.set(t,e)})),(t=Array.from(n.values())).length&&t.every((function(e){return"expired"==e}))&&e.g(new he(2,6,6014)),e.F.yc(Ge(n))}(n)})),this.c=!1,this.qa=new ye,this.G=!1,this.H=[],this.ra=!1,this.ea=new fe((function(){!function(e){e.b.forEach((function(t,n){var r=t.rd,i=n.expiration;isNaN(i)&&(i=1/0),i!=r&&(e.F.onExpirationUpdated(n.sessionId,i),t.rd=i)}))}(n)})).Ra(t),this.o.catch((function(){}))}function pt(e,t,n){return e.u=n,e.G=0<n.length,ht(e,t)}function ht(t,n){var r=function(t){if(0==(t=qe(t.f.clearKeys)).size)return null;var n=[],r=[];t.forEach((function(e,t){var i=ft.Yc(t),o=ft.Yc(e);i={kty:"oct",kid:ft.Hc(i,!1),k:ft.Hc(o,!1)},n.push(i),r.push(i.kid)})),t=JSON.stringify({keys:n});var i=JSON.stringify({kids:r});return i=[{initData:new Uint8Array(st(i)),initDataType:"keyids"}],{keySystem:"org.w3.clearkey",licenseServerUri:"data:application/json;base64,"+e.btoa(t),distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,initData:i,keyIds:[]}}(t);if(r)for(var i=p(n),o=i.next();!o.done;o=i.next())o.value.drmInfos=[r];for((r=n.some((function(e){return 0<e.drmInfos.length})))||function(e,t){var n=[];t.forEach((function(e,t){n.push({keySystem:t,licenseServerUri:e,distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,initData:[],keyIds:[]})}));for(var r=p(e),i=r.next();!i.done;i=r.next())i.value.drmInfos=n}(n,o=qe(t.f.servers)),o=(i=p(n)).next();!o.done;o=i.next())for(var a=(o=p(o.value.drmInfos)).next();!a.done;a=o.next())Rt(a.value,qe(t.f.servers),qe(t.f.advanced||{}));return(o=function(e,t){for(var n=new Set,r=p(t),i=r.next();!i.done;i=r.next()){var o=p(i.value.drmInfos);for(i=o.next();!i.done;i=o.next())n.add(i.value)}for(r=p(n),i=r.next();!i.done;i=r.next())Rt(i.value,qe(e.f.servers),qe(e.f.advanced||{}));o=e.G?"required":"optional";var a=e.G?["persistent-license"]:["temporary"];for(r=new Map,n=p(n),i=n.next();!i.done;i=n.next())i=i.value,r.set(i.keySystem,{audioCapabilities:[],videoCapabilities:[],distinctiveIdentifier:"optional",persistentState:o,sessionTypes:a,label:i.keySystem,drmInfos:[]});for(n=p(t),i=n.next();!i.done;i=n.next()){i=i.value,o=i.audio,a=i.video;var s=o?We(o.mimeType,o.codecs):"",u=a?We(a.mimeType,a.codecs):"",c=p(i.drmInfos);for(i=c.next();!i.done;i=c.next()){i=i.value;var l=r.get(i.keySystem);l.drmInfos.push(i),i.distinctiveIdentifierRequired&&(l.distinctiveIdentifier="required"),i.persistentStateRequired&&(l.persistentState="required"),o&&l.audioCapabilities.push({robustness:i.audioRobustness||"",contentType:s}),a&&l.videoCapabilities.push({robustness:i.videoRobustness||"",contentType:u})}}return r}(t,n)).size?(o=St(t,o),r?o:o.catch((function(){}))):(t.V=!0,Promise.resolve())}function yt(e){return y((function t(){var n;return L(t,(function(t){switch(t.j){case 1:if(!(e.l&&e.a&&e.a.serverCertificate&&e.a.serverCertificate.length)){t.C(0);break}return A(t,3),k(t,e.l.setServerCertificate(e.a.serverCertificate),5);case 5:t.s||Y.m("Server certificates are not supported by the key system.  The server certificate has been ignored."),M(t,0);break;case 3:return n=I(t),t.return(Promise.reject(new he(2,6,6004,n.message)))}}))}))}function mt(e){var t=e.a?e.a.initData:[];return t.forEach((function(t){return Et(e,t.initDataType,t.initData)})),e.u.forEach((function(t){return Tt(e,t)})),t.length||e.u.length||e.o.resolve(),e.o}function vt(e,t,n){for(var r=e.b.values(),i=(r=p(r)).next();!i.done;i=r.next())if(ft.Da(n,i.value.initData)&&!et("Tizen 2"))return void Y.debug("Ignoring duplicate init data.");Et(e,t,n)}function gt(e){return e?e.keySystem:""}function bt(e,t){return!!et("Edge/")||e.v.has(t)}function wt(e){return e=He(e=e.b.keys(),(function(e){return e.sessionId})),Array.from(e)}function St(e,t){if(1==t.size&&t.has(""))return Promise.reject(new he(2,6,6e3));for(var n=p(t.values()),r=n.next();!r.done;r=n.next())0==(r=r.value).audioCapabilities.length&&delete r.audioCapabilities,0==r.videoCapabilities.length&&delete r.videoCapabilities;var i=n=new ye;return[!0,!1].forEach(function(e){var n=this;t.forEach((function(t,r){t.drmInfos.some((function(e){return!!e.licenseServerUri}))==e&&(i=i.catch(function(){if(!this.c)return navigator.requestMediaKeySystemAccess(r,[t])}.bind(n)))}))}.bind(e)),i=(i=i.catch((function(){return Promise.reject(new he(2,6,6001))}))).then(function(e){if(this.c)return Promise.reject();this.v.clear();var n=e.getConfiguration(),r=n.videoCapabilities||[],i=p(n.audioCapabilities||[]);for(n=i.next();!n.done;n=i.next())this.v.add(n.value.contentType);for(n=(r=p(r)).next();!n.done;n=r.next())this.v.add(n.value.contentType);r=e.keySystem,i=[];var o=[],a=[],s=[];return function(e,t,n,r,i){e.forEach((function(e){if(t.includes(e.licenseServerUri)||t.push(e.licenseServerUri),e.serverCertificate&&(n.some((function(t){return ft.Da(t,e.serverCertificate)}))||n.push(e.serverCertificate)),e.initData&&e.initData.forEach((function(e){r.some((function(t){return!(!t.keyId||t.keyId!=e.keyId)||t.initDataType==e.initDataType&&ft.Da(t.initData,e.initData)}))||r.push(e)})),e.keyIds)for(var o=0;o<e.keyIds.length;++o)i.includes(e.keyIds[o])||i.push(e.keyIds[o])}))}((n=t.get(e.keySystem)).drmInfos,i,o,a,s),1<o.length&&Y.m("Multiple unique server certificates found! Only the first will be used."),1<i.length&&Y.m("Multiple unique license server URIs found! Only the first will be used."),this.a={keySystem:r,licenseServerUri:i[0],distinctiveIdentifierRequired:"required"==n.distinctiveIdentifier,persistentStateRequired:"required"==n.persistentState,audioRobustness:(n.audioCapabilities?n.audioCapabilities[0].robustness:"")||"",videoRobustness:(n.videoCapabilities?n.videoCapabilities[0].robustness:"")||"",serverCertificate:o[0],initData:a,keyIds:s},this.a.licenseServerUri?e.createMediaKeys():Promise.reject(new he(2,6,6012,this.a.keySystem))}.bind(e)).then(function(e){if(this.c)return Promise.reject();Y.info("Created MediaKeys object for key system",this.a.keySystem),this.l=e,this.V=!0}.bind(e)).catch(function(e){if(!this.c)return this.a=null,this.v.clear(),e instanceof he?Promise.reject(e):Promise.reject(new he(2,6,6002,e.message))}.bind(e)),n.reject(),i}function Tt(e,t){try{Y.D("Attempting to load an offline session",t);var n=e.l.createSession("persistent-license")}catch(t){var r=new he(2,6,6005,t.message);return e.g(r),Promise.reject(r)}e.i.B(n,"message",e.se.bind(e)),e.i.B(n,"keystatuseschange",e.qe.bind(e));var i={initData:null,loaded:!1,rd:1/0,Ca:null};return e.b.set(n,i),n.load(t).then(function(e){return this.c?Promise.reject():(Y.J("Loaded offline session",t,e),e?(i.loaded=!0,It(this)&&this.o.resolve(),n):(this.b.delete(n),void this.g(new he(2,6,6013))))}.bind(e),function(e){this.c||(this.b.delete(n),this.g(new he(2,6,6005,e.message)))}.bind(e))}function Et(e,t,n){try{if(e.G){Y.D("Creating new persistent session");var r=e.l.createSession("persistent-license")}else Y.D("Creating new temporary session"),r=e.l.createSession()}catch(t){return void e.g(new he(2,6,6005,t.message))}e.i.B(r,"message",e.se.bind(e)),e.i.B(r,"keystatuseschange",e.qe.bind(e)),e.b.set(r,{initData:n,loaded:!1,rd:1/0,Ca:null});try{n=e.f.initDataTransform(n,e.a)}catch(n){return t=n,n instanceof he||(t=new he(2,6,6016,n)),void e.g(t)}r.generateRequest(t,n.buffer).catch((function(t){if(!e.c){if(e.b.delete(r),t.errorCode&&t.errorCode.systemCode){var n=t.errorCode.systemCode;0>n&&(n+=Math.pow(2,32)),n="0x"+n.toString(16)}e.g(new he(2,6,6006,t.message,t,n))}}))}function Pt(e,t){if(gt(t).startsWith("com.apple.fps")){var n=t.serverCertificate;e=Fe(e,Ve(e),n)}return e}function kt(e,t){var n=t.target;Y.D("Sending license request for session",n.sessionId,"of type",t.messageType);var r=e.b.get(n),i=e.a.licenseServerUri,o=e.f.advanced[e.a.keySystem];"individualization-request"==t.messageType&&o&&o.individualizationServer&&(i=o.individualizationServer),(i=je([i],e.f.retryParameters)).body=t.message,i.method="POST",i.licenseRequestType=t.messageType,i.sessionId=n.sessionId,"com.microsoft.playready"!=e.a.keySystem&&"com.chromecast.playready"!=e.a.keySystem||function(e){var t=ot(e.body,!0,!0);if(t.includes("PlayReadyKeyMessage")){Y.debug("Unwrapping PlayReady request.");for(var n=(t=(new DOMParser).parseFromString(t,"application/xml")).getElementsByTagName("HttpHeader"),r=0;r<n.length;++r)e.headers[n[r].getElementsByTagName("name")[0].textContent]=n[r].getElementsByTagName("value")[0].textContent;e.body=ft.Fa(t.getElementsByTagName("Challenge")[0].textContent).buffer}else Y.debug("PlayReady request is already unwrapped."),e.headers["Content-Type"]="text/xml; charset=utf-8"}(i),e.a.keySystem.startsWith("com.apple.fps")&&e.f.fairPlayTransform&&function(e){var t=new Uint8Array(e.body);t="spc="+ft.Hc(t),e.headers["Content-Type"]="application/x-www-form-urlencoded",e.body=st(t)}(i);var a=Date.now();e.F.Db.request(2,i).promise.then(function(e){return this.c?Promise.reject():(this.a.keySystem.startsWith("com.apple.fps")&&this.f.fairPlayTransform&&function(e){try{var t=it(e.data)}catch(e){return}"<ckc>"===(t=t.trim()).substr(0,5)&&"</ckc>"===t.substr(-6)&&(t=t.slice(5,-6));try{t=JSON.parse(t).ckc}catch(e){}e.data=ft.Fa(t).buffer}(e),this.K+=(Date.now()-a)/1e3,Y.D("Updating session",n.sessionId),n.update(e.data).then(function(){var e=this;this.F.onEvent(new Te("drmsessionupdate")),r&&(r.Ca&&r.Ca.resolve(),new fe((function(){r.loaded=!0,It(e)&&e.o.resolve()})).T(Ct))}.bind(this)))}.bind(e),function(e){this.c||(e=new he(2,6,6007,e),this.g(e),r&&r.Ca&&r.Ca.reject(e))}.bind(e)).catch(function(e){this.c||(e=new he(2,6,6008,e.message),this.g(e),r&&r.Ca&&r.Ca.reject(e))}.bind(e))}function xt(){var e=[{contentType:'video/mp4; codecs="avc1.42E01E"'},{contentType:'video/webm; codecs="vp8"'}],t=[{videoCapabilities:e,persistentState:"required",sessionTypes:["persistent-license"]},{videoCapabilities:e}],n=new Map;return e="org.w3.clearkey com.widevine.alpha com.microsoft.playready com.apple.fps.3_0 com.apple.fps.2_0 com.apple.fps.1_0 com.apple.fps com.adobe.primetime".split(" ").map((function(e){return function(e){return y((function r(){var i,o,a;return L(r,(function(r){switch(r.j){case 1:return A(r,2),k(r,navigator.requestMediaKeySystemAccess(e,t),4);case 4:return i=r.s,a=!!(o=i.getConfiguration().sessionTypes)&&o.includes("persistent-license"),et("Tizen 3")&&(a=!1),n.set(e,{persistentState:a}),k(r,i.createMediaKeys(),5);case 5:M(r,0);break;case 2:I(r),n.set(e,null),x(r)}}))}))}(e)})),Promise.all(e).then((function(){return Ge(n)}))}function At(e,t){var n=t.audio,r=t.video;if(n&&n.encrypted&&!bt(e,We(n.mimeType,n.codecs))||r&&r.encrypted&&!bt(e,We(r.mimeType,r.codecs)))return!1;var i=gt(e.a);return 0==t.drmInfos.length||t.drmInfos.some((function(e){return e.keySystem==i}))}function Ot(e,t){if(!e.length)return t;if(!t.length)return e;for(var n=[],r=0;r<e.length;r++)for(var i=0;i<t.length;i++)if(e[r].keySystem==t[i].keySystem){var o=e[r];i=t[i];var a=[];a=(a=a.concat(o.initData||[])).concat(i.initData||[]);var s=[];s=(s=s.concat(o.keyIds)).concat(i.keyIds),n.push({keySystem:o.keySystem,licenseServerUri:o.licenseServerUri||i.licenseServerUri,distinctiveIdentifierRequired:o.distinctiveIdentifierRequired||i.distinctiveIdentifierRequired,persistentStateRequired:o.persistentStateRequired||i.persistentStateRequired,videoRobustness:o.videoRobustness||i.videoRobustness,audioRobustness:o.audioRobustness||i.audioRobustness,serverCertificate:o.serverCertificate||i.serverCertificate,initData:a,keyIds:s});break}return n}function Mt(e){return y((function t(){var n;return L(t,(function(t){switch(t.j){case 1:return n=Array.from(e.b.keys()),e.b.clear(),k(t,Promise.all(n.map((function(e){return y((function t(){return L(t,(function(t){switch(t.j){case 1:return Y.D("Closing session",e.sessionId),A(t,2),k(t,Promise.all([e.close(),e.closed]),4);case 4:M(t,0);break;case 2:I(t),x(t)}}))}))}))),0)}}))}))}function It(e){return ze(e=e.b.values(),(function(e){return e.loaded}))}function Rt(t,n,r){!t.keySystem||"org.w3.clearkey"==t.keySystem&&t.licenseServerUri||(n.size&&(n=n.get(t.keySystem)||"",t.licenseServerUri=n),t.keyIds||(t.keyIds=[]),(r=r.get(t.keySystem))&&(t.distinctiveIdentifierRequired||(t.distinctiveIdentifierRequired=r.distinctiveIdentifierRequired),t.persistentStateRequired||(t.persistentStateRequired=r.persistentStateRequired),t.videoRobustness||(t.videoRobustness=r.videoRobustness),t.audioRobustness||(t.audioRobustness=r.audioRobustness),t.serverCertificate||(t.serverCertificate=r.serverCertificate)),e.cast&&e.cast.__platform__&&"com.microsoft.playready"==t.keySystem&&(t.keySystem="com.chromecast.playready"))}H("shaka.util.Uint8ArrayUtils.toBase64",ft.Hc),ft.Fa=function(t){t=e.atob(t.replace(/-/g,"+").replace(/_/g,"/"));for(var n=new Uint8Array(t.length),r=0;r<t.length;++r)n[r]=t.charCodeAt(r);return n},H("shaka.util.Uint8ArrayUtils.fromBase64",ft.Fa),ft.Yc=function(t){for(var n=new Uint8Array(t.length/2),r=0;r<t.length;r+=2)n[r/2]=e.parseInt(t.substr(r,2),16);return n},H("shaka.util.Uint8ArrayUtils.fromHex",ft.Yc),ft.Ic=function(e){for(var t="",n=0;n<e.length;++n){var r=e[n].toString(16);1==r.length&&(r="0"+r),t+=r}return t},H("shaka.util.Uint8ArrayUtils.toHex",ft.Ic),ft.Da=function(e,t){if(!e&&!t)return!0;if(!e||!t||e.length!=t.length)return!1;for(var n=0;n<e.length;++n)if(e[n]!=t[n])return!1;return!0},H("shaka.util.Uint8ArrayUtils.equal",ft.Da),ft.concat=function(e){for(var t=[],n=0;n<arguments.length;++n)t[n]=arguments[n];for(var r=n=0;r<t.length;++r)n+=t[r].length;n=new Uint8Array(n);for(var i=r=0;i<t.length;++i)n.set(t[i],r),r+=t[i].length;return n},H("shaka.util.Uint8ArrayUtils.concat",ft.concat),(i=dt.prototype).destroy=function(){var e=this;return y((function t(){return L(t,(function(t){switch(t.j){case 1:return e.c?k(t,e.qa,0):(e.c=!0,k(t,function(e){return y((function t(){return L(t,(function(t){switch(t.j){case 1:return e.i.release(),e.i=null,e.o.reject(),e.ea.stop(),e.ea=null,e.S.stop(),e.S=null,k(t,Mt(e),2);case 2:if(!e.h){t.C(3);break}return A(t,4),k(t,e.h.setMediaKeys(null),6);case 6:M(t,5);break;case 4:I(t);case 5:e.h=null;case 3:e.a=null,e.v.clear(),e.l=null,e.u=[],e.f=null,e.g=null,e.F=null,x(t)}}))}))}(e),4));case 4:e.qa.resolve(),t.C(0)}}))}))},i.configure=function(e){this.f=e},i.Qb=function(e){var t=this;if(!this.l)return this.i.ua(e,"encrypted",(function(){t.g(new he(2,6,6010))})),Promise.resolve();this.h=e,this.i.ua(this.h,"play",(function(){for(var e=0;e<t.H.length;e++)kt(t,t.H[e]);t.ra=!0,t.H=[]})),"webkitCurrentPlaybackTargetIsWireless"in this.h&&this.i.B(this.h,"webkitcurrentplaybacktargetiswirelesschanged",(function(){return Mt(t)})),e=(e=this.h.setMediaKeys(this.l)).catch((function(e){return Promise.reject(new he(2,6,6003,e.message))}));var n=yt(this);return Promise.all([e,n]).then((function(){if(t.c)return Promise.reject();mt(t),t.a.initData.length||t.u.length||t.i.B(t.h,"encrypted",(function(e){return vt(t,e.initDataType,new Uint8Array(e.initData))}))})).catch((function(e){if(!t.c)return Promise.reject(e)}))},i.Tb=function(){for(var e=1/0,t=this.b.keys(),n=(t=p(t)).next();!n.done;n=t.next())n=n.value,isNaN(n.expiration)||(e=Math.min(e,n.expiration));return e},i.se=function(e){this.h&&this.f.delayLicenseRequestUntilPlayed&&this.h.paused&&!this.ra?this.H.push(e):kt(this,e)},i.qe=function(e){e=e.target,Y.J("Key status changed for session",e.sessionId);var t=this.b.get(e),n=!1;e.keyStatuses.forEach(function(e,r){if("string"==typeof r){var i=r;r=e,e=i}if(!("com.microsoft.playready"!=this.a.keySystem||16!=r.byteLength||et("Tizen")||et("VITIS")||et("Web0S")||et("TiVo"))){var o=(i=new DataView(r)).getUint32(0,!0),a=i.getUint16(4,!0),s=i.getUint16(6,!0);i.setUint32(0,o,!1),i.setUint16(4,a,!1),i.setUint16(6,s,!1)}"com.microsoft.playready"==this.a.keySystem&&"status-pending"==e&&(e="usable"),"status-pending"!=e&&(t.loaded=!0),"expired"==e&&(n=!0),i=ft.Ic(new Uint8Array(r)),this.sa.set(i,e)}.bind(this));var r=e.expiration-Date.now();(0>r||n&&1e3>r)&&t&&!t.Ca&&(Y.debug("Session has expired",e.sessionId),this.b.delete(e),e.close().catch((function(){}))),It(this)&&(this.o.resolve(),this.S.T(Dt))};var Ct=5,Dt=.5;function jt(){this.a=new muxjs.mp4.CaptionParser,this.g=[],this.f={}}function Nt(){}function _t(e){return!e||1==e.length&&1e-6>e.end(0)-e.start(0)?null:e.length?e.end(e.length-1):null}function Lt(e,t,n){return n=void 0===n?0:n,!(!e||!e.length||1==e.length&&1e-6>e.end(0)-e.start(0)||t>e.end(e.length-1))&&t+n>=e.start(0)}function Ut(e,t){if(!e||!e.length||1==e.length&&1e-6>e.end(0)-e.start(0))return 0;for(var n=0,r=e.length-1;0<=r&&e.end(r)>t;--r)n+=e.end(r)-Math.max(e.start(r),t);return n}function Kt(e){if(!e)return[];for(var t=[],n=0;n<e.length;n++)t.push({start:e.start(n),end:e.end(n)});return t}jt.prototype.init=function(e){var t=muxjs.mp4.probe;e=new Uint8Array(e),this.g=t.videoTrackIds(e),this.f=t.timescale(e),this.a.init()},jt.prototype.b=function(e,t){var n=new Uint8Array(e);(n=this.a.parse(n,this.g,this.f))&&n.captions&&t(n.captions),this.a.clearParsedCaptions()},jt.prototype.c=function(){this.a.resetCaptionStream()},Nt.prototype.init=function(){},Nt.prototype.b=function(){},Nt.prototype.c=function(){};var Bt={Xe:function(e,t){return e.reduce(function(e,t,n){return t.catch(e.bind(null,n))}.bind(null,t),Promise.reject())},Oc:function(e,t){return e.concat(t)},wc:function(){},Ma:function(e){return null!=e}};function Vt(e,t){if(0==t.length)return e;var n=t.map((function(e){return new J(e)}));return e.map((function(e){return new J(e)})).map((function(e){return n.map(e.resolve.bind(e))})).reduce(Bt.Oc,[]).map((function(e){return e.toString()}))}function Ft(e,t){return{keySystem:e,licenseServerUri:"",distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,initData:t||[],keyIds:[]}}var Ht={Ua:"video",Nb:"audio",va:"text",Mg:"image",Kg:"application"};function zt(){this.a=new muxjs.mp4.Transmuxer({keepOriginalTimestamps:!0}),this.b=null,this.g=[],this.c=[],this.f=!1,this.a.on("data",this.i.bind(this)),this.a.on("done",this.h.bind(this))}function qt(t,n){return!(!e.muxjs||"mp2t"!=t.toLowerCase().split(";")[0].split("/")[1])&&(n?MediaSource.isTypeSupported(Gt(n,t)):MediaSource.isTypeSupported(Gt("audio",t))||MediaSource.isTypeSupported(Gt("video",t)))}function Gt(e,t){var n=t.replace(/mp2t/i,"mp4");"audio"==e&&(n=n.replace("video","audio"));var r=/avc1\.(66|77|100)\.(\d+)/.exec(n);if(r){var i="avc1.",o=r[1],a=Number(r[2]);i=("66"==o?i+"4200":"77"==o?i+"4d00":i+"6400")+(a>>4).toString(16),i+=(15&a).toString(16),n=n.replace(r[0],i)}return n}function Wt(e,t,n){this.startTime=e,this.direction=Zt,this.endTime=t,this.payload=n,this.region=new un,this.position=null,this.positionAlign=Xt,this.size=0,this.textAlign=Yt,this.writingMode=en,this.lineInterpretation=tn,this.line=null,this.lineHeight="",this.lineAlign=nn,this.displayAlign=Jt,this.fontSize=this.backgroundImage=this.backgroundColor=this.color="",this.fontWeight=on,this.fontStyle=an,this.fontFamily="",this.textDecoration=[],this.wrapLine=!0,this.id="",this.nestedCues=[],this.spacer=!1}zt.prototype.destroy=function(){return this.a.dispose(),this.a=null,Promise.resolve()},zt.prototype.i=function(e){this.c=e.captions;var t=new Uint8Array(e.data.byteLength+e.initSegment.byteLength);t.set(e.initSegment,0),t.set(e.data,e.initSegment.byteLength),this.g.push(t)},zt.prototype.h=function(){var e={data:ft.concat.apply(null,this.g),captions:this.c};this.b.resolve(e),this.f=!1},H("shaka.text.Cue",Wt);var Xt="auto";Wt.positionAlign={LEFT:"line-left",RIGHT:"line-right",CENTER:"center",AUTO:Xt};var Yt="center",$t={LEFT:"left",RIGHT:"right",CENTER:Yt,START:"start",END:"end"};Wt.textAlign=$t;var Jt="after",Qt={BEFORE:"before",CENTER:"center",AFTER:Jt};Wt.displayAlign=Qt;var Zt="ltr";Wt.direction={HORIZONTAL_LEFT_TO_RIGHT:Zt,HORIZONTAL_RIGHT_TO_LEFT:"rtl"};var en="horizontal-tb";Wt.writingMode={HORIZONTAL_TOP_TO_BOTTOM:en,VERTICAL_LEFT_TO_RIGHT:"vertical-lr",VERTICAL_RIGHT_TO_LEFT:"vertical-rl"};var tn=0;Wt.lineInterpretation={LINE_NUMBER:tn,PERCENTAGE:1};var nn="start",rn={CENTER:"center",START:nn,END:"end"};Wt.lineAlign=rn;var on=400;Wt.fontWeight={NORMAL:on,BOLD:700};var an="normal",sn={NORMAL:an,ITALIC:"italic",OBLIQUE:"oblique"};function un(){this.id="",this.regionAnchorY=this.regionAnchorX=this.viewportAnchorY=this.viewportAnchorX=0,this.height=this.width=100,this.viewportAnchorUnits=this.widthUnits=this.heightUnits=cn,this.scroll=ln}Wt.fontStyle=sn,Wt.textDecoration={UNDERLINE:"underline",LINE_THROUGH:"lineThrough",OVERLINE:"overline"},H("shaka.text.CueRegion",un);var cn=1;un.units={PX:0,PERCENTAGE:cn,LINES:2};var ln="";function fn(e){this.g=null,this.c=e,this.f=this.o=0,this.h=1/0,this.b=this.a=null,this.l="",this.i=new Map}un.scrollMode={NONE:ln,UP:"up"};var dn={};function pn(t){return!!(dn[t]||e.muxjs&&"application/cea-608"==t)}function hn(e,t){"application/cea-608"!=t&&(e.g=new dn[t])}function yn(e,t,n,r,i){for(var o=n+" "+r,a=new Map,s=(t=p(t)).next();!s.done;s=t.next()){var u=s.value;s=u.stream,a.has(s)||a.set(s,new Map),a.get(s).has(o)||a.get(s).set(o,[]),u.startTime+=i,u.endTime+=i,u.startTime>=e.f&&u.startTime<e.h&&(u=new Wt(u.startTime,u.endTime,u.text),a.get(s).get(o).push(u),s==e.l&&e.c.append([u]))}for(o=(i=p(a.keys())).next();!o.done;o=i.next())for(o=o.value,e.i.has(o)||e.i.set(o,new Map),s=(t=p(a.get(o).keys())).next();!s.done;s=t.next())s=s.value,u=a.get(o).get(s),e.i.get(o).set(s,u);e.a=null==e.a?Math.max(n,e.f):Math.min(e.a,Math.max(n,e.f)),e.b=Math.max(e.b,Math.min(r,e.h))}function mn(e,t,n){this.f=e,this.g=n,this.b={},this.a=null,this.c={},this.i=new Ue,this.v=!1,this.l={},this.o=t,e=this.u=new ye,t=new MediaSource,this.i.ua(t,"sourceopen",e.resolve),this.f.src=vn(t),this.h=t}H("shaka.text.TextEngine.registerParser",(function(e,t){dn[e]=t})),H("shaka.text.TextEngine.unregisterParser",(function(e){delete dn[e]})),fn.prototype.destroy=function(){return this.c=this.g=null,this.i.clear(),Promise.resolve()},fn.prototype.sc=function(e){try{return this.g.parseMedia(new Uint8Array(e),{periodStart:0,segmentStart:null,segmentEnd:0})[0].startTime}catch(e){throw new he(2,2,2009,e)}},fn.prototype.remove=function(e,t){return Promise.resolve().then(function(){!this.c||!this.c.remove(e,t)||null==this.a||t<=this.a||e>=this.b||(e<=this.a&&t>=this.b?this.a=this.b=null:e<=this.a&&t<this.b?this.a=t:e>this.a&&t>=this.b&&(this.b=e))}.bind(this))};var vn=e.URL.createObjectURL;function gn(e){var t=We(e.mimeType,e.codecs),n=function(e){var t=[e.mimeType];return Ye.forEach((function(n,r){var i=e[r];i&&t.push(n+'="'+i+'"')})),t.join(";")}(e);return pn(t)||MediaSource.isTypeSupported(n)||qt(t,e.type)}function bn(e,t){e.a||(e.a=new fn(e.g)),hn(e.a,t)}function wn(e){return!e.h||"ended"==e.h.readyState}function Sn(e,t){if("text"==t)var n=e.a.a;else n=!(n=En(e,t))||1==n.length&&1e-6>n.end(0)-n.start(0)?null:1==n.length&&0>n.start(0)?0:n.length?n.start(0):null;return n}function Tn(e,t){return"text"==t?e.a.b:_t(En(e,t))}function En(e,t){try{return e.b[t].buffered}catch(n){return t in e.b&&Y.error("failed to get buffered range for "+t,n),null}}function Pn(t,n,r,i,o,a){return"text"==n?function(e,t,n,r){return Promise.resolve().then(function(){if(this.g&&this.c)if(null==n||null==r)this.g.parseInit(new Uint8Array(t));else{var e={periodStart:this.o,segmentStart:n,segmentEnd:r};e=this.g.parseMedia(new Uint8Array(t),e).filter(function(e){return e.startTime>=this.f&&e.startTime<this.h}.bind(this)),this.c.append(e),null==this.a&&(this.a=Math.max(n,this.f)),this.b=Math.min(r,this.h)}}.bind(e))}(t.a,r,i,o):t.l[n]?function(e,t){e.f=!0,e.b=new ye,e.g=[],e.c=[];var n=new Uint8Array(t);return e.a.push(n),e.a.flush(),e.f&&e.b.reject(new he(2,3,3018)),e.b}(t.l[n],r).then(function(e){return this.a||bn(this,"text/vtt"),e.captions&&e.captions.length&&yn(this.a,e.captions,i,o,this.b.video.timestampOffset),An(this,n,this.Ee.bind(this,n,e.data.buffer))}.bind(t)):(a&&e.muxjs&&(t.a||bn(t,"text/vtt"),null==i&&null==o?t.o.init(r):t.o.b(r,(function(e){e.length&&yn(t.a,e,i,o,t.b.video.timestampOffset)}))),An(t,n,t.Ee.bind(t,n,r)))}function kn(e,t){var n=Tn(e,"video")||0;!function(e,t,n){if(e.l=t,t=e.i.get(t))for(var r=p(t.keys()),i=r.next();!i.done;i=r.next())(i=t.get(i.value).filter((function(e){return e.endTime<=n})))&&e.c.append(i)}(e.a,t,n)}function xn(e,t){return"text"==t?e.a?(e.o.c(),e.a.remove(0,1/0)):Promise.resolve():An(e,t,e.Fe.bind(e,t,0,e.h.duration))}function An(e,t,n){if(e.v)return Promise.reject();if(n={start:n,p:new ye},e.c[t].push(n),1==e.c[t].length)try{n.start()}catch(r){"QuotaExceededError"==r.name?n.p.reject(new he(2,3,3017,t)):n.p.reject(new he(2,3,3015,r)),Mn(e,t)}return n.p}function On(e,t){if(e.v)return Promise.reject();var n,r=[];for(n in e.b){var i=new ye,o={start:function(e){e.resolve()}.bind(null,i),p:i};e.c[n].push(o),r.push(i),1==e.c[n].length&&o.start()}return Promise.all(r).then(function(){try{t()}catch(t){var e=Promise.reject(new he(2,3,3015,t))}for(var n in this.b)Mn(this,n);return e}.bind(e),function(e){throw e}.bind(e))}function Mn(e,t){e.c[t].shift();var n=e.c[t][0];if(n)try{n.start()}catch(r){n.p.reject(new he(2,3,3015,r)),Mn(e,t)}}function In(e,t){return e=Cn(e),t=Cn(t),e.split("-")[0]==t.split("-")[0]}function Rn(e,t){e=Cn(e),t=Cn(t);var n=e.split("-"),r=t.split("-");return n[0]==r[0]&&1==n.length&&2==r.length}function Cn(e){var t=e.split("-");return e=t[0]||"",t=t[1]||"",e=e.toLowerCase(),e=Nn.get(e)||e,(t=t.toUpperCase())?e+"-"+t:e}function Dn(e){return e.language?Cn(e.language):e.audio&&e.audio.language?Cn(e.audio.language):e.video&&e.video.language?Cn(e.video.language):"und"}function jn(e,t){for(var n=Cn(e),r=new Set,i=p(t),o=i.next();!o.done;o=i.next())r.add(Cn(o.value));for(o=(i=p(r)).next();!o.done;o=i.next())if((o=o.value)==n)return o;for(o=(i=p(r)).next();!o.done;o=i.next())if(Rn(o=o.value,n))return o;for(o=(i=p(r)).next();!o.done;o=i.next()){var a=o=o.value,s=n;if(a=Cn(a),s=Cn(s),a=a.split("-"),s=s.split("-"),2==a.length&&2==s.length&&a[0]==s[0])return o}for(o=(r=p(r)).next();!o.done;o=r.next())if(Rn(n,i=o.value))return i;return null}(i=mn.prototype).destroy=function(){var e=this;this.v=!0;var t,n=[];for(t in this.c){var r=this.c[t],i=r[0];for(this.c[t]=r.slice(0,1),i&&n.push(i.p.catch(Bt.wc)),i=1;i<r.length;++i)r[i].p.reject()}for(var o in this.a&&n.push(this.a.destroy()),this.g&&n.push(this.g.destroy()),this.l)n.push(this.l[o].destroy());return Promise.all(n).then((function(){e.i&&(e.i.release(),e.i=null),e.f&&(e.f.removeAttribute("src"),e.f.load(),e.f=null),e.h=null,e.a=null,e.g=null,e.b={},e.l={},e.o=null,e.c={}}))},i.init=function(e,t){var n=this;return y((function r(){var i;return L(r,(function(r){switch(r.j){case 1:return i=Ht,k(r,n.u,2);case 2:e.forEach((function(e,r){var o=We(e.mimeType,e.codecs);r==i.va?bn(n,o):(!t&&MediaSource.isTypeSupported(o)||!qt(o,r)||(n.l[r]=new zt,o=Gt(r,o)),o=n.h.addSourceBuffer(o),n.i.B(o,"error",n.vg.bind(n,r)),n.i.B(o,"updateend",n.Gb.bind(n,r)),n.b[r]=o,n.c[r]=[])})),x(r)}}))}))},i.$c=function(e){if(e.total=Kt(this.f.buffered),e.audio=Kt(En(this,"audio")),e.video=Kt(En(this,"video")),e.text=[],this.a){var t=this.a.a,n=this.a.b;null!=t&&null!=n&&e.text.push({start:t,end:n})}},i.remove=function(e,t,n){return"text"==e?this.a.remove(t,n):An(this,e,this.Fe.bind(this,e,t,n))},i.flush=function(e){return"text"==e?Promise.resolve():An(this,e,this.bf.bind(this,e))},i.endOfStream=function(e){return On(this,function(){wn(this)||(e?this.h.endOfStream(e):this.h.endOfStream())}.bind(this))},i.Ba=function(e){return On(this,function(){this.h.duration=e}.bind(this))},i.ca=function(){return this.h.duration},i.Ee=function(e,t){this.b[e].appendBuffer(t)},i.Fe=function(e,t,n){n<=t?this.Gb(e):this.b[e].remove(t,n)},i.Oe=function(e){var t=this.b[e].appendWindowStart,n=this.b[e].appendWindowEnd;this.b[e].abort(),this.b[e].appendWindowStart=t,this.b[e].appendWindowEnd=n,this.Gb(e)},i.bf=function(e){this.f.currentTime-=.001,this.Gb(e)},i.ug=function(e,t){0>t&&(t+=.001),this.b[e].timestampOffset=t,this.Gb(e)},i.rg=function(e,t,n){this.b[e].appendWindowStart=0,this.b[e].appendWindowEnd=n,this.b[e].appendWindowStart=t,this.Gb(e)},i.vg=function(e){this.c[e][0].p.reject(new he(2,3,3014,this.f.error?this.f.error.code:0))},i.Gb=function(e){var t=this.c[e][0];t&&(t.p.resolve(),Mn(this,e))};var Nn=new Map([["aar","aa"],["abk","ab"],["afr","af"],["aka","ak"],["alb","sq"],["amh","am"],["ara","ar"],["arg","an"],["arm","hy"],["asm","as"],["ava","av"],["ave","ae"],["aym","ay"],["aze","az"],["bak","ba"],["bam","bm"],["baq","eu"],["bel","be"],["ben","bn"],["bih","bh"],["bis","bi"],["bod","bo"],["bos","bs"],["bre","br"],["bul","bg"],["bur","my"],["cat","ca"],["ces","cs"],["cha","ch"],["che","ce"],["chi","zh"],["chu","cu"],["chv","cv"],["cor","kw"],["cos","co"],["cre","cr"],["cym","cy"],["cze","cs"],["dan","da"],["deu","de"],["div","dv"],["dut","nl"],["dzo","dz"],["ell","el"],["eng","en"],["epo","eo"],["est","et"],["eus","eu"],["ewe","ee"],["fao","fo"],["fas","fa"],["fij","fj"],["fin","fi"],["fra","fr"],["fre","fr"],["fry","fy"],["ful","ff"],["geo","ka"],["ger","de"],["gla","gd"],["gle","ga"],["glg","gl"],["glv","gv"],["gre","el"],["grn","gn"],["guj","gu"],["hat","ht"],["hau","ha"],["heb","he"],["her","hz"],["hin","hi"],["hmo","ho"],["hrv","hr"],["hun","hu"],["hye","hy"],["ibo","ig"],["ice","is"],["ido","io"],["iii","ii"],["iku","iu"],["ile","ie"],["ina","ia"],["ind","id"],["ipk","ik"],["isl","is"],["ita","it"],["jav","jv"],["jpn","ja"],["kal","kl"],["kan","kn"],["kas","ks"],["kat","ka"],["kau","kr"],["kaz","kk"],["khm","km"],["kik","ki"],["kin","rw"],["kir","ky"],["kom","kv"],["kon","kg"],["kor","ko"],["kua","kj"],["kur","ku"],["lao","lo"],["lat","la"],["lav","lv"],["lim","li"],["lin","ln"],["lit","lt"],["ltz","lb"],["lub","lu"],["lug","lg"],["mac","mk"],["mah","mh"],["mal","ml"],["mao","mi"],["mar","mr"],["may","ms"],["mkd","mk"],["mlg","mg"],["mlt","mt"],["mon","mn"],["mri","mi"],["msa","ms"],["mya","my"],["nau","na"],["nav","nv"],["nbl","nr"],["nde","nd"],["ndo","ng"],["nep","ne"],["nld","nl"],["nno","nn"],["nob","nb"],["nor","no"],["nya","ny"],["oci","oc"],["oji","oj"],["ori","or"],["orm","om"],["oss","os"],["pan","pa"],["per","fa"],["pli","pi"],["pol","pl"],["por","pt"],["pus","ps"],["que","qu"],["roh","rm"],["ron","ro"],["rum","ro"],["run","rn"],["rus","ru"],["sag","sg"],["san","sa"],["sin","si"],["slk","sk"],["slo","sk"],["slv","sl"],["sme","se"],["smo","sm"],["sna","sn"],["snd","sd"],["som","so"],["sot","st"],["spa","es"],["sqi","sq"],["srd","sc"],["srp","sr"],["ssw","ss"],["sun","su"],["swa","sw"],["swe","sv"],["tah","ty"],["tam","ta"],["tat","tt"],["tel","te"],["tgk","tg"],["tgl","tl"],["tha","th"],["tib","bo"],["tir","ti"],["ton","to"],["tsn","tn"],["tso","ts"],["tuk","tk"],["tur","tr"],["twi","tw"],["uig","ug"],["ukr","uk"],["urd","ur"],["uzb","uz"],["ven","ve"],["vie","vi"],["vol","vo"],["wel","cy"],["wln","wa"],["wol","wo"],["xho","xh"],["yid","yi"],["yor","yo"],["zha","za"],["zho","zh"],["zul","zu"]]),_n={Vd:function(e,t){function n(e){var t="";e.video&&(t=Xe(e.video.codecs)[0]);var n="";return e.audio&&(n=Xe(e.audio.codecs)[0]),t+"-"+n}var r=e.periods.reduce((function(e,t){return e.concat(t.variants)}),[]);r=_n.$d(r,t);for(var i=new Ee,o=(r=p(r)).next();!o.done;o=r.next()){var a=n(o=o.value);i.push(a,o)}var s=null,u=1/0;for(i.forEach((function(e,t){for(var n=0,r=0,i=p(t),o=i.next();!o.done;o=i.next())n+=o.value.bandwidth||0,++r;n/=r,Y.debug("codecs",e,"avg bandwidth",n),n<u&&(s=e,u=n)})),r=(i=p(e.periods)).next();!r.done;r=i.next())(r=r.value).variants=r.variants.filter((function(e){return n(e)==s||(Y.debug("Dropping Variant (better codec available)",e),!1)}))},ld:function(e,t,n){function r(e,t,n){return e>=t&&e<=n}var i=e.video;return!(i&&i.width&&i.height&&(!r(i.width,t.minWidth,Math.min(t.maxWidth,n.width))||!r(i.height,t.minHeight,Math.min(t.maxHeight,n.height))||!r(i.width*i.height,t.minPixels,t.maxPixels))||e&&e.video&&e.video.frameRate&&!r(e.video.frameRate,t.minFrameRate,t.maxFrameRate)||!r(e.bandwidth,t.minBandwidth,t.maxBandwidth))},Sd:function(e,t,n){var r=!1;return e.forEach((function(e){var i=e.allowedByApplication;e.allowedByApplication=_n.ld(e,t,n),i!=e.allowedByApplication&&(r=!0)})),r},filterNewPeriod:function(e,t,n,r){r.variants=r.variants.filter((function(r){if(e&&e.V&&!At(e,r))return Y.debug("Dropping variant - not compatible with key system",r),!1;var i=r.audio;return r=r.video,i&&!gn(i)?(Y.debug("Dropping variant - audio not compatible with platform",_n.yb(i)),!1):r&&!gn(r)?(Y.debug("Dropping variant - video not compatible with platform",_n.yb(r)),!1):i&&t&&!_n.Td(i,t)?(Y.debug("Droping variant - not compatible with active audio","active audio",_n.yb(t),"variant.audio",_n.yb(i)),!1):!(r&&n&&!_n.Td(r,n))||(Y.debug("Droping variant - not compatible with active video","active video",_n.yb(n),"variant.video",_n.yb(r)),!1)})),r.textStreams=r.textStreams.filter((function(e){var t=pn(We(e.mimeType,e.codecs));return t||Y.debug("Dropping text stream. Is not supported by the platform.",e),t}))},Td:function(e,t){return e.mimeType==t.mimeType&&e.codecs.split(".")[0]==t.codecs.split(".")[0]},Qd:function(e){var t=e.audio,n=e.video,r=t?t.codecs:null,i=n?n.codecs:null,o=[];i&&o.push(i),r&&o.push(r);var a=[];n&&a.push(n.mimeType),t&&a.push(t.mimeType),a=a[0]||null;var s=[];t&&s.push(t.kind),n&&s.push(n.kind),s=s[0]||null;var u=new Set;return t&&t.roles.forEach((function(e){return u.add(e)})),n&&n.roles.forEach((function(e){return u.add(e)})),e={id:e.id,active:!1,type:"variant",bandwidth:e.bandwidth,language:e.language,label:null,kind:s,width:null,height:null,frameRate:null,pixelAspectRatio:null,mimeType:a,codecs:o.join(", "),audioCodec:r,videoCodec:i,primary:e.primary,roles:Array.from(u),audioRoles:null,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null},n&&(e.videoId=n.id,e.originalVideoId=n.originalId,e.width=n.width||null,e.height=n.height||null,e.frameRate=n.frameRate||null,e.pixelAspectRatio=n.pixelAspectRatio||null,e.videoBandwidth=n.bandwidth||null),t&&(e.audioId=t.id,e.originalAudioId=t.originalId,e.channelsCount=t.channelsCount,e.audioSamplingRate=t.audioSamplingRate,e.audioBandwidth=t.bandwidth||null,e.label=t.label,e.audioRoles=t.roles),e},Fc:function(e){return{id:e.id,active:!1,type:"text",bandwidth:0,language:e.language,label:e.label,kind:e.kind||null,width:null,height:null,frameRate:null,pixelAspectRatio:null,mimeType:e.mimeType,codecs:e.codecs||null,audioCodec:null,videoCodec:null,primary:e.primary,roles:e.roles,audioRoles:null,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:e.originalId}},ed:function(e){return e.__shaka_id||(e.__shaka_id=_n.Kf++),e.__shaka_id},Kf:0,Ef:function(e){var t=_n.ee(e);return t.active="disabled"!=e.mode,t.type="text",t.originalTextId=e.id,"captions"==e.kind&&(t.mimeType="application/cea-608"),e.kind&&(t.roles=[e.kind]),t},de:function(e){var t=_n.ee(e);return t.active=e.enabled,t.type="variant",t.originalAudioId=e.id,"main"==e.kind&&(t.primary=!0),e.kind&&(t.roles=[e.kind],t.audioRoles=[e.kind]),t},ee:function(e){return{id:_n.ed(e),active:!1,type:"",bandwidth:0,language:Cn(e.language),label:e.label,kind:e.kind,width:null,height:null,frameRate:null,pixelAspectRatio:null,mimeType:null,codecs:null,audioCodec:null,videoCodec:null,primary:!1,roles:[],audioRoles:null,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null}},Bb:function(e){return e.allowedByApplication&&e.allowedByKeySystem},sf:function(e){return e.filter((function(e){return _n.Bb(e)}))},$d:function(e,t){for(var n=e.filter((function(e){return e.audio&&e.audio.channelsCount})),r=new Map,i=(n=p(n)).next();!i.done;i=n.next()){var o=(i=i.value).audio.channelsCount;r.has(o)||r.set(o,[]),r.get(o).push(i)}return 0==(n=Array.from(r.keys())).length?e:(i=n.filter((function(e){return e<=t}))).length?r.get(Math.max.apply(null,i)):r.get(Math.min.apply(null,n))},Sb:function(e,t,n){var r=e,i=e.filter((function(e){return e.primary}));i.length&&(r=i);var o=r.length?r[0].language:"";if(r=r.filter((function(e){return e.language==o})),t){var a=jn(Cn(t),e.map((function(e){return e.language})));a&&(r=e.filter((function(e){return Cn(e.language)==a})))}if(n){if((e=_n.Zd(r,n)).length)return e;Y.m("No exact match for the text role could be found.")}else if((e=r.filter((function(e){return 0==e.roles.length}))).length)return e;return(e=r.map((function(e){return e.roles})).reduce(Bt.Oc,[])).length?_n.Zd(r,e[0]):r},Zd:function(e,t){return e.filter((function(e){return e.roles.includes(t)}))},ce:function(e,t,n){for(var r=0;r<n.length;r++)if(n[r].audio==e&&n[r].video==t)return n[r];return null},Ff:function(e){return"audio"==e.type},If:function(e){return"video"==e.type},Bf:function(e){var t=[];return e.audio&&t.push(e.audio),e.video&&t.push(e.video),t},yb:function(e){return _n.Ff(e)?"type=audio codecs="+e.codecs+" bandwidth="+e.bandwidth+" channelsCount="+e.channelsCount+" audioSamplingRate="+e.audioSamplingRate:_n.If(e)?"type=video codecs="+e.codecs+" bandwidth="+e.bandwidth+" frameRate="+e.frameRate+" width="+e.width+" height="+e.height:"unexpected stream type"}};function Ln(){this.h=null,this.c=!1,this.b=new X,this.g=[],this.i=!1,this.a=this.f=null}function Un(e,t){return e&&(t=t.filter((function(t){return _n.ld(t,e,{width:1/0,height:1/0})}))),t.sort((function(e,t){return e.bandwidth-t.bandwidth}))}function Kn(e,t){this.a=e,this.b=t}function Bn(e,t){var n=new Kn(2,6),r=Hn,i=r.a,o=n.b-i.b;(0<(n.a-i.a||o)?r.c:r.b)(r.a,n,e,t)}function Vn(e,t,n,r){Y.Z([n,"has been deprecated and will be removed in",t,". We are currently at version",e,". Additional information:",r].join(" "))}function Fn(e,t,n,r){Y.jc([n,"has been deprecated and has been removed in",t,". We are now at version",e,". Additional information:",r].join(""))}H("shaka.abr.SimpleAbrManager",Ln),Ln.prototype.stop=function(){this.h=null,this.c=!1,this.g=[],this.f=null},Ln.prototype.stop=Ln.prototype.stop,Ln.prototype.init=function(e){this.h=e},Ln.prototype.init=Ln.prototype.init,Ln.prototype.chooseVariant=function(){var e=Un(this.a.restrictions,this.g),t=this.b.getBandwidthEstimate(this.a.defaultBandwidthEstimate);this.g.length&&!e.length&&(Y.m("No variants met the ABR restrictions. Choosing a variant by lowest bandwidth."),e=[(e=Un(null,this.g))[0]]);for(var n=e[0]||null,r=0;r<e.length;++r){var i=e[r],o=i.bandwidth/this.a.bandwidthDowngradeTarget,a=(e[r+1]||{bandwidth:1/0}).bandwidth/this.a.bandwidthUpgradeTarget;Y.J("Bandwidth ranges:",(i.bandwidth/1e6).toFixed(3),(o/1e6).toFixed(3),(a/1e6).toFixed(3)),t>=o&&t<=a&&(n=i)}return this.f=Date.now(),n},Ln.prototype.chooseVariant=Ln.prototype.chooseVariant,Ln.prototype.enable=function(){this.c=!0},Ln.prototype.enable=Ln.prototype.enable,Ln.prototype.disable=function(){this.c=!1},Ln.prototype.disable=Ln.prototype.disable,Ln.prototype.segmentDownloaded=function(e,t){Y.J("Segment downloaded:","deltaTimeMs="+e,"numBytes="+t,"lastTimeChosenMs="+this.f,"enabled="+this.c);var n=this.b;if(!(16e3>t)){var r=8e3*t/e,i=e/1e3;n.a+=t,G(n.b,i,r),G(n.c,i,r)}if(null!=this.f&&this.c)e:{if(Y.J("Suggesting Streams..."),this.i){if(Date.now()-this.f<1e3*this.a.switchInterval){Y.J("Still within switch interval...");break e}}else{if(!(128e3<=this.b.a)){Y.J("Still waiting for a good estimate...");break e}this.i=!0}n=this.chooseVariant(),r=this.b.getBandwidthEstimate(this.a.defaultBandwidthEstimate),Y.debug("Calling switch_(), bandwidth="+Math.round(r/1e3)+" kbps"),this.h(n)}},Ln.prototype.segmentDownloaded=Ln.prototype.segmentDownloaded,Ln.prototype.getBandwidthEstimate=function(){return this.b.getBandwidthEstimate(this.a.defaultBandwidthEstimate)},Ln.prototype.getBandwidthEstimate=Ln.prototype.getBandwidthEstimate,Ln.prototype.setVariants=function(e){this.g=e},Ln.prototype.setVariants=Ln.prototype.setVariants,Ln.prototype.configure=function(e){this.a=e},Ln.prototype.configure=Ln.prototype.configure,Kn.prototype.toString=function(){return"v"+this.a+"."+this.b};var Hn=null,zn="ended play playing pause pausing ratechange seeked seeking timeupdate volumechange".split(" "),qn="buffered currentTime duration ended loop muted paused playbackRate seeking videoHeight videoWidth volume".split(" "),Gn=["loop","playbackRate"],Wn=["pause","play"],Xn="abrstatuschanged adaptation buffering drmsessionupdate emsg error expirationupdated largegap loading manifestparsed onstatechange onstateidle streaming textchanged texttrackvisibility timelineregionadded timelineregionenter timelineregionexit trackschanged unloading variantchanged".split(" "),Yn={getAssetUri:2,getAudioLanguages:2,getAudioLanguagesAndRoles:2,getBufferedInfo:2,getConfiguration:2,getExpiration:2,getPlaybackRate:2,getTextLanguages:2,getTextLanguagesAndRoles:2,getTextTracks:2,getStats:5,getVariantTracks:2,isAudioOnly:10,isBuffering:1,isInProgress:1,isLive:10,isTextTrackVisible:1,keySystem:10,seekRange:1,usingEmbeddedTextTrack:2,getLoadMode:10},$n={getPlayheadTimeAsDate:1,getPresentationStartTimeAsDate:20},Jn=[["getConfiguration","configure"]],Qn=[["isTextTrackVisible","setTextTrackVisibility"]],Zn="addTextTrack cancelTrickPlay configure resetConfiguration retryStreaming selectAudioLanguage selectEmbeddedTextTrack selectTextLanguage selectTextTrack selectVariantTrack selectVariantsByLabel setTextTrackVisibility trickPlay".split(" "),er=["attach","detach","load","unload"];function tr(e){return JSON.stringify(e,(function(e,t){if("function"!=typeof t){if(t instanceof Event||t instanceof Te){var r={};for(o in t){var i=t[o];i&&"object"==n(i)?"detail"==o&&(r[o]=i):o in Event||(r[o]=i)}return r}if(t instanceof Error){var o=new Set(["name","message","stack"]);for(r in t)o.add(r);for(r=(i=p(Object.getOwnPropertyNames(t))).next();!r.done;r=i.next())o.add(r.value);for(i={},r=(o=p(o)).next();!r.done;r=o.next())i[r=r.value]=t[r];o={__type__:"Error",contents:i}}else if(t instanceof TimeRanges)for(o={__type__:"TimeRanges",length:t.length,start:[],end:[]},r=0;r<t.length;++r)o.start.push(t.start(r)),o.end.push(t.end(r));else o=t instanceof Uint8Array?{__type__:"Uint8Array",entries:Array.from(t)}:"number"==typeof t?isNaN(t)?"NaN":isFinite(t)?t:0>t?"-Infinity":"Infinity":t;return o}}))}function nr(e){return JSON.parse(e,(function(e,t){if("NaN"==t)var r=NaN;else if("-Infinity"==t)r=-1/0;else if("Infinity"==t)r=1/0;else if(t&&"object"==n(t)&&"TimeRanges"==t.__type__)r=function(e){return{length:e.length,start:function(t){return e.start[t]},end:function(t){return e.end[t]}}}(t);else if(t&&"object"==n(t)&&"Uint8Array"==t.__type__)r=new Uint8Array(t.entries);else if(t&&"object"==n(t)&&"Error"==t.__type__){r=t.contents;var i,o=Error(r.message);for(i in r)o[i]=r[i];r=o}else r=t;return r}))}function rr(e,t,n,r,i,o){this.S=e,this.f=new fe(t),this.V=n,this.l=!1,this.v=r,this.K=i,this.G=o,this.b=this.h=!1,this.H="",this.i=null,this.o=this.sd.bind(this),this.u=this.Rf.bind(this),this.a={video:{},player:{}},this.F=0,this.c={},this.g=null,dr.add(this)}var ir=!1,or=null;function ar(e){for(var t=p(dr),n=t.next();!n.done;n=t.next())sr(n.value,e)}function sr(e,t){Y.debug("CastSender: onExistingSessionJoined");var n=e.G();e.g=new ye,e.l=!0,e.ud(n,t)}function ur(e){for(var t=p(dr),n=t.next();!n.done;n=t.next()){n=n.value;var r=e;Y.debug("CastSender: receiver status",r),ir="available"==r,n.f.Gc()}}function cr(e){var t=or;t.removeUpdateListener(e.o),t.removeMessageListener("urn:x-cast:com.google.shaka.v2",e.u)}function lr(e){for(var t in e.c){var n=e.c[t];delete e.c[t],n.reject(new he(1,7,7e3))}}function fr(e,t){var n=tr(t),r=or;try{r.sendMessage("urn:x-cast:com.google.shaka.v2",n,(function(){}),Y.error)}catch(t){throw Y.error("Cast session sendMessage threw",t),n=new he(2,8,8005,t),e.v("player",new Te("error",{detail:n})),e.vb(),n}}(i=rr.prototype).destroy=function(){return dr.delete(this),lr(this),or&&cr(this),this.f&&(this.f.stop(),this.f=null),this.K=this.v=null,this.b=this.h=!1,this.u=this.o=this.g=this.c=this.a=this.i=null,Promise.resolve()},i.ha=function(){return this.b},i.xd=function(){return this.H},i.init=function(){if(e.chrome&&chrome.cast&&chrome.cast.isAvailable&&this.S.length){this.h=!0,this.f.Gc();var t=new chrome.cast.SessionRequest(this.S);t=new chrome.cast.ApiConfig(t,ar.bind(this),ur.bind(this),"origin_scoped"),chrome.cast.initialize(t,(function(){Y.debug("CastSender: init")}),(function(e){Y.error("CastSender: init error",e)})),ir&&this.f.T(.02),(t=or)&&t.status!=chrome.cast.SessionStatus.STOPPED?(Y.debug("CastSender: re-using existing connection"),sr(this,t)):or=null}},i.Gd=function(e){this.i=e,this.b&&fr(this,{type:"appData",appData:this.i})},i.cast=function(e){return this.h?ir?this.b?Promise.reject(new he(1,8,8002)):(this.g=new ye,chrome.cast.requestSession(this.ud.bind(this,e),this.pe.bind(this)),this.g):Promise.reject(new he(1,8,8001)):Promise.reject(new he(1,8,8e3))},i.vb=function(){if(this.b){if(lr(this),or){cr(this);try{or.stop((function(){}),(function(){}))}catch(e){}or=null}this.sd()}},i.get=function(e,t){if("video"==e){if(Wn.includes(t))return this.ye.bind(this,e,t)}else if("player"==e){if($n[t]&&!this.get("player","isLive")())return function(){};if(Zn.includes(t))return this.ye.bind(this,e,t);if(er.includes(t))return this.hg.bind(this,e,t);if(Yn[t])return this.ve.bind(this,e,t)}return this.ve(e,t)},i.set=function(e,t,n){this.a[e][t]=n,fr(this,{type:"set",targetName:e,property:t,value:n})},i.ud=function(e,t){Y.debug("CastSender: onSessionInitiated"),or=t,t.addUpdateListener(this.o),t.addMessageListener("urn:x-cast:com.google.shaka.v2",this.u),this.sd(),fr(this,{type:"init",initState:e,appData:this.i}),this.g.resolve()},i.pe=function(e){var t=8003;switch(e.code){case"cancel":t=8004;break;case"timeout":t=8005;break;case"receiver_unavailable":t=8006}this.g.reject(new he(2,8,t,e))},i.ve=function(e,t){return this.a[e][t]},i.ye=function(e,t,n){for(var r=[],i=2;i<arguments.length;++i)r[i-2]=arguments[i];fr(this,{type:"call",targetName:e,methodName:t,args:r})},i.hg=function(e,t,n){for(var r=[],i=2;i<arguments.length;++i)r[i-2]=arguments[i];i=new ye;var o=this.F.toString();this.F++,this.c[o]=i;try{fr(this,{type:"asyncCall",targetName:e,methodName:t,args:r,id:o})}catch(e){i.reject(e)}return i},i.sd=function(){var e=!!or&&"connected"==or.status;if(Y.debug("CastSender: connection status",e),this.b&&!e){for(var t in this.K(),this.a)this.a[t]={};lr(this)}this.H=(this.b=e)?or.receiver.friendlyName:"",this.f.Gc()},i.Rf=function(e,t){var n=nr(t);switch(Y.J("CastSender: message",n),n.type){case"event":var r=n.event;this.v(n.targetName,new Te(r.type,r));break;case"update":for(var i in r=n.update)for(var o in n=this.a[i]||{},r[i])n[o]=r[i][o];this.l&&(this.V(),this.l=!1);break;case"asyncComplete":if(i=n.id,n=n.error,o=this.c[i],delete this.c[i],o)if(n){for(r in i=new he(n.severity,n.category,n.code),n)i[r]=n[r];o.reject(i)}else o.resolve()}};var dr=new Set;function pr(e,t,n){var r=this;Pe.call(this),this.c=e,this.b=t,this.i=this.g=this.f=this.l=this.h=null,this.u=n,this.o=new Map,this.a=new rr(n,(function(){return mr(r)}),(function(){return vr(r)}),(function(e,t){return br(r,e,t)}),(function(){return gr(r)}),(function(){return yr(r)})),function(e){for(var t in e.a.init(),e.i=new Ue,zn.forEach(function(e){this.i.B(this.c,e,this.G.bind(this))}.bind(e)),Xn.forEach(function(e){this.i.B(this.b,e,this.v.bind(this))}.bind(e)),e.h={},e.c)Object.defineProperty(e.h,t,{configurable:!1,enumerable:!0,get:e.F.bind(e,t),set:e.H.bind(e,t)});e.l={},hr(e,(function(t){Object.defineProperty(e.l,t,{configurable:!1,enumerable:!0,get:function(){return function e(t,n){if(t.o.has(n)&&(n=t.o.get(n)),"addEventListener"==n)return t.g.addEventListener.bind(t.g);if("removeEventListener"==n)return t.g.removeEventListener.bind(t.g);if("getMediaElement"==n)return function(){return this.h}.bind(t);if("getSharedConfiguration"==n)return Y.m("Can't share configuration across a network. Returning copy."),t.a.get("player","getConfiguration");if("getNetworkingEngine"==n)return t.a.ha()&&Y.m("NOTE: getNetworkingEngine() is always local!"),t.b.Ub.bind(t.b);if(t.a.ha()){if("getManifest"==n||"drmInfo"==n)return function(){return Y.Z(n+"() does not work while casting!"),null};if("getManifestUri"==n)return Bn("getManifestUri",'Please use "getAssetUri" instead.'),e(t,"getAssetUri");if("attach"==n||"detach"==n)return function(){return Y.Z(n+"() does not work while casting!"),Promise.resolve()}}return t.a.ha()&&0==Object.keys(t.a.a.video).length&&Yn[n]||!t.a.ha()?t.b[n].bind(t.b):t.a.get("player",n)}(e,t)}})})),function(e){var t=new Map;hr(e,(function(n,r){if(t.has(r)){var i=t.get(r);n.length<i.length?e.o.set(n,i):e.o.set(i,n)}else t.set(r,n)}))}(e),e.f=new Pe,e.f.gc=e.h,e.g=new Pe,e.g.gc=e.l}(this)}function hr(e,t){function n(e){return"constructor"!=e&&"function"==typeof r[e]&&!i.has(e)}var r=e.b,i=new Set;for(o in r)n(o)&&(i.add(o),t(o,r[o]));for(var o=Object.getPrototypeOf(r),a=Object.getPrototypeOf({});o&&o!=a;){for(var s=p(Object.getOwnPropertyNames(o)),u=s.next();!u.done;u=s.next())n(u=u.value)&&(i.add(u),t(u,r[u]));o=Object.getPrototypeOf(o)}}function yr(e){var t={video:{},player:{},playerAfterLoad:{},manifest:e.b.pc(),startTime:null};return e.c.pause(),Gn.forEach(function(e){t.video[e]=this.c[e]}.bind(e)),e.c.ended||(t.startTime=e.c.currentTime),Jn.forEach(function(e){var n=e[1];e=this.b[e[0]](),t.player[n]=e}.bind(e)),Qn.forEach(function(e){var n=e[1];e=this.b[e[0]](),t.playerAfterLoad[n]=e}.bind(e)),t}function mr(e){e.dispatchEvent(new Te("caststatuschanged"))}function vr(e){e.f.dispatchEvent(new Te(e.h.paused?"pause":"play"))}function gr(e){Jn.forEach(function(e){var t=e[1];e=this.a.get("player",e[0])(),this.b[t](e)}.bind(e));var t=e.a.get("player","getAssetUri")(),n=e.a.get("video","ended"),r=Promise.resolve(),i=e.c.autoplay,o=null;n||(o=e.a.get("video","currentTime")),t&&(e.c.autoplay=!1,r=e.b.load(t,o));var a={};Gn.forEach(function(e){a[e]=this.a.get("video",e)}.bind(e)),r.then((function(){e.c&&(Gn.forEach(function(e){this.c[e]=a[e]}.bind(e)),Qn.forEach(function(e){var t=e[1];e=this.a.get("player",e[0])(),this.b[t](e)}.bind(e)),e.c.autoplay=i,t&&e.c.play())}),(function(t){e.b.dispatchEvent(new Te("error",{detail:t}))}))}function br(e,t,n){e.a.ha()&&("video"==t?e.f.dispatchEvent(n):"player"==t&&e.g.dispatchEvent(n))}function wr(e,t,n,r){var i=this;Pe.call(this),this.a=e,this.b=t,this.c=new Ue,this.G={video:e,player:t},this.u=n||function(){},this.H=r||function(e){return e},this.v=!1,this.h=!0,this.g=0,this.o=!1,this.l=!0,this.i=this.f=null,this.F=new fe((function(){Tr(i)})),function(e){var t=cast.receiver.CastReceiverManager.getInstance();t.onSenderConnected=e.re.bind(e),t.onSenderDisconnected=e.re.bind(e),t.onSystemVolumeChanged=e.af.bind(e),e.i=t.getCastMessageBus("urn:x-cast:com.google.cast.media"),e.i.onMessage=e.Mf.bind(e),e.f=t.getCastMessageBus("urn:x-cast:com.google.shaka.v2"),e.f.onMessage=e.Wf.bind(e),t.start(),zn.forEach(function(e){this.c.B(this.a,e,this.we.bind(this,"video"))}.bind(e)),Xn.forEach(function(e){this.c.B(this.b,e,this.we.bind(this,"player"))}.bind(e)),cast.__platform__&&cast.__platform__.canDisplayType('video/mp4; codecs="avc1.640028"; width=3840; height=2160')?e.b.Hd(3840,2160):e.b.Hd(1920,1080),e.c.B(e.a,"loadeddata",function(){this.o=!0}.bind(e)),e.c.B(e.b,"loading",function(){this.h=!1,Sr(this)}.bind(e)),e.c.B(e.a,"playing",function(){this.h=!1,Sr(this)}.bind(e)),e.c.B(e.a,"pause",function(){Sr(this)}.bind(e)),e.c.B(e.b,"unloading",function(){this.h=!0,Sr(this)}.bind(e)),e.c.B(e.a,"ended",function(){var e=this;new fe((function(){e.a&&e.a.ended&&(e.h=!0,Sr(e))})).T(5)}.bind(e))}(this)}function Sr(e){Promise.resolve().then(function(){this.b&&(this.dispatchEvent(new Te("caststatuschanged")),Er(this)||xr(this))}.bind(e))}function Tr(e){e.F.T(.5);var t={video:{},player:{}};if(qn.forEach(function(e){t.video[e]=this.a[e]}.bind(e)),e.b.X())for(var n in $n)0==e.g%$n[n]&&(t.player[n]=e.b[n]());for(var r in Yn)0==e.g%Yn[r]&&(t.player[r]=e.b[r]());(n=cast.receiver.CastReceiverManager.getInstance().getSystemVolume())&&(t.video.volume=n.level,t.video.muted=n.muted),e.o&&(e.g+=1),kr(e,{type:"update",update:t},e.f),Er(e)}function Er(e){return!(!e.l||!e.a.duration&&!e.b.X())&&(Pr(e),e.l=!1,!0)}function Pr(e,t){t=void 0===t?0:t;var n={contentId:e.b.pc(),streamType:e.b.X()?"LIVE":"BUFFERED",contentType:""};e.b.X()||(n.duration=e.a.duration),xr(e,t,n)}function kr(e,t,n,r){e.v&&(e=tr(t),r?n.getCastChannel(r).send(e):n.broadcast(e))}function xr(e,t,n){t=void 0===t?0:t,n=void 0===n?null:n;var r=e.a.playbackRate,i=Ar;r={mediaSessionId:0,playbackRate:r,playerState:i=e.h?i.IDLE:e.b.fd()?i.Je:e.a.paused?i.Le:i.Me,currentTime:e.a.currentTime,supportedMediaCommands:63,volume:{level:e.a.volume,muted:e.a.muted}},n&&(r.media=n),kr(e,{requestId:t,type:"MEDIA_STATUS",status:[r]},e.i)}e.__onGCastApiAvailable=function(e){if(e)for(var t=(e=p(dr)).next();!t.done;t=e.next())t.value.init()},z(pr,Pe),H("shaka.cast.CastProxy",pr),pr.prototype.destroy=function(e){return e&&this.a.vb(),this.i&&(this.i.release(),this.i=null),e=[],this.b&&(e.push(this.b.destroy()),this.b=null),this.a&&(e.push(this.a.destroy()),this.a=null),this.l=this.h=this.c=null,Promise.all(e)},pr.prototype.destroy=pr.prototype.destroy,pr.prototype.Cf=function(){return this.h},pr.prototype.getVideo=pr.prototype.Cf,pr.prototype.uf=function(){return this.l},pr.prototype.getPlayer=pr.prototype.uf,pr.prototype.Re=function(){return this.a.h&&ir},pr.prototype.canCast=pr.prototype.Re,pr.prototype.ha=function(){return this.a.ha()},pr.prototype.isCasting=pr.prototype.ha,pr.prototype.xd=function(){return this.a.xd()},pr.prototype.receiverName=pr.prototype.xd,pr.prototype.cast=function(){var e=yr(this);return this.a.cast(e).then(function(){if(this.b)return this.b.Od()}.bind(this))},pr.prototype.cast=pr.prototype.cast,pr.prototype.Gd=function(e){this.a.Gd(e)},pr.prototype.setAppData=pr.prototype.Gd,pr.prototype.Cg=function(){var e=this.a;if(e.b){var t=e.G();chrome.cast.requestSession(e.ud.bind(e,t),e.pe.bind(e))}},pr.prototype.suggestDisconnect=pr.prototype.Cg,pr.prototype.Ue=function(e){var t=this;return y((function n(){return L(n,(function(n){switch(n.j){case 1:return e==t.u?n.return():(t.u=e,t.a.vb(),k(n,t.a.destroy(),2));case 2:t.a=null,t.a=new rr(e,(function(){return mr(t)}),(function(){return vr(t)}),(function(e,n){return br(t,e,n)}),(function(){return gr(t)}),(function(){return yr(t)})),t.a.init(),x(n)}}))}))},pr.prototype.changeReceiverId=pr.prototype.Ue,pr.prototype.vb=function(){this.a.vb()},pr.prototype.forceDisconnect=pr.prototype.vb,pr.prototype.F=function(e){if("addEventListener"==e)return this.f.addEventListener.bind(this.f);if("removeEventListener"==e)return this.f.removeEventListener.bind(this.f);if(this.a.ha()&&0==Object.keys(this.a.a.video).length){var t=this.c[e];if("function"!=typeof t)return t}return this.a.ha()?this.a.get("video",e):("function"==typeof(e=this.c[e])&&(e=e.bind(this.c)),e)},pr.prototype.H=function(e,t){this.a.ha()?this.a.set("video",e,t):this.c[e]=t},pr.prototype.G=function(e){this.a.ha()||this.f.dispatchEvent(new Te(e.type,e))},pr.prototype.v=function(e){this.a.ha()||this.g.dispatchEvent(e)},z(wr,Pe),H("shaka.cast.CastReceiver",wr),wr.prototype.isConnected=function(){return this.v},wr.prototype.isConnected=wr.prototype.isConnected,wr.prototype.Hf=function(){return this.h},wr.prototype.isIdle=wr.prototype.Hf,wr.prototype.destroy=function(){var e=this;return y((function t(){var n;return L(t,(function(t){switch(t.j){case 1:return e.c&&(e.c.release(),e.c=null),n=[],e.b&&(n.push(e.b.destroy()),e.b=null),e.F&&(e.F.stop(),e.F=null),e.a=null,e.G=null,e.u=null,e.v=!1,e.h=!0,e.f=null,e.i=null,k(t,Promise.all(n),2);case 2:cast.receiver.CastReceiverManager.getInstance().stop(),x(t)}}))}))},wr.prototype.destroy=wr.prototype.destroy,(i=wr.prototype).re=function(){this.g=0,this.l=!0,this.v=0!=cast.receiver.CastReceiverManager.getInstance().getSenders().length,Sr(this)},i.we=function(e,t){this.b&&(Tr(this),kr(this,{type:"event",targetName:e,event:t},this.f))},i.af=function(){var e=cast.receiver.CastReceiverManager.getInstance().getSystemVolume();e&&kr(this,{type:"update",update:{video:{volume:e.level,muted:e.muted}}},this.f),kr(this,{type:"event",targetName:"video",event:{type:"volumechange"}},this.f)},i.Wf=function(e){var t=nr(e.data);switch(Y.debug("CastReceiver: message",t),t.type){case"init":this.g=0,this.o=!1,this.l=!0,function(e,t,n){for(var r in t.player)e.b[r](t.player[r]);e.u(n),n=Promise.resolve();var i=e.a.autoplay;t.manifest&&(e.a.autoplay=!1,n=e.b.load(t.manifest,t.startTime)),n.then((function(){if(e.b){for(var n in t.video)e.a[n]=t.video[n];for(var r in t.playerAfterLoad)e.b[r](t.playerAfterLoad[r]);e.a.autoplay=i,t.manifest&&(e.a.play(),xr(e))}}),(function(t){e.b.dispatchEvent(new Te("error",{detail:t}))}))}(this,t.initState,t.appData),Tr(this);break;case"appData":this.u(t.appData);break;case"set":var n=t.targetName,r=t.property;if(t=t.value,"video"==n){var i=cast.receiver.CastReceiverManager.getInstance();if("volume"==r){i.setSystemVolumeLevel(t);break}if("muted"==r){i.setSystemVolumeMuted(t);break}}this.G[n][r]=t;break;case"call":(n=this.G[t.targetName])[t.methodName].apply(n,t.args);break;case"asyncCall":n=t.targetName,r=t.methodName,"player"==n&&"load"==r&&(this.g=0,this.o=!1),i=t.id,e=e.senderId;var o=this.G[n];t=o[r].apply(o,t.args),"player"==n&&"load"==r&&(t=t.then(function(){this.l=!0}.bind(this))),t.then(this.Be.bind(this,e,i,null),this.Be.bind(this,e,i))}},i.Mf=function(e){var t=nr(e.data);switch(Y.debug("CastReceiver: message",t),t.type){case"PLAY":this.a.play(),xr(this);break;case"PAUSE":this.a.pause(),xr(this);break;case"SEEK":e=t.currentTime;var n=t.resumeState;null!=e&&(this.a.currentTime=Number(e)),n&&"PLAYBACK_START"==n?(this.a.play(),xr(this)):n&&"PLAYBACK_PAUSE"==n&&(this.a.pause(),xr(this));break;case"STOP":this.b.Od().then(function(){this.b&&xr(this)}.bind(this));break;case"GET_STATUS":Pr(this,Number(t.requestId));break;case"VOLUME":e=(n=t.volume).level,n=n.muted;var r=this.a.volume,i=this.a.muted;null!=e&&(this.a.volume=Number(e)),null!=n&&(this.a.muted=n),r==this.a.volume&&i==this.a.muted||xr(this);break;case"LOAD":this.g=0,this.l=this.o=!1,e=t.media,n=t.currentTime,r=this.H(e.contentId),i=t.autoplay||!0,this.u(e.customData),i&&(this.a.autoplay=!0),this.b.load(r,n).then(function(){this.b&&Pr(this)}.bind(this)).catch(function(e){var n="LOAD_FAILED";7==e.category&&7e3==e.code&&(n="LOAD_CANCELLED"),kr(this,{requestId:Number(t.requestId),type:n},this.i)}.bind(this));break;default:Y.m("Unrecognized message type from the generic Chromecast controller!",t.type),kr(this,{requestId:Number(t.requestId),type:"INVALID_REQUEST",reason:"INVALID_COMMAND"},this.i)}},i.Be=function(e,t,n){this.b&&kr(this,{type:"asyncComplete",id:t,error:n},this.f,e)};var Ar={IDLE:"IDLE",Me:"PLAYING",Je:"BUFFERING",Le:"PAUSED"};function Or(e,t){this.N=e,this.b=t==Mr,this.a=0}H("shaka.util.DataViewReader",Or);var Mr=1;function Ir(){throw new he(2,3,3e3)}function Rr(){this.c=[],this.b=[],this.a=!1}function Cr(e){for(var t=null!=e.flags?12:8;e.reader.ya()&&!e.parser.a;)e.parser.Ac(e.start+t,e.reader,e.partialOkay)}function Dr(e){for(var t=null!=e.flags?12:8,n=e.reader.I();0<n&&!e.parser.a;--n)e.parser.Ac(e.start+t,e.reader,e.partialOkay)}function jr(e){return function(t){e(t.reader.gb(t.reader.N.byteLength-t.reader.ga()))}}function Nr(e){for(var t=0,n=0;n<e.length;n++)t=t<<8|e.charCodeAt(n);return t}function _r(e){return String.fromCharCode(e>>24&255,e>>16&255,e>>8&255,255&e)}function Lr(e){var t=this;this.a=[],this.b=[],this.data=[],(new Rr).L("moov",Cr).ia("pssh",(function(e){if(1<e.version)Y.m("Unrecognized PSSH version found!");else{var n=e.reader.N;if(n=new Uint8Array(n.buffer,n.byteOffset-12,e.size),t.data.push(n),t.a.push(ft.Ic(e.reader.gb(16))),0<e.version){n=e.reader.I();for(var r=0;r<n;++r){var i=ft.Ic(e.reader.gb(16));t.b.push(i)}}}})).parse(e),0==this.data.length&&Y.m("No pssh box found!")}Or.Endianness={Lg:0,Ng:Mr},Or.prototype.ya=function(){return this.a<this.N.byteLength},Or.prototype.hasMoreData=Or.prototype.ya,Or.prototype.ga=function(){return this.a},Or.prototype.getPosition=Or.prototype.ga,Or.prototype.hf=function(){return this.N.byteLength},Or.prototype.getLength=Or.prototype.hf,Or.prototype.na=function(){try{var e=this.N.getUint8(this.a);return this.a+=1,e}catch(e){Ir()}},Or.prototype.readUint8=Or.prototype.na,Or.prototype.$b=function(){try{var e=this.N.getUint16(this.a,this.b);return this.a+=2,e}catch(e){Ir()}},Or.prototype.readUint16=Or.prototype.$b,Or.prototype.I=function(){try{var e=this.N.getUint32(this.a,this.b);return this.a+=4,e}catch(e){Ir()}},Or.prototype.readUint32=Or.prototype.I,Or.prototype.xe=function(){try{var e=this.N.getInt32(this.a,this.b);return this.a+=4,e}catch(e){Ir()}},Or.prototype.readInt32=Or.prototype.xe,Or.prototype.Kb=function(){try{if(this.b)var e=this.N.getUint32(this.a,!0),t=this.N.getUint32(this.a+4,!0);else t=this.N.getUint32(this.a,!1),e=this.N.getUint32(this.a+4,!1)}catch(e){Ir()}if(2097151<t)throw new he(2,3,3001);return this.a+=8,t*Math.pow(2,32)+e},Or.prototype.readUint64=Or.prototype.Kb,Or.prototype.gb=function(e){this.a+e>this.N.byteLength&&Ir();var t=new Uint8Array(this.N.buffer,this.N.byteOffset+this.a,e);return this.a+=e,t},Or.prototype.readBytes=Or.prototype.gb,Or.prototype.P=function(e){this.a+e>this.N.byteLength&&Ir(),this.a+=e},Or.prototype.skip=Or.prototype.P,Or.prototype.ze=function(e){this.a<e&&Ir(),this.a-=e},Or.prototype.rewind=Or.prototype.ze,Or.prototype.seek=function(e){(0>e||e>this.N.byteLength)&&Ir(),this.a=e},Or.prototype.seek=Or.prototype.seek,Or.prototype.wd=function(){for(var e=this.a;this.ya()&&0!=this.N.getUint8(this.a);)this.a+=1;return e=new Uint8Array(this.N.buffer,this.N.byteOffset+e,this.a-e),this.a+=1,it(e)},Or.prototype.readTerminatedString=Or.prototype.wd,H("shaka.util.Mp4Parser",Rr),Rr.prototype.L=function(e,t){var n=Nr(e);return this.c[n]=0,this.b[n]=t,this},Rr.prototype.box=Rr.prototype.L,Rr.prototype.ia=function(e,t){var n=Nr(e);return this.c[n]=1,this.b[n]=t,this},Rr.prototype.fullBox=Rr.prototype.ia,Rr.prototype.stop=function(){this.a=!0},Rr.prototype.stop=Rr.prototype.stop,Rr.prototype.parse=function(e,t){var n=new Uint8Array(e);for(n=new Or(new DataView(n.buffer,n.byteOffset,n.byteLength),0),this.a=!1;n.ya()&&!this.a;)this.Ac(0,n,t)},Rr.prototype.parse=Rr.prototype.parse,Rr.prototype.Ac=function(e,t,n){var r=t.ga(),i=t.I(),o=t.I();switch(Y.J("Parsing MP4 box",_r(o)),i){case 0:i=t.N.byteLength-r;break;case 1:i=t.Kb()}var a=this.b[o];if(a){var s=null,u=null;1==this.c[o]&&(s=(u=t.I())>>>24,u&=16777215),o=r+i,n&&o>t.N.byteLength&&(o=t.N.byteLength),o-=t.ga(),t=0<o?t.gb(o):new Uint8Array(0),a({parser:this,partialOkay:n||!1,version:s,flags:u,reader:t=new Or(new DataView(t.buffer,t.byteOffset,t.byteLength),0),size:i,start:r+e})}else t.P(Math.min(r+i-t.ga(),t.N.byteLength-t.ga()))},Rr.prototype.parseNext=Rr.prototype.Ac,Rr.children=Cr,Rr.sampleDescription=Dr,Rr.allData=jr,Rr.typeToString=_r;var Ur={oc:function(e,t){var n=Ur.U(e,t);return 1!=n.length?null:n[0]},Wc:function(e,t,n){return 1!=(e=Ur.ae(e,t,n)).length?null:e[0]},U:function(e,t){return Array.prototype.filter.call(e.childNodes,(function(e){return e instanceof Element&&e.tagName==t}))},ae:function(e,t,n){return Array.prototype.filter.call(e.childNodes,(function(e){return e instanceof Element&&e.localName==n&&e.namespaceURI==t}))},getAttributeNS:function(e,t,n){return e.hasAttributeNS(t,n)?e.getAttributeNS(t,n):null},qc:function(e){return Array.prototype.every.call(e.childNodes,(function(e){return e.nodeType==Node.TEXT_NODE||e.nodeType==Node.CDATA_SECTION_NODE}))?e.textContent.trim():null},M:function(e,t,n,r){r=void 0===r?null:r;var i=null;return null!=(e=e.getAttribute(t))&&(i=n(e)),null==i?r:i},$f:function(e){return e?(/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(e)&&(e+="Z"),e=Date.parse(e),isNaN(e)?null:Math.floor(e/1e3)):null},Ia:function(e){if(!e)return null;var t=/^P(?:([0-9]*)Y)?(?:([0-9]*)M)?(?:([0-9]*)D)?(?:T(?:([0-9]*)H)?(?:([0-9]*)M)?(?:([0-9.]*)S)?)?$/.exec(e);return t?(e=31536e3*Number(t[1]||null)+2592e3*Number(t[2]||null)+86400*Number(t[3]||null)+3600*Number(t[4]||null)+60*Number(t[5]||null)+Number(t[6]||null),isFinite(e)?e:null):(Y.m("Invalid duration string:",e),null)},Cc:function(e){var t=/([0-9]+)-([0-9]+)/.exec(e);return t?(e=Number(t[1]),isFinite(e)?(t=Number(t[2]),isFinite(t)?{start:e,end:t}:null):null):null},parseInt:function(e){return 0==(e=Number(e))%1?e:null},Bc:function(e){return 0==(e=Number(e))%1&&0<e?e:null},Hb:function(e){return 0==(e=Number(e))%1&&0<=e?e:null},parseFloat:function(e){return e=Number(e),isNaN(e)?null:e},Ze:function(e){var t;return e=(t=e.match(/^(\d+)\/(\d+)$/))?Number(t[1])/Number(t[2]):Number(e),isNaN(e)?null:e},ue:function(e,t){var n=new DOMParser;try{var r=n.parseFromString(e,"text/xml")}catch(e){}if(r&&r.documentElement.tagName==t)var i=r.documentElement;return i&&0<i.getElementsByTagName("parsererror").length?null:i},te:function(e,t){try{var n=it(e);return Ur.ue(n,t)}catch(e){}}},Kr=(new Map).set("urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b","org.w3.clearkey").set("urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed","com.widevine.alpha").set("urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95","com.microsoft.playready").set("urn:uuid:79f0049a-4098-8642-ab92-e65be0885f95","com.microsoft.playready").set("urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb","com.adobe.primetime");function Br(e,t,n){var r=function(e){for(var t=[],n=(e=p(e)).next();!n.done;n=e.next())(n=Hr(n.value))&&t.push(n);return t}(e),i=null;e=[];var o=[],a=new Set(r.map((function(e){return e.keyId})));if(a.delete(null),1<a.size)throw new he(2,4,4010);if(n||(o=r.filter((function(e){return"urn:mpeg:dash:mp4protection:2011"!=e.Ae||(i=e.init||i,!1)}))).length&&(0==(e=function(e,t,n){for(var r=[],i=(n=p(n)).next();!i.done;i=n.next()){i=i.value;var o=Kr.get(i.Ae);if(o){var a;if(a=Ur.Wc(i.node,"urn:microsoft:playready","pro")){a=ft.Fa(a.textContent);var s=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]),u=a.length,c=s.length+16+u,l=new ArrayBuffer(c),f=new Uint8Array(l);l=new DataView(l);var d=0;l.setUint32(d,c),d+=4,l.setUint32(d,1886614376),d+=4,l.setUint32(d,0),d+=4,f.set(s,d),d+=s.length,l.setUint32(d,u),d+=4,f.set(a,d),a=[{initData:f,initDataType:"cenc",keyId:i.keyId}]}else a=null;a=Ft(o,i.init||e||a),(o=Fr.get(o))&&(a.licenseServerUri=o(i)),r.push(a)}else for(i=p(i=t(i.node)||[]),o=i.next();!o.done;o=i.next())r.push(o.value)}return r}(i,t,o)).length&&(e=[Ft("",i)])),r.length&&(n||!o.length))for(e=[],n=(t=p(Kr.values())).next();!n.done;n=t.next())"org.w3.clearkey"!=(n=n.value)&&e.push(Ft(n,i));if(a=Array.from(a)[0]||null)for(n=(t=p(e)).next();!n.done;n=t.next())for(r=(n=p(n.value.initData)).next();!r.done;r=n.next())r.value.keyId=a;return{Xd:a,Pg:i,drmInfos:e,be:!0}}var Vr,Fr=(new Map).set("com.widevine.alpha",(function(e){return(e=Ur.Wc(e.node,"urn:microsoft","laurl"))&&e.getAttribute("licenseUrl")||""})).set("com.microsoft.playready",(function(e){return(e=Ur.Wc(e.node,"urn:microsoft:playready","pro"))&&(e=function(e){var t=0,n=new DataView(e).getUint32(t,!0);if(t+=4,n!==e.byteLength)return Y.m("PlayReady Object with invalid length encountered."),[];t+=2,n=[];for(var r=new DataView(e);t<e.byteLength-1;){var i=r.getUint16(t,!0);t+=2;var o=r.getUint16(t,!0);t+=2;var a=new Uint8Array(e,t,o);n.push({type:i,value:a}),t+=o}return n}((e=ft.Fa(e.textContent)).buffer).filter((function(e){return 1===e.type}))[0])?(e=ot(e.value,!0),(e=Ur.ue(e,"WRMHEADER"))?function(e){for(var t=(e=p(e.getElementsByTagName("DATA"))).next();!t.done;t=e.next())for(var n=(t=p(t.value.childNodes)).next();!n.done;n=t.next())if((n=n.value)instanceof Element&&"LA_URL"==n.tagName)return n.textContent;return""}(e):""):""}));function Hr(e){var t=e.getAttribute("schemeIdUri"),n=Ur.getAttributeNS(e,"urn:mpeg:cenc:2013","default_KID"),r=Ur.ae(e,"urn:mpeg:cenc:2013","pssh").map(Ur.qc);if(!t)return Y.error("Missing required schemeIdUri attribute on","ContentProtection element",e),null;if(t=t.toLowerCase(),n&&(n=n.replace(/-/g,"").toLowerCase()).includes(" "))throw new he(2,4,4009);var i=[];try{i=r.map((function(e){return{initDataType:"cenc",initData:ft.Fa(e),keyId:null}}))}catch(e){throw new he(2,4,4007)}return{node:e,Ae:t,keyId:n,init:0<i.length?i:null}}function zr(t,n,r,i,o){var a={RepresentationID:n,Number:r,Bandwidth:i,Time:o};return t.replace(/\$(RepresentationID|Number|Bandwidth|Time)?(?:%0([0-9]+)([diouxX]))?\$/g,(function(n,r,i,o){if("$$"==n)return"$";var s=a[r];if(null==s)return Y.m("URL template does not have an available substitution for identifier",'"'+r+'":',t),n;switch("RepresentationID"==r&&i&&(Y.m("URL template should not contain a width specifier for identifier",'"RepresentationID":',t),i=void 0),"Time"==r&&(s=Math.round(s)),o){case void 0:case"d":case"i":case"u":n=s.toString();break;case"o":n=s.toString(8);break;case"x":n=s.toString(16);break;case"X":n=s.toString(16).toUpperCase();break;default:n=s.toString()}return i=e.parseInt(i,10)||1,Array(Math.max(0,i-n.length)+1).join("0")+n}))}function qr(e,t){var n=Gr(e,t,"timescale"),r=1;n&&(r=Ur.Bc(n)||1),n=Gr(e,t,"duration"),(n=Ur.Bc(n||""))&&(n/=r);var i=Gr(e,t,"startNumber"),o=Number(Gr(e,t,"presentationTimeOffset"))||0,a=Ur.Hb(i||"");null!=i&&null!=a||(a=1);var s=Wr(e,t,"SegmentTimeline");if(i=null,s){i=r;var u=e.W.duration||1/0;s=Ur.U(s,"S");for(var c=[],l=-o,f=0;f<s.length;++f){var d=s[f],p=Ur.M(d,"t",Ur.Hb),h=Ur.M(d,"d",Ur.Hb),y=Ur.M(d,"r",Ur.parseInt);if(null!=p&&(p-=o),!h){Y.m('"S" element must have a duration:','ignoring the remaining "S" elements.',d);break}if(p=null!=p?p:l,0>(y=y||0))if(f+1<s.length){if(null==(y=Ur.M(s[f+1],"t",Ur.Hb))){Y.m('An "S" element cannot have a negative repeat','if the next "S" element does not have a valid start time:','ignoring the remaining "S" elements.',d);break}if(p>=y){Y.m('An "S" element cannot have a negative repeat','if its start time exceeds the next "S" element\'s start time:','ignoring the remaining "S" elements.',d);break}y=Math.ceil((y-p)/h)-1}else{if(1/0==u){Y.m('The last "S" element cannot have a negative repeat',"if the Period has an infinite duration:",'ignoring the last "S" element.',d);break}if(p/i>=u){Y.m('The last "S" element cannot have a negative repeat',"if its start time exceeds the Period's duration:",'igoring the last "S" element.',d);break}y=Math.ceil((u*i-p)/h)-1}for(0<c.length&&p!=l&&(Math.abs((p-l)/i)>=1/15&&Y.m("SegmentTimeline contains a large gap/overlap:","the content may have errors in it.",d),c[c.length-1].end=p/i),d=0;d<=y;++d)l=p+h,c.push({start:p/i,end:l/i,Hg:p}),p=l}i=c}return{timescale:r,da:n,ib:a,oa:o/r||0,Pd:o,R:i}}function Gr(e,t,n){return[t(e.A),t(e.aa),t(e.ma)].filter(Bt.Ma).map((function(e){return e.getAttribute(n)})).reduce((function(e,t){return e||t}))}function Wr(e,t,n){return[t(e.A),t(e.aa),t(e.ma)].filter(Bt.Ma).map((function(e){return Ur.oc(e,n)})).reduce((function(e,t){return e||t}))}function Xr(e,t,n,r,i,o){if(o=void 0===o?0:o,Ur.getAttributeNS(e,"http://www.w3.org/1999/xlink","href")){var a=function(e,t,n,r,i,o){for(var a=Ur.getAttributeNS(e,"http://www.w3.org/1999/xlink","href"),s=Ur.getAttributeNS(e,"http://www.w3.org/1999/xlink","actuate")||"onRequest",u=0;u<e.attributes.length;u++){var c=e.attributes[u];"http://www.w3.org/1999/xlink"==c.namespaceURI&&(e.removeAttributeNS(c.namespaceURI,c.localName),--u)}if(5<=o)return ve(new he(2,4,4028));if("onLoad"!=s)return ve(new he(2,4,4027));var l=Vt([r],[a]);return i.request(0,je(l,t)).Y((function(r){if(!(r=Ur.te(r.data,e.tagName)))return ve(new he(2,4,4001,a));for(;e.childNodes.length;)e.removeChild(e.childNodes[0]);for(;r.childNodes.length;){var s=r.childNodes[0];r.removeChild(s),e.appendChild(s)}for(s=0;s<r.attributes.length;s++){var u=r.attributes[s].nodeName,c=r.getAttribute(u);e.setAttribute(u,c)}return Xr(e,t,n,l[0],i,o+1)}))}(e,t,n,r,i,o);return n&&(a=a.Y(void 0,(function(){return Xr(e,t,n,r,i,o)}))),a}a=[];for(var s=0;s<e.childNodes.length;s++){var u=e.childNodes[s];u instanceof Element&&("urn:mpeg:dash:resolve-to-zero:2013"==Ur.getAttributeNS(u,"http://www.w3.org/1999/xlink","href")?(e.removeChild(u),--s):"SegmentTimeline"!=u.tagName&&a.push(Xr(u,t,n,r,i,o)))}return Se(a).Y((function(){return e}))}function Yr(e,t,n){this.c=e,this.b=t,this.a=n}function $r(e,t,n,r,i,o){this.position=e,this.startTime=t,this.endTime=n,this.c=r,this.b=i,this.a=o}function Jr(e,t,n,r){var i,o=(new Rr).ia("sidx",(function(e){i=function(e,t,n,r){var i=[];r.reader.P(4);var o=r.reader.I();if(0==o)throw Y.error("Invalid timescale."),new he(2,3,3005);if(0==r.version)var a=r.reader.I(),s=r.reader.I();else a=r.reader.Kb(),s=r.reader.Kb();r.reader.P(2);var u=r.reader.$b();for(e=e+r.size+s,s=0;s<u;s++){var c=r.reader.I(),l=(2147483648&c)>>>31;c&=2147483647;var f=r.reader.I();if(r.reader.P(4),1==l)throw Y.error("Heirarchical SIDXs are not supported."),new he(2,3,3006);i.push(new $r(i.length,a/o-t,(a+f)/o-t,(function(){return n}),e,e+c-1)),a+=f,e+=c}return r.parser.stop(),i}(t,r,n,e)}));if(e&&o.parse(e),i)return i;throw Y.error('Invalid box type, expected "sidx".'),new he(2,3,3004)}function Qr(e){this.a=e}function Zr(e,t){for(;e.a.length&&e.a[e.a.length-1].startTime>=t;)e.a.pop();for(;e.a.length&&0>=e.a[0].endTime;)e.a.shift();if(0!=e.a.length){var n=e.a[e.a.length-1];e.a[e.a.length-1]=new $r(n.position,n.startTime,t,n.c,n.b,n.a)}}function ei(e){this.b=e,this.a=new Or(e,0),Vr||(Vr=[new Uint8Array([255]),new Uint8Array([127,255]),new Uint8Array([63,255,255]),new Uint8Array([31,255,255,255]),new Uint8Array([15,255,255,255,255]),new Uint8Array([7,255,255,255,255,255]),new Uint8Array([3,255,255,255,255,255,255]),new Uint8Array([1,255,255,255,255,255,255,255])])}function ti(e){var t=ni(e);if(7<t.length)throw new he(2,3,3002);for(var n=0,r=0;r<t.length;r++)n=256*n+t[r];t=n,n=ni(e);e:{r=ft.Da;for(var i=0;i<Vr.length;i++)if(r(n,Vr[i])){r=!0;break e}r=!1}if(r)n=e.b.byteLength-e.a.ga();else{if(8==n.length&&224&n[1])throw new he(2,3,3001);for(r=n[0]&(1<<8-n.length)-1,i=1;i<n.length;i++)r=256*r+n[i];n=r}return n=e.a.ga()+n<=e.b.byteLength?n:e.b.byteLength-e.a.ga(),r=new DataView(e.b.buffer,e.b.byteOffset+e.a.ga(),n),e.a.P(n),new ri(t,r)}function ni(e){var t,n=e.a.na();for(t=1;8>=t&&!(n&1<<8-t);t++);if(8<t)throw new he(2,3,3002);var r=new Uint8Array(t);for(r[0]=n,n=1;n<t;n++)r[n]=e.a.na();return r}function ri(e,t){this.id=e,this.a=t}function ii(e){if(8<e.a.byteLength)throw new he(2,3,3002);if(8==e.a.byteLength&&224&e.a.getUint8(0))throw new he(2,3,3001);for(var t=0,n=0;n<e.a.byteLength;n++){t=256*t+e.a.getUint8(n)}return t}function oi(){}function ai(e){var t=new ei(e.a);if(179!=(e=ti(t)).id)throw Y.m("Not a CueTime element."),new he(2,3,3013);if(e=ii(e),183!=(t=ti(t)).id)throw Y.m("Not a CueTrackPositions element."),new he(2,3,3012);t=new ei(t.a);for(var n=0;t.ya();){var r=ti(t);if(241==r.id){n=ii(r);break}}return{Ig:e,gg:n}}function si(e,t){var n=Wr(e,t,"Initialization");if(!n)return null;var r=e.A.ta,i=n.getAttribute("sourceURL");i&&(r=Vt(e.A.ta,[i])),i=0;var o=null;return(n=Ur.M(n,"range",Ur.Cc))&&(i=n.start,o=n.end),new Yr((function(){return r}),i,o)}function ui(e,t,n,r,i,o,a,s){var u=e.presentationTimeline,c=!e.tb||!e.W.hd,l=e.W.start,f=e.W.duration,d=t,p=null;return{createSegmentIndex:function(){var e=[d(r,i,o),"webm"==a?d(n.c(),n.b,n.a):null];return d=null,Promise.all(e).then((function(e){var t=e[0];e=e[1]||null,t="mp4"==a?Jr(t,i,r,s):(new oi).parse(t,e,r,s),u.Eb(t,l),p=new Qr(t),c&&Zr(p,f)}))},findSegmentPosition:function(e){return p.find(e)},getSegmentReference:function(e){return p.get(e)}}}function ci(e){return e.ac}function li(e,t){var n=si(e,fi),r=function(e){return[e.A.Pa,e.aa.Pa,e.ma.Pa].filter(Bt.Ma).map((function(e){return Ur.U(e,"SegmentURL")})).reduce((function(e,t){return 0<e.length?e:t})).map((function(t){return t.getAttribute("indexRange")&&!e.he&&(e.he=!0,Y.m("We do not support the SegmentURL@indexRange attribute on SegmentList.  We only use the SegmentList@duration attribute or SegmentTimeline, which must be accurate.")),{Jf:t.getAttribute("media"),start:(t=Ur.M(t,"mediaRange",Ur.Cc,{start:0,end:null})).start,end:t.end}}))}(e),i=qr(e,fi),o=i.ib;0==o&&(Y.m("SegmentList@startNumber must be > 0"),o=1);var a=0;if(i.da?a=i.da*(o-1):i.R&&0<i.R.length&&(a=i.R[0].start),!(r={da:i.da,startTime:a,ib:o,oa:i.oa,R:i.R,cb:r}).da&&!r.R&&1<r.cb.length)throw Y.m("SegmentList does not contain sufficient segment information:","the SegmentList specifies multiple segments,","but does not specify a segment duration or timeline.",e.A),new he(2,4,4002);if(!r.da&&!e.W.duration&&!r.R&&1==r.cb.length)throw Y.m("SegmentList does not contain sufficient segment information:","the SegmentList specifies one segment,","but does not specify a segment duration, period duration,","or timeline.",e.A),new he(2,4,4002);if(r.R&&0==r.R.length)throw Y.m("SegmentList does not contain sufficient segment information:","the SegmentList has an empty timeline.",e.A),new he(2,4,4002);return o=i=null,e.ma.id&&e.A.id&&(i=t[o=e.ma.id+","+e.A.id]),a=function(e,t,n,r){var i=r.cb.length;r.R&&r.R.length!=r.cb.length&&(i=Math.min(r.R.length,r.cb.length),Y.m("The number of items in the segment timeline and the number of segment","URLs do not match, truncating",r.cb.length,"to",i));for(var o=[],a=r.startTime,s=0;s<i;s++){var u,c=r.cb[s],l=Vt(n,[c.Jf]);u=null!=r.da?a+r.da:r.R?r.R[s].end:a+e,o.push(new $r(s+t,a,u,function(e){return e}.bind(null,l),c.start,c.end)),a=u}return o}(e.W.duration,r.ib,e.A.ta,r),i?(i.md(a),o=e.presentationTimeline.Wb(),i.Tc(o-e.W.start)):(e.presentationTimeline.Eb(a,e.W.start),i=new Qr(a),o&&e.tb&&(t[o]=i)),e.tb&&e.W.hd||Zr(i,e.W.duration),{createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:i.find.bind(i),getSegmentReference:i.get.bind(i),initSegmentReference:n,oa:r.oa}}function fi(e){return e.Pa}function di(e,t,n,r){var i=function(e){var t=Gr(e,pi,"initialization");if(!t)return null;var n=e.A.id,r=e.bandwidth||null,i=e.A.ta;return new Yr((function(){var e=zr(t,n,null,r,null);return Vt(i,[e])}),0,null)}(e),o=qr(e,pi),a=Gr(e,pi,"media"),s=Gr(e,pi,"index");if(a=(o={da:o.da,timescale:o.timescale,ib:o.ib,oa:o.oa,Pd:o.Pd,R:o.R,kd:a,Yb:s}).Yb?1:0,a+=o.R?1:0,0==(a+=o.da?1:0))throw Y.error("SegmentTemplate does not contain any segment information:","the SegmentTemplate must contain either an index URL template","a SegmentTimeline, or a segment duration.",e.A),new he(2,4,4002);if(1!=a&&(Y.m("SegmentTemplate containes multiple segment information sources:","the SegmentTemplate should only contain an index URL template,","a SegmentTimeline or a segment duration.",e.A),o.Yb?(Y.info("Using the index URL template by default."),o.R=null):Y.info("Using the SegmentTimeline by default."),o.da=null),!o.Yb&&!o.kd)throw Y.error("SegmentTemplate does not contain sufficient segment information:","the SegmentTemplate's media URL template is missing.",e.A),new he(2,4,4002);if(o.Yb){if("mp4"!=(n=e.A.mimeType.split("/")[1])&&"webm"!=n)throw Y.error("SegmentTemplate specifies an unsupported container type.",e.A),new he(2,4,4006);if("webm"==n&&!i)throw Y.error("SegmentTemplate does not contain sufficient segment information:","the SegmentTemplate uses a WebM container,","but does not contain an initialization URL template.",e.A),new he(2,4,4005);r=zr(o.Yb,e.A.id,null,e.bandwidth||null,null),e=ui(e,t,i,r=Vt(e.A.ta,[r]),0,null,n,o.oa)}else o.da?(r||(e.presentationTimeline.od(o.da),e.presentationTimeline.pd(e.W.start)),e=function(e,t){var n=e.W.duration,r=t.da,i=t.ib,o=t.timescale,a=t.kd,s=e.bandwidth||null,u=e.A.id,c=e.A.ta;return{createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(e){return 0>e||n&&e>=n?null:Math.floor(e/r)},getSegmentReference:function(e){var t=e*r,l=t+r;return n&&(l=Math.min(l,n)),0>l||n&&t>=n?null:new $r(e,t,l,(function(){var n=zr(a,u,e+i,s,t*o);return Vt(c,[n])}),0,null)}}}(e,o)):(a=t=null,e.ma.id&&e.A.id&&(t=n[a=e.ma.id+","+e.A.id]),s=function(e,t){for(var n=[],r=0;r<t.R.length;r++){var i=r+t.ib;n.push(new $r(i,t.R[r].start,t.R[r].end,function(e,t,n,r,i,o){return Vt(r,[e=zr(e,t,i,n,o)]).map((function(e){return e.toString()}))}.bind(null,t.kd,e.A.id,e.bandwidth||null,e.A.ta,i,t.R[r].Hg+t.Pd),0,null))}return n}(e,o),r=!e.tb||!e.W.hd,t?(r&&Zr(new Qr(s),e.W.duration),t.md(s),n=e.presentationTimeline.Wb(),t.Tc(n-e.W.start)):(e.presentationTimeline.Eb(s,e.W.start),t=new Qr(s),a&&e.tb&&(n[a]=t)),r&&Zr(t,e.W.duration),e={createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:t.find.bind(t),getSegmentReference:t.get.bind(t)});return{createSegmentIndex:e.createSegmentIndex,findSegmentPosition:e.findSegmentPosition,getSegmentReference:e.getSegmentReference,initSegmentReference:i,oa:o.oa}}function pi(e){return e.cc}H("shaka.media.InitSegmentReference",Yr),Yr.prototype.Qc=function(){return this.c()},Yr.prototype.createUris=Yr.prototype.Qc,Yr.prototype.bd=function(){return this.b},Yr.prototype.getStartByte=Yr.prototype.bd,Yr.prototype.ad=function(){return this.a},Yr.prototype.getEndByte=Yr.prototype.ad,H("shaka.media.SegmentReference",$r),$r.prototype.ga=function(){return this.position},$r.prototype.getPosition=$r.prototype.ga,$r.prototype.sc=function(){return this.startTime},$r.prototype.getStartTime=$r.prototype.sc,$r.prototype.ff=function(){return this.endTime},$r.prototype.getEndTime=$r.prototype.ff,$r.prototype.Qc=function(){return this.c()},$r.prototype.createUris=$r.prototype.Qc,$r.prototype.bd=function(){return this.b},$r.prototype.getStartByte=$r.prototype.bd,$r.prototype.ad=function(){return this.a},$r.prototype.getEndByte=$r.prototype.ad,H("shaka.media.SegmentIndex",Qr),Qr.prototype.destroy=function(){return this.a=null,Promise.resolve()},Qr.prototype.destroy=Qr.prototype.destroy,Qr.prototype.find=function(e){for(var t=this.a.length-1;0<=t;--t){var n=this.a[t];if(e>=n.startTime&&e<n.endTime)return n.position}return this.a.length&&e<this.a[0].startTime?this.a[0].position:null},Qr.prototype.find=Qr.prototype.find,Qr.prototype.get=function(e){return 0==this.a.length||0>(e-=this.a[0].position)||e>=this.a.length?null:this.a[e]},Qr.prototype.get=Qr.prototype.get,Qr.prototype.offset=function(e){for(var t=0;t<this.a.length;++t)this.a[t].startTime+=e,this.a[t].endTime+=e},Qr.prototype.offset=Qr.prototype.offset,Qr.prototype.md=function(e){for(var t=[],n=0,r=0;n<this.a.length&&r<e.length;){var i=this.a[n],o=e[r];i.startTime<o.startTime?(t.push(i),n++):(i.startTime>o.startTime?0==n?t.push(o):Y.m("Refusing to rewrite original references on update!"):(.1<Math.abs(i.endTime-o.endTime)?t.push(new $r(i.position,o.startTime,o.endTime,o.c,o.b,o.a)):t.push(i),n++),r++)}for(;n<this.a.length;)t.push(this.a[n++]);if(t.length)for(n=t[t.length-1].position+1;r<e.length;)i=new $r(n++,(i=e[r++]).startTime,i.endTime,i.c,i.b,i.a),t.push(i);else t=e;this.a=t},Qr.prototype.merge=Qr.prototype.md,Qr.prototype.Tc=function(e){for(var t=0;t<this.a.length;++t)if(this.a[t].endTime>e)return void this.a.splice(0,t);this.a=[]},Qr.prototype.evict=Qr.prototype.Tc,ei.prototype.ya=function(){return this.a.ya()},oi.prototype.parse=function(e,t,n,r){var i;if(440786851!=ti(t=new ei(new DataView(t))).id)throw Y.error("Not an EBML element."),new he(2,3,3008);var o=ti(t);if(408125543!=o.id)throw Y.error("Not a Segment element."),new he(2,3,3009);for(t=o.a.byteOffset,o=new ei(o.a),i=null;o.ya();){var a=ti(o);if(357149030==a.id){i=a;break}}if(!i)throw Y.error("Not an Info element."),new he(2,3,3010);for(o=new ei(i.a),i=1e6,a=null;o.ya();){var s=ti(o);if(2807729==s.id)i=ii(s);else if(17545==s.id)if(4==(a=s).a.byteLength)a=a.a.getFloat32(0);else{if(8!=a.a.byteLength)throw new he(2,3,3003);a=a.a.getFloat64(0)}}if(null==a)throw new he(2,3,3011);if(i=a*(o=i/1e9),475249515!=(e=ti(new ei(new DataView(e)))).id)throw Y.error("Not a Cues element."),new he(2,3,3007);return function(e,t,n,r,i,o){function a(){return i}var s=[];e=new ei(e.a);for(var u=null,c=null;e.ya();){var l=ti(e);if(187==l.id){var f=ai(l);f&&(l=n*f.Ig,f=t+f.gg,null!=u&&s.push(new $r(s.length,u-o,l-o,a,c,f-1)),u=l,c=f)}}return null!=u&&s.push(new $r(s.length,u-o,r-o,a,c,null)),s}(e,t,o,i,n,r)};var hi={Ib:{},Zb:{},zd:function(e,t){hi.Zb[e]=t}};function yi(e,t,n){this.f=e,this.Dc=t,this.h=this.g=1/0,this.a=1,this.b=this.c=null,this.l=0,this.o=!0,this.i=0,this.u=void 0===n||n}function mi(e,t,n,r){return e=je(e,r),0==t&&null==n||(e.headers.Range=n?"bytes="+t+"-"+n:"bytes="+t+"-"),e}function vi(){var e=this;this.b=this.a=null,this.f=[],this.c=null,this.l=[],this.h=1,this.o={},this.u=0,this.v=new q(5),this.i=new fe((function(){!function(e){y((function t(){var n,r;return L(t,(function(t){switch(t.j){case 1:return Y.info("Updating manifest..."),n=0,A(t,2),k(t,gi(e),4);case 4:n=t.s,M(t,3);break;case 2:r=I(t),e.b&&(r.severity=1,e.b.onError(r));case 3:if(!e.b)return t.return();Ti(e,n),x(t)}}))}))}(e)})),this.g=new Me}function gi(e){var t=Date.now(),n=e.b.networkingEngine.request(0,je(e.f,e.a.retryParameters));return Ie(e.g,n),n.promise.then((function(t){if(e.b)return t.uri&&!e.f.includes(t.uri)&&e.f.unshift(t.uri),function(e,t,n){if(!(t=Ur.te(t,"MPD")))throw new he(2,4,4001,n);return t=Xr(t,e.a.retryParameters,e.a.dash.xlinkFailGracefully,n,e.b.networkingEngine),Ie(e.g,t),t.promise.then((function(t){return function(e,t,n){return y((function r(){var i,o,a,s,u,c,l,f,d,p,h,y,m,v,g,b,w,S,T,E,P,A,O,M;return L(r,(function(r){switch(r.j){case 1:s=Bt,c=[n],0<(l=(u=Ur).U(t,"Location").map(u.qc).filter(s.Ma)).length&&(f=Vt(c,l),c=e.f=f),d=u.U(t,"BaseURL").map(u.qc),p=Vt(c,d),h=e.a.dash.ignoreMinBufferTime,y=0,h||(y=u.M(t,"minBufferTime",u.Ia)),e.u=u.M(t,"minimumUpdatePeriod",u.Ia,-1),m=u.M(t,"availabilityStartTime",u.$f),v=u.M(t,"timeShiftBufferDepth",u.Ia),g=u.M(t,"maxSegmentDuration",u.Ia),b=t.getAttribute("type")||"static",w=e.a.dash.ignoreSuggestedPresentationDelay,S=null,w||(S=u.M(t,"suggestedPresentationDelay",u.Ia)),e.c?T=e.c.presentationTimeline:(E=Math.max(e.a.dash.defaultPresentationDelay,1.5*y),T=new yi(m,null!=S?S:E,e.a.dash.autoCorrectDrift));for(var I={tb:"static"!=b,presentationTimeline:T,ma:null,W:null,aa:null,A:null,bandwidth:0,he:!1},R=p,C=Ur.M(t,"mediaPresentationDuration",Ur.Ia),D=[],j=0,N=Ur.U(t,"Period"),_=0;_<N.length;_++){var L=N[_];j=Ur.M(L,"start",Ur.Ia,j);var U=Ur.M(L,"duration",Ur.Ia),K=null;if(_!=N.length-1){var B=Ur.M(N[_+1],"start",Ur.Ia);null!=B&&(K=B-j)}else null!=C&&(K=C-j);if(B=1/15,K&&U&&Math.abs(K-U)>B&&Y.m("There is a gap/overlap between Periods",L),null==K&&(K=U),L=bi(e,I,R,{start:j,duration:K,node:L,hd:null==K||_==N.length-1}),D.push(L),U=I.ma.id,e.l.includes(U)||(e.l.push(U),e.c&&(e.b.filterNewPeriod(L),e.c.periods.push(L))),null==K){_!=N.length-1&&Y.m("Skipping Period",_+1,"and any subsequent Periods:","Period",_+1,"does not have a valid start time.",D[_+1]),j=null;break}j+=K}if(null==e.c&&e.b.filterAllPeriods(D),null!=C?(j!=C&&Y.m("@mediaPresentationDuration does not match the total duration of all","Periods."),i=D,o=C,a=!1):(i=D,o=j,a=!0),P=o,A=i,T.dc("static"==b),"static"!=b&&a||T.Ba(P||1/0),T.X()&&!isNaN(e.a.availabilityWindowOverride)&&(v=e.a.availabilityWindowOverride),null==v&&(v=1/0),T.Jd(v),T.od(g||1),e.c){r.C(0);break}if(e.c={presentationTimeline:T,periods:A,offlineSessionIds:[],minBufferTime:y||0},!T.He()){r.C(0);break}return O=u.U(t,"UTCTiming"),k(r,function(e,t,n){n=n.map((function(e){return{scheme:e.getAttribute("schemeIdUri"),value:e.getAttribute("value")}}));var r=e.a.dash.clockSyncUri;return!n.length&&r&&n.push({scheme:"urn:mpeg:dash:utc:http-head:2014",value:r}),Bt.Xe(n,function(e){var n=e.scheme;switch(e=e.value,n){case"urn:mpeg:dash:utc:http-head:2014":case"urn:mpeg:dash:utc:http-head:2012":return Pi(this,t,e,"HEAD");case"urn:mpeg:dash:utc:http-xsdate:2014":case"urn:mpeg:dash:utc:http-iso:2014":case"urn:mpeg:dash:utc:http-xsdate:2012":case"urn:mpeg:dash:utc:http-iso:2012":return Pi(this,t,e,"GET");case"urn:mpeg:dash:utc:direct:2014":case"urn:mpeg:dash:utc:direct:2012":return n=Date.parse(e),isNaN(n)?0:n-Date.now();case"urn:mpeg:dash:utc:http-ntp:2014":case"urn:mpeg:dash:utc:ntp:2014":case"urn:mpeg:dash:utc:sntp:2014":return Y.Z("NTP UTCTiming scheme is not supported"),Promise.reject();default:return Y.Z("Unrecognized scheme in UTCTiming element",n),Promise.reject()}}.bind(e)).catch((function(){return Y.Z("A UTCTiming element should always be given in live manifests! This content may not play on clients with bad clocks!"),0}))}(e,p,O),4);case 4:if(M=r.s,!e.b)return r.return();T.Ce(M),x(r)}}))}))}(e,t,n)}))}(e,t.data,t.uri)})).then((function(){var n=(Date.now()-t)/1e3;return G(e.v,1,n),n}))}function bi(e,t,n,r){if(t.ma=Ei(r.node,null,n),t.W=r,t.ma.id||(Y.info("No Period ID given for Period with start time "+r.start+",  Assigning a default"),t.ma.id="__shaka_period_"+r.start),Ur.U(r.node,"EventStream").forEach(e.ag.bind(e,r.start,r.duration)),n=Ur.U(r.node,"AdaptationSet").map(e.Zf.bind(e,t)).filter(Bt.Ma),t.tb){t=[];for(var i=p(n),o=i.next();!o.done;o=i.next())for(var a=(o=p(o.value.jg)).next();!a.done;a=o.next())t.push(a.value);if(t.length!=new Set(t).size)throw new he(2,4,4018)}var s=n.filter((function(e){return!e.Nd}));if(n.filter((function(e){return e.Nd})).forEach((function(e){var t=e.streams[0],n=e.Nd;s.forEach((function(e){e.id==n&&e.streams.forEach((function(e){e.trickModeVideo=t}))}))})),t=wi(s,"video"),i=wi(s,"audio"),!t.length&&!i.length)throw new he(2,4,4004);for(n=e.a.disableAudio,i.length&&!n||(i=[null]),n=e.a.disableVideo,t.length&&!n||(t=[null]),n=[],o=0;o<i.length;o++)for(a=0;a<t.length;a++)Si(e,i[o],t[a],n);if(t=[],!e.a.disableText)for(e=wi(s,"text"),i=0;i<e.length;i++)t.push.apply(t,e[i].streams);return{startTime:r.start,textStreams:t,variants:n}}function wi(e,t){return e.filter((function(e){return e.contentType==t}))}function Si(e,t,n,r){if(t||n)if(t&&n){var i=t.drmInfos,o=n.drmInfos;if(!i.length||!o.length||0<Ot(i,o).length){o=Ot(t.drmInfos,n.drmInfos);for(var a=0;a<t.streams.length;a++)for(var s=0;s<n.streams.length;s++)i=(n.streams[s].bandwidth||0)+(t.streams[a].bandwidth||0),i={id:e.h++,language:t.language,primary:t.jd||n.jd,audio:t.streams[a],video:n.streams[s],bandwidth:i,drmInfos:o,allowedByApplication:!0,allowedByKeySystem:!0},r.push(i)}}else for(o=t||n,a=0;a<o.streams.length;a++)i=o.streams[a].bandwidth||0,i={id:e.h++,language:o.language||"und",primary:o.jd,audio:t?o.streams[a]:null,video:n?o.streams[a]:null,bandwidth:i,drmInfos:o.drmInfos,allowedByApplication:!0,allowedByKeySystem:!0},r.push(i)}function Ti(e,t){0>e.u||e.i.T(Math.max(3,e.u-t,W(e.v)))}function Ei(e,t,n){t=t||{contentType:"",mimeType:"",codecs:"",emsgSchemeIdUris:[],frameRate:void 0,qd:null,audioSamplingRate:null},n=n||t.ta;var r=Ur.Hb,i=Ur.Ze,o=Ur.U(e,"BaseURL").map(Ur.qc),a=e.getAttribute("contentType")||t.contentType,s=e.getAttribute("mimeType")||t.mimeType,u=e.getAttribute("codecs")||t.codecs;i=Ur.M(e,"frameRate",i)||t.frameRate;for(var c=e.getAttribute("sar")||t.pixelAspectRatio,l=Ur.U(e,"InbandEventStream"),f=t.emsgSchemeIdUris.slice(),d=(l=p(l)).next();!d.done;d=l.next())d=d.value.getAttribute("schemeIdUri"),f.includes(d)||f.push(d);return l=function(e){for(var t=0;t<e.length;++t){var n=e[t],r=n.getAttribute("schemeIdUri");if(r&&(n=n.getAttribute("value")))switch(r){case"urn:mpeg:dash:outputChannelPositionList:2012":return n.trim().split(/ +/).length;case"urn:mpeg:dash:23003:3:audio_channel_configuration:2011":case"urn:dts:dash:audio_channel_configuration:2012":var i=parseInt(n,10);if(!i){Y.m("Channel parsing failure! Ignoring scheme and value",r,n);continue}return i;case"tag:dolby.com,2014:dash:audio_channel_configuration:2011":case"urn:dolby:dash:audio_channel_configuration:2011":if(!(i=parseInt(n,16))){Y.m("Channel parsing failure! Ignoring scheme and value",r,n);continue}for(e=0;i;)1&i&&++e,i>>=1;return e;default:Y.m("Unrecognized audio channel scheme:",r,n)}}return null}(l=Ur.U(e,"AudioChannelConfiguration"))||t.qd,d=Ur.M(e,"audioSamplingRate",r)||t.audioSamplingRate,a||(a=ki(s,u)),{ta:Vt(n,o),ac:Ur.oc(e,"SegmentBase")||t.ac,Pa:Ur.oc(e,"SegmentList")||t.Pa,cc:Ur.oc(e,"SegmentTemplate")||t.cc,width:Ur.M(e,"width",r)||t.width,height:Ur.M(e,"height",r)||t.height,contentType:a,mimeType:s,codecs:u,frameRate:i,pixelAspectRatio:c,emsgSchemeIdUris:f,id:e.getAttribute("id"),qd:l,audioSamplingRate:d}}function Pi(e,t,n,r){return(t=je(t=Vt(t,[n]),e.a.retryParameters)).method=r,t=e.b.networkingEngine.request(4,t),Ie(e.g,t),t.promise.then((function(e){if("HEAD"==r){if(!e.headers||!e.headers.date)return Y.m("UTC timing response is missing","expected date header"),0;e=e.headers.date}else e=it(e.data);return e=Date.parse(e),isNaN(e)?(Y.m("Unable to parse date from UTC timing response"),0):e-Date.now()}))}function ki(e,t){return pn(We(e,t))?"text":e.split("/")[0]}function xi(e,t,n,r){this.b=e,this.type=t,this.a=n,this.segments=r||null}function Ai(e,t,n,r){this.id=e,this.name=t,this.a=n,this.value=void 0===r?null:r}function Oi(e,t){this.name=e,this.value=t}function Mi(e,t,n){return(e=e.getAttribute(t))?e.value:n||null}function Ii(e,t){this.b=t,this.a=e}H("shaka.media.ManifestParser.registerParserByExtension",hi.zd),hi.Lb=function(e,t){hi.Ib[e]=t},H("shaka.media.ManifestParser.registerParserByMime",hi.Lb),hi.dg=function(){var e={};if($e()){for(var t in hi.Ib)e[t]=!0;for(var n in hi.Zb)e[n]=!0}t={mpd:"application/dash+xml",m3u8:"application/x-mpegurl",ism:"application/vnd.ms-sstr+xml"};for(var r=(n=p(["application/dash+xml","application/x-mpegurl","application/vnd.apple.mpegurl","application/vnd.ms-sstr+xml"])).next();!r.done;r=n.next())e[r=r.value]=$e()?!!hi.Ib[r]:Je(r);for(var i in t)e[i]=$e()?!!hi.Zb[i]:Je(t[i]);return e},hi.create=function(e,t,n,r){return y((function i(){var o,a;return L(i,(function(i){switch(i.j){case 1:return A(i,2),k(i,hi.gf(e,t,n,r),4);case 4:return o=i.s,i.return(new o);case 2:throw(a=I(i)).severity=2,a}}))}))},hi.gf=function(e,t,n,r){return y((function i(){var o,a,s,u,c;return L(i,(function(i){switch(i.j){case 1:if(o=hi,r){if(a=o.Ib[r.toLowerCase()])return i.return(a);Y.m("Could not determine manifest type using MIME type ",r)}if(s=o.getExtension(e)){if(u=o.Zb[s])return i.return(u);Y.m("Could not determine manifest type for extension ",s)}else Y.m("Could not find extension for ",e);if(r){i.C(2);break}return k(i,o.qf(e,t,n),3);case 3:if(r=i.s){if(c=hi.Ib[r])return i.return(c);Y.m("Could not determine manifest type using MIME type",r)}case 2:throw new he(2,4,4e3,e)}}))}))},hi.qf=function(e,t,n){return y((function r(){var i,o,a;return L(r,(function(r){switch(r.j){case 1:return(i=je([e],n)).method="HEAD",k(r,t.request(0,i).promise,2);case 2:return o=r.s,a=o.headers["content-type"],r.return(a?a.toLowerCase().split(";").shift():"")}}))}))},hi.getExtension=function(e){return 1==(e=new J(e).la.split("/").pop().split(".")).length?"":e.pop().toLowerCase()},hi.isSupported=function(e,t){return!!$e()&&(t in hi.Ib||hi.getExtension(e)in hi.Zb)},H("shaka.media.PresentationTimeline",yi),yi.prototype.ca=function(){return this.g},yi.prototype.getDuration=yi.prototype.ca,yi.prototype.nf=function(){return this.a},yi.prototype.getMaxSegmentDuration=yi.prototype.nf,yi.prototype.Ba=function(e){this.g=e},yi.prototype.setDuration=yi.prototype.Ba,yi.prototype.wf=function(){return this.f},yi.prototype.getPresentationStartTime=yi.prototype.wf,yi.prototype.Ce=function(e){this.l=e},yi.prototype.setClockOffset=yi.prototype.Ce,yi.prototype.dc=function(e){this.o=e},yi.prototype.setStatic=yi.prototype.dc,yi.prototype.Jd=function(e){this.h=e},yi.prototype.setSegmentAvailabilityDuration=yi.prototype.Jd,yi.prototype.sg=function(e){this.Dc=e},yi.prototype.setDelay=yi.prototype.sg,yi.prototype.ef=function(){return this.Dc},yi.prototype.getDelay=yi.prototype.ef,yi.prototype.Eb=function(e,t){if(0!=e.length){var n=e[e.length-1].endTime+t;this.pd(e[0].startTime+t),this.a=e.reduce((function(e,t){return Math.max(e,t.endTime-t.startTime)}),this.a),this.b=Math.max(this.b,n),null!=this.f&&this.u&&(this.f=(Date.now()+this.l)/1e3-this.b-this.a),Y.D("notifySegments:","maxSegmentDuration="+this.a)}},yi.prototype.notifySegments=yi.prototype.Eb,yi.prototype.pd=function(e){this.c=null==this.c?e:Math.min(this.c,e)},yi.prototype.notifyMinSegmentStartTime=yi.prototype.pd,yi.prototype.od=function(e){this.a=Math.max(this.a,e),Y.D("notifyNewSegmentDuration:","maxSegmentDuration="+this.a)},yi.prototype.notifyMaxSegmentDuration=yi.prototype.od,yi.prototype.offset=function(e){null!=this.c&&(this.c+=e),null!=this.b&&(this.b+=e)},yi.prototype.offset=yi.prototype.offset,yi.prototype.X=function(){return 1/0==this.g&&!this.o},yi.prototype.isLive=yi.prototype.X,yi.prototype.bb=function(){return 1/0!=this.g&&!this.o},yi.prototype.isInProgress=yi.prototype.bb,yi.prototype.Wb=function(){if(1/0==this.h)return this.i;var e=this.xb()-this.h;return Math.max(this.i,e)},yi.prototype.getSegmentAvailabilityStart=yi.prototype.Wb,yi.prototype.De=function(e){this.i=e},yi.prototype.setUserSeekStart=yi.prototype.De,yi.prototype.xb=function(){return this.X()||this.bb()?Math.min(Math.max(0,(Date.now()+this.l)/1e3-this.a-this.f),this.g):this.g},yi.prototype.getSegmentAvailabilityEnd=yi.prototype.xb,yi.prototype.Vb=function(e){var t=Math.max(this.c,this.i);if(1/0==this.h)return t;var n=this.xb()-this.h;return e=Math.min(n+e,this.Ga()),Math.max(t,e)},yi.prototype.getSafeSeekRangeStart=yi.prototype.Vb,yi.prototype.wb=function(){return this.Vb(0)},yi.prototype.getSeekRangeStart=yi.prototype.wb,yi.prototype.Ga=function(){var e=this.X()||this.bb()?this.Dc:0;return Math.max(0,this.xb()-e)},yi.prototype.getSeekRangeEnd=yi.prototype.Ga,yi.prototype.He=function(){return!(null==this.f||null!=this.b&&this.u)},yi.prototype.usingPresentationStartTime=yi.prototype.He,H("shaka.dash.DashParser",vi),(i=vi.prototype).configure=function(e){this.a=e},i.start=function(e,t){var n=this;return y((function r(){var i;return L(r,(function(r){switch(r.j){case 1:return n.f=[e],n.b=t,k(r,gi(n),2);case 2:if(i=r.s,n.b&&Ti(n,i),!n.b)throw new he(2,7,7001);return r.return(n.c)}}))}))},i.stop=function(){return this.a=this.b=null,this.f=[],this.c=null,this.l=[],this.o={},null!=this.i&&(this.i.stop(),this.i=null),this.g.destroy()},i.update=function(){gi(this).catch(function(e){this.b&&this.b.onError(e)}.bind(this))},i.onExpirationUpdated=function(){},i.Zf=function(e,t){if(e.aa=Ei(t,e.ma,null),"image"==e.aa.contentType)return Y.m("Skipping Image AdaptationSet",e.aa),null;var n=!1,r=Ur.U(t,"Role"),i=r.map((function(e){return e.getAttribute("value")})).filter(Bt.Ma),o=void 0,a="text"==e.aa.contentType;a&&(o="subtitle");for(var s=0;s<r.length;s++){var u=r[s].getAttribute("schemeIdUri");if(null==u||"urn:mpeg:dash:role:2011"==u)switch(u=r[s].getAttribute("value"),u){case"main":n=!0;break;case"caption":case"subtitle":o=u}}var c=null,l=!1;Ur.U(t,"EssentialProperty").forEach((function(e){"http://dashif.org/guidelines/trickmode"==e.getAttribute("schemeIdUri")?c=e.getAttribute("value"):l=!0})),s=Ur.U(t,"Accessibility");var f=new Map;for(r={},u=(s=p(s)).next();!u.done;r={Rb:r.Rb},u=s.next()){var d=u.value;u=d.getAttribute("schemeIdUri"),d=d.getAttribute("value"),"urn:scte:dash:cc:cea-608:2015"==u||"urn:scte:dash:cc:cea-708:2015"==u?(r.Rb=1,null!=d?d.split(";").forEach(function(e){return function(t){if(t.includes("=")){var n=(t=t.split("="))[0].startsWith("CC")?t[0]:"CC"+t[0];t=t[1].split(",")[0].split(":").pop()}else n="CC"+e.Rb,e.Rb+=2;f.set(n,Cn(t))}}(r)):f.set("CC1","und")):"urn:mpeg:dash:role:2011"==u&&null!=d&&(i.push(d),"captions"==d&&(o="caption"))}if(l)return null;var h=Br(r=Ur.U(t,"ContentProtection"),this.a.dash.customScheme,this.a.dash.ignoreDrmInfo);if(r=Cn(t.getAttribute("lang")||"und"),s=t.getAttribute("label"),(u=Ur.U(t,"Label"))&&u.length&&((u=u[0]).textContent&&(s=u.textContent)),0==(i=(u=Ur.U(t,"Representation")).map(this.bg.bind(this,e,h,o,r,s,n,i,f)).filter((function(e){return!!e}))).length){if(this.a.dash.ignoreEmptyAdaptationSet||a)return null;throw new he(2,4,4003)}return e.aa.contentType&&"application"!=e.aa.contentType||(e.aa.contentType=ki(i[0].mimeType,i[0].codecs),i.forEach((function(t){t.type=e.aa.contentType}))),i.forEach((function(e){h.drmInfos.forEach((function(t){e.keyId&&t.keyIds.push(e.keyId)}))})),a=u.map((function(e){return e.getAttribute("id")})).filter(Bt.Ma),{id:e.aa.id||"__fake__"+this.h++,contentType:e.aa.contentType,language:r,jd:n,streams:i,drmInfos:h.drmInfos,Nd:c,jg:a}},i.bg=function(e,t,n,r,i,o,a,s,u){if(e.A=Ei(u,e.aa,null),!function(e){var t=e.ac?1:0;if(t+=e.Pa?1:0,0==(t+=e.cc?1:0))return"text"==e.contentType||"application"==e.contentType||(Y.m("Representation does not contain a segment information source:","the Representation must contain one of SegmentBase, SegmentList,",'SegmentTemplate, or explicitly indicate that it is "text".',e),!1);return 1!=t&&(Y.m("Representation contains multiple segment information sources:","the Representation should only contain one of SegmentBase,","SegmentList, or SegmentTemplate.",e),e.ac?(Y.info("Using SegmentBase by default."),e.Pa=null):Y.info("Using SegmentList by default."),e.cc=null),!0}(e.A))return Y.m("Skipping Representation",e.A),null;e.bandwidth=Ur.M(u,"bandwidth",Ur.Bc)||0;var c=e.A.contentType;c="text"==c||"application"==c;try{var l=this.kg.bind(this);if(e.A.ac)var f=function(e,t){var n=Number(Gr(e,ci,"presentationTimeOffset"))||0,r=Gr(e,ci,"timescale"),i=1;r&&(i=Ur.Bc(r)||1),n=n/i||0,r=si(e,ci);var o=e.A.contentType;if(i=e.A.mimeType.split("/")[1],"text"!=o&&"mp4"!=i&&"webm"!=i)throw Y.error("SegmentBase specifies an unsupported container type.",e.A),new he(2,4,4006);if("webm"==i&&!r)throw Y.error("SegmentBase does not contain sufficient segment information:","the SegmentBase uses a WebM container,","but does not contain an Initialization element.",e.A),new he(2,4,4005);o=Wr(e,ci,"RepresentationIndex");var a=Gr(e,ci,"indexRange"),s=e.A.ta;if(a=Ur.Cc(a||""),o){var u=o.getAttribute("sourceURL");u&&(s=Vt(e.A.ta,[u])),a=Ur.M(o,"range",Ur.Cc,a)}if(!a)throw Y.error("SegmentBase does not contain sufficient segment information:","the SegmentBase does not contain @indexRange","or a RepresentationIndex element.",e.A),new he(2,4,4002);return{createSegmentIndex:(i=ui(e,t,r,s,a.start,a.end,i,n)).createSegmentIndex,findSegmentPosition:i.findSegmentPosition,getSegmentReference:i.getSegmentReference,initSegmentReference:r,oa:n}}(e,l);else if(e.A.Pa)f=li(e,this.o);else if(e.A.cc)f=di(e,l,this.o,!!this.c);else{var d=e.A.ta,p=e.W.duration||0;f={createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(e){return 0<=e&&e<p?1:null},getSegmentReference:function(e){return 1!=e?null:new $r(1,0,p,(function(){return d}),0,null)},initSegmentReference:null,oa:0}}}catch(e){if(c&&4002==e.code)return null;throw e}return u=function(e,t,n,r){var i=Br(e,t,r);if(n.be)e=1==n.drmInfos.length&&!n.drmInfos[0].keySystem,t=0==i.drmInfos.length,(0==n.drmInfos.length||e&&!t)&&(n.drmInfos=i.drmInfos),n.be=!1;else if(0<i.drmInfos.length&&(n.drmInfos=n.drmInfos.filter((function(e){return i.drmInfos.some((function(t){return t.keySystem==e.keySystem}))})),0==n.drmInfos.length))throw new he(2,4,4008);return i.Xd||n.Xd}(u=Ur.U(u,"ContentProtection"),this.a.dash.customScheme,t,this.a.dash.ignoreDrmInfo),{id:this.h++,originalId:e.A.id,createSegmentIndex:f.createSegmentIndex,findSegmentPosition:f.findSegmentPosition,getSegmentReference:f.getSegmentReference,initSegmentReference:f.initSegmentReference,presentationTimeOffset:f.oa,mimeType:e.A.mimeType,codecs:e.A.codecs,frameRate:e.A.frameRate,pixelAspectRatio:e.A.pixelAspectRatio,bandwidth:e.bandwidth,width:e.A.width,height:e.A.height,kind:n,encrypted:0<t.drmInfos.length,keyId:u,language:r,label:i,type:e.aa.contentType,primary:o,trickModeVideo:null,emsgSchemeIdUris:e.A.emsgSchemeIdUris,roles:a,channelsCount:e.A.qd,audioSamplingRate:e.A.audioSamplingRate,closedCaptions:s}},i.ag=function(e,t,n){var r=Ur.Hb,i=n.getAttribute("schemeIdUri")||"",o=n.getAttribute("value")||"",a=Ur.M(n,"timescale",r)||1;Ur.U(n,"Event").forEach(function(n){var s=Ur.M(n,"presentationTime",r)||0,u=Ur.M(n,"duration",r)||0;u=(s=s/a+e)+u/a,null!=t&&(s=Math.min(s,e+t),u=Math.min(u,e+t)),n={schemeIdUri:i,value:o,startTime:s,endTime:u,id:n.getAttribute("id")||"",eventElement:n},this.b.onTimelineRegionAdded(n)}.bind(this))},i.kg=function(e,t,n){return e=mi(e,t,n,this.a.retryParameters),e=this.b.networkingEngine.request(1,e),Ie(this.g,e),e.promise.then((function(e){return e.data}))},hi.zd("mpd",vi),hi.Lb("application/dash+xml",vi),hi.Lb("video/vnd.mpeg.dash.mpd",vi),Ai.prototype.toString=function(){var e="#"+this.name,t=this.a?this.a.map((function(e){return e.name+"="+(isNaN(Number(e.value))?'"'+e.value+'"':e.value)})):[];return this.value&&t.unshift(this.value),0<t.length&&(e+=":"+t.join(",")),e},Ai.prototype.getAttribute=function(e){var t=this.a.filter((function(t){return t.name==e}));return t.length?t[0]:null};var Ri={ub:function(e,t){return e.filter((function(e){return e.name==t}))},Ya:function(e,t){var n=Ri.ub(e,t);return n.length?n[0]:null},Xc:function(e,t,n){return e.filter((function(e){var r=e.getAttribute("TYPE");return e=e.getAttribute("GROUP-ID"),r.value==t&&e.value==n}))},Pc:function(e,t){return Vt([e],[t])[0]},gd:function(e){return/^#(?!EXT)/m.test(e)}};function Ci(e){this.b=e,this.a=0}function Di(e){ji(e,/[ \t]+/gm)}function ji(e,t){t.lastIndex=e.a;var n=t.exec(e.b);return n=null==n?null:{position:n.index,length:n[0].length,mg:n},e.a==e.b.length||null==n||n.position!=e.a?null:(e.a+=n.length,n.mg)}function Ni(e){return e.a==e.b.length?null:(e=ji(e,/[^ \t\n]*/gm))?e[0]:null}function _i(){this.a=0}function Li(e,t,n){var r=(t=(t=it(t)).replace(/\r\n|\r(?=[^\n]|$)/gm,"\n").trim()).split(/\n+/m);if(!/^#EXTM3U($|[ \t\n])/m.test(r[0]))throw new he(2,4,4015);t=0;for(var i=1;i<r.length;i++)if(!Ri.gd(r[i])){var o=Ki(e,r[i]);if(--e.a,Bi.includes(o.name)){t=1;break}"EXT-X-STREAM-INF"==o.name&&(i+=1)}for(i=[],o=1;o<r.length;)if(Ri.gd(r[o]))o+=1;else{var a=Ki(e,r[o]);if(Vi.includes(a.name)){if(1!=t)throw new he(2,4,4017);return new xi(n,t,i,e=Ui(e,n,r=r.splice(o,r.length-o),i))}i.push(a),o+=1,"EXT-X-STREAM-INF"==a.name&&(a.a.push(new Oi("URI",r[o])),o+=1)}return new xi(n,t,i)}function Ui(e,t,n,r){var i=[],o=[];return n.forEach((function(n){if(/^(#EXT)/.test(n))n=Ki(e,n),Bi.includes(n.name)?r.push(n):o.push(n);else{if(Ri.gd(n))return[];n=Ri.Pc(t,n.trim()),i.push(new Ii(n,o)),o=[]}})),i}function Ki(e,t){var n=e.a++,r=t.match(/^#(EXT[^:]*)(?::(.*))?$/);if(!r)throw new he(2,4,4016,t);var i,o=r[1],a=r[2];if(r=[],a){var s;(s=ji(a=new Ci(a),/^([^,=]+)(?:,|$)/g))&&(i=s[1]);for(var u=/([^=]+)=(?:"([^"]*)"|([^",]*))(?:,|$)/g;s=ji(a,u);)r.push(new Oi(s[1],s[2]||s[3]))}return new Ai(n,o,r,i)}var Bi="EXT-X-TARGETDURATION EXT-X-MEDIA-SEQUENCE EXT-X-DISCONTINUITY-SEQUENCE EXT-X-PLAYLIST-TYPE EXT-X-MAP EXT-X-I-FRAMES-ONLY EXT-X-ENDLIST".split(" "),Vi="EXTINF EXT-X-BYTERANGE EXT-X-DISCONTINUITY EXT-X-PROGRAM-DATE-TIME EXT-X-KEY EXT-X-DATERANGE".split(" ");function Fi(e){try{var t=Fi.parse(e);return be({uri:e,vd:e,data:t.data,headers:{"content-type":t.contentType}})}catch(e){return ve(e)}}function Hi(){var e=this;this.a=this.f=null,this.ea=1,this.G=new Map,this.V=new Set,this.b=new Map,this.c=null,this.v="",this.u=new _i,this.S=0,this.h=new fe((function(){!function(e){y((function t(){var n,r;return L(t,(function(t){switch(t.j){case 1:return Y.info("Updating manifest..."),e.f?(A(t,2),k(t,e.update(),4)):t.return();case 4:n=e.S,e.h.T(n),M(t,0);break;case 2:if(r=I(t),!e.f)return t.return();r.severity=1,e.f.onError(r),e.h.T(.1),x(t)}}))}))}(e)})),this.g=co,this.o=null,this.F=0,this.H=1/0,this.i=new Me,this.K=[],this.l=new Map,this.$=!1}function zi(e,t){return y((function n(){var r,i,o,a,s,u,c,l,f,d;return L(n,(function(n){switch(n.j){case 1:return r=Ri,i=lo,o=t.Pe,k(n,so(e,je([o],e.a.retryParameters),0),2);case 2:if(a=n.s,1!=(s=Li(e.u,a.data,a.uri)).type)throw new he(2,4,4017);return c=(u=r.Ya(s.a,"EXT-X-MEDIA-SEQUENCE"))?Number(u.value):0,l=t.stream,k(n,Qi(e,t.Jc,s,c,l.mimeType,l.codecs),3);case 3:f=n.s,t.bc.a=f,d=f[f.length-1],r.Ya(s.a,"EXT-X-ENDLIST")&&(ao(e,i.Va),e.c.Ba(d.endTime)),x(n)}}))}))}function qi(e){e.forEach((function(e){if(e){var t=e.stream.codecs.split(",");t=t.filter((function(e){return"mp4a.40.34"!=e})),e.stream.codecs=t.join(",")}}))}function Gi(e,t,n,r,i){return{id:e.ea++,language:t?t.language:"und",primary:!!t&&t.primary||!!n&&n.primary,audio:t,video:n,bandwidth:r,drmInfos:i,allowedByApplication:!0,allowedByKeySystem:!0}}function Wi(e,t,n){return y((function r(){var i,o,a,s,u,c,l,f,d,p,h,y;return L(r,(function(r){switch(r.j){case 1:if(i=to(t,"URI"),e.b.has(i))return r.return(e.b.get(i));if(o=to(t,"TYPE").toLowerCase(),a=Ht,"subtitles"==o&&(o=a.va),s=Cn(Mi(t,"LANGUAGE","und")),u=Mi(t,"NAME"),c=t.getAttribute("DEFAULT"),l=t.getAttribute("AUTOSELECT"),f=Mi(t,"CHANNELS"),"audio"==o)if(f){var m=f.split("/")[0];m=parseInt(m,10)}else m=null;else m=null;return d=m,p=!!c||!!l,h=Mi(t,"CHARACTERISTICS"),k(r,Xi(e,i,n,o,s,p,u,d,null,h),2);case 2:return y=r.s,e.b.has(i)?r.return(e.b.get(i)):null==y?r.return(null):(e.G.set(t.id,y),e.b.set(i,y),r.return(y))}}))}))}function Xi(e,t,n,r,i,o,a,s,u,c){return y((function l(){var f,d,h,m,v,g,b,w,S,T,E,P,x,O,R,C,D,j,N,_,U,K,B,V,F,H,z;return L(l,(function(l){switch(l.j){case 1:return d=(f=Ri).Pc(e.v,t),k(l,so(e,je([d],e.a.retryParameters),0),2);case 2:if(h=l.s,d=h.uri,1!=(m=Li(e.u,h.data,d)).type)throw new he(2,4,4017);v=[],m.segments.forEach((function(e){e=f.ub(e.b,"EXT-X-KEY"),v.push.apply(v,e)})),g=!1,b=[],w=null;for(var q=p(v),G=q.next();!G.done;G=q.next())if(S=G.value,"NONE"!=(T=to(S,"METHOD"))){if(g=!0,"AES-128"==T)return Y.m("Unsupported HLS Encryption",T),e.$=!0,l.return(null);E=to(S,"KEYFORMAT"),(x=(P=uo[E])?P(S):null)?(x.keyIds.length&&(w=x.keyIds[0]),b.push(x)):Y.m("Unsupported HLS KEYFORMAT",E)}if(g&&!b.length)throw new he(2,4,4026);return function(e,t){var n=lo,r=Ri.Ya(t.a,"EXT-X-PLAYLIST-TYPE"),i=Ri.Ya(t.a,"EXT-X-ENDLIST");i=r&&"VOD"==r.value||i,r=r&&"EVENT"==r.value&&!i,r=!i&&!r,i?ao(e,n.Va):(ao(e,r?n.Rd:n.Ke),n=no(t.a,"EXT-X-TARGETDURATION"),n=Number(n.value),e.F=Math.max(n,e.F),e.H=Math.min(n,e.H))}(e,m),O=function(e,t){if(1==t.length)return t[0];var n=eo(e,t);if(null!=n)return n;throw new he(2,4,4025,t)}(r,n),k(l,function(e,t,n,r){return y((function i(){var o,a,s,u,c,l,f,d,p;return L(i,(function(i){switch(i.j){case 1:return o=Ht,a=r.segments[0].a,s=new J(a),u=s.la.split(".").pop(),c=oo[t],(l=c[u])?i.return(l):t==o.va?n&&"vtt"!=n?i.return("application/mp4"):i.return("text/vtt"):((f=je([a],e.a.retryParameters)).method="HEAD",k(i,so(e,f,1),2));case 2:if(d=i.s,!(p=d.headers["content-type"]))throw new he(2,4,4021,u);return i.return(p.split(";")[0])}}))}))}(e,r,O,m),3);case 3:return R=l.s,io.includes(R)&&(O=""),D=(C=f.Ya(m.a,"EXT-X-MEDIA-SEQUENCE"))?Number(C.value):0,A(l,4),k(l,Qi(e,t,m,D,R,O),6);case 6:j=l.s,M(l,5);break;case 4:if(4035==(N=I(l)).code)return Y.Z("Skipping unsupported HLS stream",R,t),l.return(null);throw N;case 5:return _=j[0].startTime,U=j[j.length-1].endTime,K=U-_,B=new Qr(j),V=Yi(m),F=void 0,"text"==r&&(F="subtitle"),H=[],c&&H.push(c),z={id:e.ea++,originalId:a,createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:B.find.bind(B),getSegmentReference:B.get.bind(B),initSegmentReference:V,presentationTimeOffset:0,mimeType:R,codecs:O,kind:F,encrypted:g,keyId:w,language:i,label:a,type:r,primary:o,trickModeVideo:null,emsgSchemeIdUris:null,frameRate:void 0,pixelAspectRatio:void 0,width:void 0,height:void 0,bandwidth:void 0,roles:H,channelsCount:s,audioSamplingRate:null,closedCaptions:u},l.return({stream:z,bc:B,drmInfos:b,Jc:t,Pe:d,nd:_,Qg:U,duration:K})}}))}))}function Yi(e){var t=Ri.ub(e.a,"EXT-X-MAP");if(!t.length)return null;if(1<t.length)throw new he(2,4,4020);var n=to(t=t[0],"URI"),r=Ri.Pc(e.b,n);return e=0,n=null,(t=Mi(t,"BYTERANGE"))&&(e=t.split("@"),t=Number(e[0]),n=(e=Number(e[1]))+t-1),new Yr((function(){return[r]}),e,n)}function $i(e,t,n,r){var i=t.b,o=t.a;t=no(i,"EXTINF").value.split(","),t=r+Number(t[0]);var a=0,s=null;return(i=Ri.Ya(i,"EXT-X-BYTERANGE"))&&(a=i.value.split("@"),i=Number(a[0]),s=(a=a[1]?Number(a[1]):e.a+1)+i-1),new $r(n,r,t,(function(){return[o]}),a,s)}function Ji(e){e.c&&(e.K.forEach((function(t){e.c.Eb(t,0)})),e.K=[])}function Qi(e,t,n,r,i,o){return y((function a(){var s,u,c,l,f,d,p,h,m,v;return L(a,(function(a){switch(a.j){case 1:return s=n.segments,u=[],c=s[0].a,l=$i(null,s[0],r,0),f=Yi(n),k(a,function(e,t,n,r,i,o){return y((function a(){var s,u,c,l,f,d,p,h,y;return L(a,(function(a){switch(a.j){case 1:if(e.o){if(s=e.b.get(t),u=s.bc,c=u.get(r.position))return Y.D("Found segment start time in previous manifest"),a.return(c.startTime);Y.debug("Unable to find segment start time in previous manifest!")}if(Y.D("Fetching segment to find start time"),i=i.toLowerCase(),io.includes(i))throw Y.Z("Raw formats are not yet supported.  Skipping "+i),new he(1,4,4035);if("video/webm"==i)throw Y.Z("WebM in HLS is not yet supported.  Skipping."),new he(1,4,4035);if("video/mp4"!=i&&"audio/mp4"!=i){a.C(2);break}return l=[Zi(e,r)],n&&l.push(Zi(e,n)),k(a,Promise.all(l),3);case 3:return f=a.s,d=f[0],p=f[1]||f[0],a.return(function(e,t,n,r){var i=0;if((new Rr).L("moov",Cr).L("trak",Cr).L("mdia",Cr).ia("mdhd",(function(e){e.reader.P(0==e.version?8:16),i=e.reader.I(),e.parser.stop()})).parse(r,!0),!i)throw Y.error("Unable to find timescale in init segment!"),new he(2,4,4030,e,t);var o=0,a=!1;if((new Rr).L("moof",Cr).L("traf",Cr).ia("tfdt",(function(e){o=(0==e.version?e.reader.I():e.reader.Kb())/i,a=!0,e.parser.stop()})).parse(n,!0),!a)throw new he(2,4,4030,e,t);return o}(t,d.uri,d.data,p.data));case 2:if("video/mp2t"!=i){a.C(4);break}return k(a,Zi(e,r),5);case 5:return h=a.s,a.return(function(e,t,n){function r(){o.seek(a+188),71!=(s=o.na())&&(o.seek(a+192),s=o.na()),71!=s&&(o.seek(a+204),s=o.na()),71!=s&&i(),o.ze(1)}function i(){throw new he(2,4,4030,e,t)}for(var o=new Or(new DataView(n),0),a=0,s=0;;)if(a=o.ga(),71!=(s=o.na())&&i(),8191==(8191&(n=o.$b())))r();else if(16384&n){if(0!=(n=(48&o.na())>>4)&&2!=n||i(),3==n&&(n=o.na(),o.P(n)),1==o.I()>>8){o.P(3),0!=(n=o.na()>>6)&&1!=n||i(),0==o.na()&&i(),n=o.na();var u=o.$b(),c=o.$b();return(1073741824*((14&n)>>1)+((65534&u)<<14|(65534&c)>>1))/9e4}r()}else r()}(t,h.uri,h.data));case 4:if("application/mp4"!=i&&!i.startsWith("text/")){a.C(6);break}return k(a,Zi(e,r),7);case 7:return y=a.s,a.return(function(e,t,n){return pn(e=We(e,t))?(hn(t=new fn(null),e),t.sc(n)):0}(i,o,y.data));case 6:throw new he(2,4,4030,t)}}))}))}(e,t,f,l,i,o),2);case 2:d=a.s,Y.debug("First segment",c.split("/").pop(),"starts at",d);for(var g=0;g<s.length;++g)p=s[g],h=u[u.length-1],m=0==g?d:h.endTime,v=$i(h,p,r+g,m),u.push(v);return e.K.push(u),Ji(e),a.return(u)}}))}))}function Zi(e,t){return y((function n(){var r,i,o,a,s,u;return L(n,(function(n){switch(n.j){case 1:return r=1,i=mi(t.c(),t.b,t.b+2048-1,e.a.retryParameters),o=mi(t.c(),t.b,t.a,e.a.retryParameters),e.a.hls.useFullSegmentsForStartTime?n.return(so(e,o,r)):(A(n,2),k(n,so(e,i,r),4));case 4:return a=n.s,n.return(a);case 2:if(7001==(s=I(n)).code)throw s;return Y.Z("Unable to fetch a partial HLS segment! Falling back to a full segment request, which is expensive!  Your server should support Range requests and CORS preflights.",i.uris[0]),k(n,so(e,o,r),5);case 5:return u=n.s,n.return(u)}}))}))}function eo(e,t){for(var n=ro[e],r=0;r<n.length;r++)for(var i=0;i<t.length;i++)if(n[r].test(t[i].trim()))return t[i].trim();return"text"==e?"":null}function to(e,t){var n=e.getAttribute(t);if(!n)throw new he(2,4,4023,t);return n.value}function no(e,t){var n=Ri.Ya(e,t);if(!n)throw new he(2,4,4024,t);return n}H("shaka.net.DataUriPlugin",Fi),Fi.parse=function(t){var n=t.split(":");if(2>n.length||"data"!=n[0])throw Y.error("Bad data URI, failed to parse scheme"),new he(2,1,1004,t);if(2>(n=n.slice(1).join(":").split(",")).length)throw Y.error("Bad data URI, failed to extract encoding and MIME type"),new he(2,1,1004,t);var r=n[0];n=e.decodeURIComponent(n.slice(1).join(","));var i=null;if(1<(r=r.split(";")).length&&(i=r[1]),"base64"==i)t=ft.Fa(n).buffer;else{if(i)throw Y.error("Bad data URI, unknown encoding"),new he(2,1,1005,t);t=st(n)}return{data:t,contentType:r[0]}},De("data",Fi),H("shaka.hls.HlsParser",Hi),(i=Hi.prototype).configure=function(e){this.a=e},i.start=function(e,t){var n=this;return y((function r(){var i,o;return L(r,(function(r){switch(r.j){case 1:return n.f=t,k(r,so(n,je([e],n.a.retryParameters),0),2);case 2:return i=r.s,n.v=i.uri,k(r,function(e,t){return y((function n(){var r,i,o,a,s,u,c,l,f,d,h;return L(n,(function(n){switch(n.j){case 1:if(0!=(r=Li(e.u,t,e.v)).type)throw new he(2,4,4022);return k(n,function(e,t){return y((function n(){var r,i,o,a,s,u,c,l,f,d,h,m;return L(n,(function(n){switch(n.j){case 1:return r=Ri,i=Bt,o=t.a,a=r.ub(t.a,"EXT-X-MEDIA"),s=a.filter(function(e){return"SUBTITLES"==to(e,"TYPE")}.bind(e)),u=s.map(function(e){var t=this;return y((function n(){var r;return L(n,(function(n){switch(n.j){case 1:return t.a.disableText?n.return(null):(A(n,2),k(n,function(e,t){return y((function n(){var r;return L(n,(function(n){switch(n.j){case 1:return to(t,"TYPE"),k(n,Wi(e,t,[]),2);case 2:return r=n.s,n.return(r.stream)}}))}))}(t,e),4));case 4:return n.return(n.s);case 2:if(r=I(n),t.a.hls.ignoreTextStreamFailures)return n.return(null);throw r}}))}))}.bind(e)),c=a.filter((function(e){return"CLOSED-CAPTIONS"==to(e,"TYPE")})),function(e,t){for(var n=p(t),r=n.next();!r.done;r=n.next()){to(r=r.value,"TYPE");var i=Mi(r,"LANGUAGE")||"und";i=Cn(i);var o=to(r,"GROUP-ID");r=to(r,"INSTREAM-ID"),e.l.get(o)||e.l.set(o,new Map),e.l.get(o).set(r,i)}}(e,c),k(n,Promise.all(u),2);case 2:return l=n.s,f=r.ub(o,"EXT-X-STREAM-INF"),d=f.map(function(e){return function(e,t,n){return y((function r(){var i,o,a,s,u,c,l,f,d,h,m,v,g,b,w,S,T,E,P,x,A,O,M,I,R,C,D;return L(r,(function(r){switch(r.j){case 1:return i=Ht,o=Ri,a=Mi(t,"CODECS","avc1.42E01E,mp4a.40.2"),s=function(e){for(var t=new Set,n=[],r=(e=p(e)).next();!r.done;r=e.next()){var i=Xe(r=r.value)[0];t.has(i)?Y.debug("Ignoring duplicate codec"):(n.push(r),t.add(i))}return n}(a.split(/\s*,\s*/)),u=t.getAttribute("RESOLUTION"),l=c=null,f=Mi(t,"FRAME-RATE"),d=Number(to(t,"BANDWIDTH")),u&&(h=u.value.split("x"),c=h[0],l=h[1]),m=(m=(m=o.ub(n.a,"EXT-X-MEDIA")).filter((function(e){return"CLOSED-CAPTIONS"!=to(e,"TYPE")}))).filter((function(e){var t=Mi(e,"URI")||"";return"SUBTITLES"==(Mi(e,"TYPE")||"")||""!=t})),v=Mi(t,"AUDIO"),g=Mi(t,"VIDEO"),v?m=o.Xc(m,"AUDIO",v):g&&(m=o.Xc(m,"VIDEO",g)),(b=eo(i.va,s))&&((w=Mi(t,"SUBTITLES"))&&((S=o.Xc(m,"SUBTITLES",w)).length&&(T=e.G.get(S[0].id))&&(T.stream.codecs=b)),Ae(s,b)),E=m.map(function(e){return Wi(this,e,s)}.bind(e)),P=[],x=[],k(r,Promise.all(E),2);case 2:if(O=(O=r.s).filter((function(e){return null!=e})),v?P=O:g&&(x=O),Y.debug("Guessing stream type for",t.toString()),I=!1,P.length||x.length?P.length?(C=to(t,"URI"),D=P[0].Jc,C==D?(Y.debug("Guessing audio-only."),M=i.Nb,I=!0):(Y.debug("Guessing video."),M=i.Ua)):(Y.debug("Guessing audio."),M=i.Nb):1==s.length?(R=eo(i.Ua,s),u||f||R?(Y.debug("Guessing video-only."),M=i.Ua):(Y.debug("Guessing audio-only."),M=i.Nb)):(Y.debug("Guessing multiplexed audio+video."),M=i.Ua,s=[s.join(",")]),I){r.C(3);break}return k(r,function(e,t,n,r){return y((function i(){var o,a,s,u,c;return L(i,(function(i){switch(i.j){case 1:return o=Ht,a=to(t,"URI"),e.b.has(a)?i.return(e.b.get(a)):(s=Mi(t,"CLOSED-CAPTIONS"),u=null,r==o.Ua&&s&&"NONE"!=s&&(u=e.l.get(s)),k(i,Xi(e,a,n,r,"und",!1,null,null,u,null),2));case 2:return null==(c=i.s)?i.return(null):e.b.has(a)?i.return(e.b.get(a)):(e.b.set(a,c),i.return(c))}}))}))}(e,t,s,M),4);case 4:A=r.s;case 3:if(A)A.stream.type==i.Nb?P=[A]:x=[A];else if(null===A)return Y.debug("streamInfo is null"),r.return([]);return x&&qi(x),P&&qi(P),r.return(function(e,t,n,r,i,o,a){n.forEach(function(e){(e=e.stream)&&(e.width=Number(i)||void 0,e.height=Number(o)||void 0,e.frameRate=Number(a)||void 0)}.bind(e));var s=!!e.a&&e.a.disableAudio;t.length&&!s||(t=[null]);s=!!e.a&&e.a.disableVideo,(!n.length||s)&&(n=[null]);s=[];for(var u=(t=p(t)).next();!u.done;u=t.next()){u=u.value;for(var c=p(n),l=c.next();!l.done;l=c.next()){var f=l.value;l=u?u.stream:null;var d=f?f.stream:null,h=u?u.drmInfos:null,y=f?f.drmInfos:null;f=(f?f.Jc:"")+" - "+(u?u.Jc:"");var m=void 0;if(l&&d){if(h.length&&y.length&&!(0<Ot(h,y).length)){Y.m("Incompatible DRM info in HLS variant.  Skipping.");continue}m=Ot(h,y)}else l?m=h:d&&(m=y);e.V.has(f)?Y.debug("Skipping variant which only differs in text streams."):(l=Gi(e,l,d,r,m),s.push(l),e.V.add(f))}}return s}(e,P,x,d,c,l,f))}}))}))}(this,e,t)}.bind(e)),k(n,Promise.all(d),3);case 3:return h=n.s,m=(m=h.reduce(i.Oc,[])).filter((function(e){return null!=e})),n.return({startTime:0,variants:m,textStreams:l.filter((function(e){return null!=e}))})}}))}))}(e,r),2);case 2:if(i=n.s,!e.f)throw new he(2,7,7001);if(e.$&&0==i.variants.length)throw Y.info("No stream is created, because we don't support AES-128","encryption yet"),new he(2,4,4034);e.f.filterAllPeriods([i]),o=1/0,a=0,s=1/0;for(var m=p(e.b.values()),v=m.next();!v.done;v=m.next())u=v.value,o=Math.min(o,u.nd),a=Math.max(a,u.nd),"text"!=u.stream.type&&(s=Math.min(s,u.duration));if(e.g!=lo.Va?(e.c=new yi(0,3*e.F),e.c.dc(!1)):(e.c=new yi(null,0),e.c.dc(!0)),Ji(e),e.g!=lo.Va){for(e.S=e.H,c=lo,e.g==c.Rd&&(l=e.c.Dc,isNaN(e.a.availabilityWindowOverride)||(l=e.a.availabilityWindowOverride),e.c.Jd(l)),f=0;95443.7176888889<=a;)f+=95443.7176888889,a-=95443.7176888889;if(f)for(Y.debug("Offsetting live streams by",f,"to compensate for rollover"),v=(m=p(e.b.values())).next();!v.done;v=m.next())95443.7176888889>(d=v.value).nd?(Y.D("Offset applied to",d.stream.type),d.stream.presentationTimeOffset=-f,d.bc.offset(f)):Y.D("Offset NOT applied to",d.stream.type)}else for(e.c.Ba(s),e.c.offset(-o),v=(m=p(e.b.values())).next();!v.done;v=m.next())(h=v.value).stream.presentationTimeOffset=o,h.bc.offset(-o),Zr(h.bc,s);e.o={presentationTimeline:e.c,periods:[i],offlineSessionIds:[],minBufferTime:0},x(n)}}))}))}(n,i.data),3);case 3:return 0<(o=n.S)&&n.h.T(o),r.return(n.o)}}))}))},i.stop=function(){this.h&&(this.h.stop(),this.h=null);var e=[];return this.i&&(e.push(this.i.destroy()),this.i=null),this.a=this.f=null,this.G.clear(),this.V.clear(),this.b.clear(),this.o=null,Promise.all(e)},i.update=function(){if(this.g!=lo.Va){for(var e=[],t=p(this.b.values()),n=t.next();!n.done;n=t.next())e.push(zi(this,n.value));return Promise.all(e)}},i.onExpirationUpdated=function(){};var ro={audio:[/^vorbis$/,/^opus$/,/^flac$/,/^mp4a/,/^[ae]c-3$/],video:[/^avc/,/^hev/,/^hvc/,/^vp0?[89]/,/^av1$/],text:[/^vtt$/,/^wvtt/,/^stpp/]},io=["audio/aac","audio/ac3","audio/ec3","audio/mpeg"],oo={audio:{mp4:"audio/mp4",m4s:"audio/mp4",m4i:"audio/mp4",m4a:"audio/mp4",cmfa:"audio/mp4",ts:"video/mp2t",aac:"audio/aac",ac3:"audio/ac3",ec3:"audio/ec3",mp3:"audio/mpeg"},video:{mp4:"video/mp4",m4s:"video/mp4",m4i:"video/mp4",m4v:"video/mp4",cmfv:"video/mp4",ts:"video/mp2t"},text:{mp4:"application/mp4",m4s:"application/mp4",m4i:"application/mp4",cmft:"application/mp4",vtt:"text/vtt",ttml:"application/ttml+xml"}};function ao(e,t){e.g=t,e.c&&e.c.dc(e.g==lo.Va),e.g!=lo.Va||e.h.stop()}function so(e,t,n){if(!e.i)throw new he(2,7,7001);return t=e.f.networkingEngine.request(n,t),Ie(e.i,t),t.promise}var uo={"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":function(e){var t=to(e,"METHOD");Bn("HLS SAMPLE-AES-CENC","SAMPLE-AES-CENC will no longer be supported, see Issue #1227");var n=["SAMPLE-AES","SAMPLE-AES-CTR","SAMPLE-AES-CENC"];return n.includes(t)?(t=to(e,"URI"),t=Fi.parse(t),t=Ft("com.widevine.alpha",[{initDataType:"cenc",initData:t=new Uint8Array(t.data)}]),(e=Mi(e,"KEYID"))&&(t.keyIds=[e.substr(2).toLowerCase()]),t):(Y.error("Widevine in HLS is only supported with [",n.join(", "),"], not",t),null)}},co="VOD",lo={Va:co,Ke:"EVENT",Rd:"LIVE"};function fo(){this.a=new Map}function po(e,t,n){ho(e,t).text=n}function ho(e,t){return e.a.has(t)||e.a.set(t,new yo),e.a.get(t)}function yo(){this.text=this.variant=null}function mo(e,t){this.a=e,this.b=new Set([e]);for(var n=p(t=t||[]),r=n.next();!r.done;r=n.next())this.add(r.value)}function vo(e,t){var n;if(!(n=!!e.audio!=!!t.audio||!!e.video!=!!t.video||e.language!=t.language)&&(n=e.audio&&t.audio)){n=e.audio;var r=t.audio;n=!(n.channelsCount==r.channelsCount&&go(n,r)&&bo(n.roles,r.roles))}return!n&&(n=e.video&&t.video)&&(n=!(go(n=e.video,r=t.video)&&bo(n.roles,r.roles))),!n}function go(e,t){if(e.mimeType!=t.mimeType)return!1;var n=e.codecs.split(",").map((function(e){return Xe(e)[0]})),r=t.codecs.split(",").map((function(e){return Xe(e)[0]}));if(n.length!=r.length)return!1;n.sort(),r.sort();for(var i=0;i<n.length;i++)if(n[i]!=r[i])return!1;return!0}function bo(e,t){var n=new Set(e),r=new Set(t);if(n.delete("main"),r.delete("main"),n.size!=r.size)return!1;for(var i=(n=p(n)).next();!i.done;i=n.next())if(!r.has(i.value))return!1;return!0}function wo(e){this.a=e,this.b=new So(e.language,"",e.audio&&e.audio.channelsCount?e.audio.channelsCount:0,"")}function So(e,t,n,r,i){this.f=e,this.c=t,this.a=n,this.b=void 0===r?"":r,this.g=void 0===i?"":i}function To(){this.a=ko,this.b=(new Map).set(ko,2).set(Po,1)}function Eo(e,t,n){e.b.set(ko,n).set(Po,t)}hi.zd("m3u8",Hi),hi.Lb("application/x-mpegurl",Hi),hi.Lb("application/vnd.apple.mpegurl",Hi),mo.prototype.add=function(e){return vo(this.a,e)?(this.b.add(e),!0):(Y.m("Rejecting variant - not compatible with root."),!1)},mo.prototype.values=function(){return this.b.values()},wo.prototype.create=function(e){var t=this,n=e.filter((function(e){return vo(t.a,e)}));return n.length?new mo(n[0],n):this.b.create(e)},So.prototype.create=function(e){var t=[];t=function(e,t){var n=jn(Cn(t),e.map((function(e){return Dn(e)})));return n?e.filter((function(e){return n==Dn(e)})):[]}(e,this.f);var n=e.filter((function(e){return e.primary}));for(t=t.length?t:n.length?n:e,this.c&&((e=function(e,t,n){return e.filter((function(e){if(n){var r=e[n];return r&&r.roles.includes(t)}return r=e.audio,e=e.video,r&&0<=r.roles.indexOf(t)||e&&0<=e.roles.indexOf(t)}))}(t,this.c,this.g)).length?t=e:Y.m("No exact match for variant role could be found.")),this.a&&((e=_n.$d(t,this.a)).length?t=e:Y.m("No exact match for the channel count could be found.")),this.b&&((e=function(e,t){return e.filter((function(e){return!!e.audio&&e.audio.label.toLowerCase()==t.toLowerCase()}))}(t,this.b)).length?t=e:Y.m("No exact match for variant label could be found.")),e=new mo(t[0]),n=(t=p(t)).next();!n.done;n=t.next())n=n.value,vo(e.a,n)&&e.add(n);return e};var Po=0,ko=1;function xo(e,t){this.g=e,this.h=Oo(e),this.a=e.a.currentTime,this.f=Date.now()/1e3,this.b=!1,this.i=t,this.c=function(){}}function Ao(e){this.a=e}function Oo(e){if(e.a.paused||0==e.a.playbackRate||0==e.a.buffered.length)var t=!1;else e:{t=e.a.buffered,e=e.a.currentTime;for(var n=0;n<t.length;n++){var r=t.start(n),i=t.end(n);if(!(e<r||e>i-.5)){t=!0;break e}}t=!1}return t}function Mo(e,t,n,r,i){var o=this;this.a=e,this.v=t,this.u=n,this.l=i,this.f=new Ue,this.i=!1,this.o=e.readyState,this.c=!1,this.b=r,this.h=!1,this.f.B(e,"waiting",(function(){return Io(o)})),this.g=new fe((function(){Io(o)})).Ra(.25)}function Io(e){if(0!=e.a.readyState){if(e.a.seeking){if(!e.i)return}else e.i=!1;if(!e.a.paused){e.a.readyState!=e.o&&(e.c=!1,e.o=e.a.readyState);var t=e.u.smallGapLimit,n=e.a.currentTime,r=e.a.buffered;e:{if(r&&r.length&&!(1==r.length&&1e-6>r.end(0)-r.start(0)))for(var i=et("Edge/")||et("Trident/")||et("Tizen")||et("CrKey")?.5:.1,o=0;o<r.length;o++)if(r.start(o)>n&&(0==o||r.end(o-1)-n<=i)){i=o;break e}i=null}if(null==i)e.b&&(r=Oo(n=(e=e.b).g),i=n.a.currentTime,o=Date.now()/1e3,e.a==i&&e.h==r||(e.f=o,e.a=i,e.h=r,e.b=!1),(i=o-e.f)>=e.i&&r&&!e.b&&(e.c(e.a,i),e.b=!0,e.a=n.a.currentTime));else if(0!=i||e.h){o=r.start(i);var a=e.v.Ga();if(!(o>=a)){t=(a=o-n)<=t;var s=!1;if(!(.001>a)){if(!t&&!e.c){e.c=!0;var u=new Te("largegap",{currentTime:n,gapSize:a});u.cancelable=!0,e.l(u),e.u.jumpLargeGaps&&!u.defaultPrevented?s=!0:Y.info("Ignoring large gap at",n,"size",a)}(t||s)&&(0==i?Y.info("Jumping forward",a,"seconds because of gap before start time of",o):Y.info("Jumping forward",a,"seconds because of gap starting at",r.end(i-1),"and ending at",o),e.a.currentTime=o)}}}}}}function Ro(e){var t=this;this.c=e,this.a=new Set,this.b=new fe((function(){Co(t,!1)})).Ra(.25)}function Co(e,t){for(var n=p(e.a),r=n.next();!r.done;r=n.next())r.value.g(e.c.currentTime,t)}function Do(e){for(var t=[],n=(e=p(e)).next();!n.done;n=e.next())for(var r=(n=p(n.value.variants)).next();!r.done;r=n.next())t.push(r.value);return t}function jo(e,t){for(var n=null,r=p(e),i=r.next();!i.done;i=r.next())t>=(i=i.value).startTime&&(n=i);return n}function No(e){this.c=e,this.a=null,this.b=function(){}}function _o(e){var t=this;this.a=e,this.f=!1,this.c=this.a.rc(),this.b=new fe((function(){t.a.le(.25*t.c)}))}function Lo(e){e.b.stop();var t=e.f?0:e.c;if(0<=t)try{return void(e.a.rc()!=t&&e.a.Id(t))}catch(e){}e.b.Ra(.25),0!=e.a.rc()&&e.a.Id(0)}function Uo(e,t,n,r){t==HTMLMediaElement.HAVE_NOTHING||e.readyState>=t?r():(t=Ko.get(t),n.ua(e,t,r))}xo.prototype.release=function(){this.g=null,this.c=function(){}},Mo.prototype.release=function(){this.f&&(this.f.release(),this.f=null),null!=this.g&&(this.g.stop(),this.g=null),this.b&&(this.b.release(),this.b=null),this.a=this.v=this.l=null},Mo.prototype.td=function(){this.h=!0,Io(this)},Ro.prototype.release=function(){this.b.stop();for(var e=p(this.a),t=e.next();!t.done;t=e.next())t.value.release();this.a.clear()},No.prototype.release=function(){this.a=this.c=null,this.b=function(){}},No.prototype.g=function(e){var t=this.a,n=this.c.periods;t!=(e=jo(n,e)||n[0])&&this.b(e),this.a=e},_o.prototype.release=function(){this.b&&(this.b.stop(),this.b=null),this.a=null},_o.prototype.set=function(e){this.c=e,Lo(this)};var Ko=new Map([[HTMLMediaElement.HAVE_METADATA,"loadedmetadata"],[HTMLMediaElement.HAVE_CURRENT_DATA,"loadeddata"],[HTMLMediaElement.HAVE_FUTURE_DATA,"canplay"],[HTMLMediaElement.HAVE_ENOUGH_DATA,"canplaythrough"]]);function Bo(e,t,n){var r=this;this.a=e,this.g=t,this.f=n,this.h=!1,this.b=new Ue,this.c=new qo(e),Uo(this.a,HTMLMediaElement.HAVE_METADATA,this.b,(function(){Ho(r,r.f)}))}function Vo(e){return e.h?e.a.currentTime:e.f}function Fo(e,t){0<e.a.readyState?Go(e.c,t):Uo(e.a,HTMLMediaElement.HAVE_METADATA,e.b,(function(){Ho(e,e.f)}))}function Ho(e,t){.001>Math.abs(e.a.currentTime-t)?zo(e):(e.b.ua(e.a,"seeking",(function(){zo(e)})),Go(e.c,0==e.a.currentTime?t:e.a.currentTime))}function zo(e){e.h=!0,e.b.B(e.a,"seeking",(function(){return e.g()}))}function qo(e){var t=this;this.b=e,this.h=10,this.g=this.c=this.f=0,this.a=new fe((function(){0>=t.f?(Y.m(["Failed to move playhead from",t.c,"to",t.g].join(" ")),t.a.stop()):t.b.currentTime!=t.c?t.a.stop():(t.b.currentTime=t.g,t.f--)}))}function Go(e,t){e.c=e.b.currentTime,e.g=t,e.f=e.h,e.b.currentTime=t,e.a.Ra(.1)}function Wo(e){var t=this;this.a=e,this.f=!1,this.c=null,this.b=new Ue,Uo(this.a,HTMLMediaElement.HAVE_CURRENT_DATA,this.b,(function(){null==t.c?t.f=!0:(t.b.ua(t.a,"seeking",(function(){t.f=!0})),t.a.currentTime=Math.max(0,t.a.currentTime+t.c))}))}function Xo(e,t,n,r,i,o){var a=this;this.b=e,this.a=t.presentationTimeline,this.F=t.minBufferTime||0,this.h=n,this.v=i,this.l=null,this.f=new Mo(e,t.presentationTimeline,n,function(e,t){if(!t.stallEnabled)return null;var n=t.stallSkip,r=new xo(new Ao(e),t.stallThreshold);return function(e,t){e.c=t}(r,(function(t,r){Y.debug(["Stall detected at",t,"for",r,"seconds. Seeking forward",n,"seconds."].join(" ")),e.currentTime+=n})),r}(e,n),o),this.c=new Bo(e,(function(){e:{var e=a.f;e.i=!0,e.h=!1,e.c=!1,e=Vo(a.c);var t=$o(a,e);if(.001<Math.abs(t-e)){var n=(new Date).getTime()/1e3;if(!a.l||a.l<n-1){a.l=n,Fo(a.c,t),e=void 0;break e}}Y.D("Seek to "+e),a.v(),e=void 0}return e}),function(e,t){return null==t?t=1/0>e.a.ca()?e.a.wb():e.a.Ga():0>t&&(t=e.a.Ga()+t),Yo(e,Jo(e,t))}(this,r)),this.i=new fe((function(){if(0!=a.b.readyState&&!a.b.paused){var e=a.b.currentTime,t=a.a.wb(),n=a.a.Ga();3>n-t&&(t=n-3),e<t&&(t=$o(a,e),Y.info("Jumping forward "+(t-e)+" seconds to catch up with the seek range."),a.b.currentTime=t)}})).Ra(.25)}function Yo(e,t){var n=e.a.ca();return t>=n?n-e.h.durationBackoff:t}function $o(e,t){var n=Lt.bind(null,e.b.buffered),r=Math.max(e.F,e.h.rebufferingGoal),i=e.h.safeSeekOffset,o=e.a.wb(),a=e.a.Ga(),s=e.a.ca();3>a-o&&(o=a-3);var u=e.a.Vb(r),c=e.a.Vb(i);return r=e.a.Vb(r+i),t>=s?(Y.D("Playhead past duration."),Yo(e,t)):t>a?(Y.D("Playhead past end."),a):t<o?n(c)?(Y.D("Playhead before start & start is buffered"),c):(Y.D("Playhead before start & start is unbuffered"),r):t>=u||n(t)?(Y.D("Playhead in safe region or in buffered region."),t):(Y.D("Playhead outside safe region & in unbuffered region."),r)}function Jo(e,t){var n=e.a.wb();return t<n||t>(n=e.a.Ga())?n:t}function Qo(){this.b=function(){},this.a=new Set}function Zo(e){var t=this;this.h=e,this.f=new Map,this.a=function(){},this.b=function(){},this.c=function(){},this.i=[{lb:null,kb:ta,ab:function(e,n){return t.a(e,n)}},{lb:ea,kb:ta,ab:function(e,n){return t.a(e,n)}},{lb:na,kb:ta,ab:function(e,n){return t.a(e,n)}},{lb:ta,kb:ea,ab:function(e,n){return t.b(e,n)}},{lb:ta,kb:na,ab:function(e,n){return t.b(e,n)}},{lb:ea,kb:na,ab:function(e,n){return t.c(e,n)}},{lb:na,kb:ea,ab:function(e,n){return t.c(e,n)}}]}Bo.prototype.release=function(){this.b&&(this.b.release(),this.b=null),null!=this.c&&(this.c.release(),this.c=null),this.g=function(){},this.a=null},qo.prototype.release=function(){this.a&&(this.a.stop(),this.a=null),this.b=null},Wo.prototype.release=function(){this.b&&(this.b.release(),this.b=null),this.a=null},Wo.prototype.o=function(e){this.c=this.f?this.c:e},Wo.prototype.g=function(){return(this.f?this.a.currentTime:this.c)||0},Wo.prototype.u=function(){},Xo.prototype.release=function(){this.c&&(this.c.release(),this.c=null),this.f&&(this.f.release(),this.f=null),this.i&&(this.i.stop(),this.i=null),this.b=this.c=this.a=this.h=null,this.v=function(){}},Xo.prototype.o=function(e){Fo(this.c,e)},Xo.prototype.g=function(){var e=Vo(this.c);return 0<this.b.readyState&&!this.b.paused?Jo(this,e):e},Xo.prototype.u=function(){this.f.td()},Qo.prototype.release=function(){this.b=function(){},this.a.clear()},Zo.prototype.release=function(){this.h=null,this.f.clear(),this.a=function(){},this.b=function(){},this.c=function(){}},Zo.prototype.g=function(e,t){for(var n=p(this.h.a),r=n.next();!r.done;r=n.next()){r=r.value;var i=this.f.get(r),o=e<r.startTime?ea:e>r.endTime?na:ta;this.f.set(r,o);for(var a=p(this.i),s=a.next();!s.done;s=a.next())(s=s.value).lb==i&&s.kb==o&&s.ab(r,t)}};var ea=1,ta=2,na=3;function ra(e,t){this.a=t,this.c=e,this.g=null,this.l=1,this.v=Promise.resolve(),this.h=[],this.i=new Map,this.b=new Map,this.u=!1,this.H=null,this.G=this.f=this.o=!1,this.F=0}function ia(e){return aa(e,"audio")}function oa(e){return aa(e,"video")}function aa(e,t){var n=e.b.get(t);return n?n.Oa||n.stream:null}function sa(e,t){return y((function n(){var r,i,o,a,s,u,c,l,f;return L(n,(function(n){switch(n.j){case 1:return r=Ht,k(n,xn(e.a.O,r.va),2);case 2:return e.F++,e.G=!1,i=e.F,o=e.a.O,a=new Map,s=new Set,a.set(r.va,t),s.add(t),k(n,o.init(a,!1),3);case 3:return e.f?n.return():k(n,ya(e,s),4);case 4:if(e.f)return n.return();u=e.a.O.g.isTextVisible()||e.g.alwaysStreamText,e.F!=i||e.b.has(r.va)||e.G||!u||(c=e.a.Za(),l=Ea(e,c),f=pa(t,l,0),e.b.set(r.va,f),Aa(e,f,0)),x(n)}}))}))}function ua(e,t){var n=e.b.get("video");if(n){var r=n.stream;if(r)if(Y.debug("setTrickPlay",t),t){var i=r.trickModeVideo;i&&!n.Oa&&(Y.debug("Engaging trick mode stream",i),la(e,i,!1,0,!1),n.Oa=r)}else(r=n.Oa)&&(Y.debug("Restoring non-trick-mode stream",r),n.Oa=null,la(e,r,!0,0,!1))}}function ca(e,t,n,r){var i=!1;if(t.video){var o=la(e,t.video,n,r,!1);i=i||o}return t.audio&&(e=la(e,t.audio,n,r,!1),i=i||e),i}function la(e,t,n,r,i){var o=e.b.get(t.type);if(!o&&"text"==t.type&&e.g.ignoreTextStreamFailures)return sa(e,t),!0;if(!o)return!1;var a=Pa(e,t),s=Array.from(e.b.values()).every((function(e){return e.ka==o.ka}));return n&&a!=o.ka&&s?(Y.debug("switch: switching to stream in another Period; clearing buffer and changing Periods"),e.b.forEach((function(t){fa(e,t)})),!0):(o.Oa&&(Y.debug("switch during trick play mode",t),t.trickModeVideo?(o.Oa=t,t=t.trickModeVideo,Y.debug("switch found trick play stream",t)):(o.Oa=null,Y.debug("switch found no special trick play stream"))),!(!(s=e.h[a])||!s.Mb)&&(!(!(s=e.i.get(t.id))||!s.Mb)&&(o.stream!=t||i?("text"==t.type&&bn(e.a.O,We(t.mimeType,t.codecs)),o.stream=t,o.vc=!0,Y.debug("switch: switching to Stream "+Ra(o)),function(e,t,n){if(!t.fb)return!1;var r=e.a.Za(),i=Tn(e.a.O,t.type),o=ga(e,t,r,i,n);return n=o&&o.a?o.a-o.b:null,o&&!n&&(n=(o.endTime-o.sc())*t.stream.bandwidth/8),!isNaN(n)&&((o=t.stream.initSegmentReference)&&(n+=(o.a?o.a-o.b:null)||0),o=e.a.getBandwidthEstimate(),8*n/o<i-r-Math.max(e.c.minBufferTime||0,e.g.rebufferingGoal)||t.fb.b.a>n)}(e,o,a)&&(Y.info("Aborting current segment request to switch."),o.fb.abort()),n&&(o.Wa?o.Kc=!0:o.Na?(o.Sa=!0,o.lc=r,o.Kc=!0):(Oa(o),xa(e,o,!0,r).catch((function(t){e.a&&e.a.onError(t)})))),!0):(Y.debug("switch: Stream "+Ra(o)+" already active"),!1))))}function fa(e,t){var n=Ra(t);t.Wa?Y.debug(n,"clear: already clearing the buffer"):t.Sa?Y.debug(n,"clear: already waiting"):t.Na?(Y.debug(n,"clear: currently updating"),t.Sa=!0,t.lc=0):null==Sn(e.a.O,t.type)?(Y.debug(n,"clear: nothing buffered"),null==t.Ka&&Aa(e,t,0)):(Y.debug(n,"clear: handling right now"),Oa(t),xa(e,t,!1,0).catch((function(t){e.a&&e.a.onError(t)})))}function da(e,t,n,r,i){return y((function o(){var a,s,u,c,l,f,d;return L(o,(function(o){switch(o.j){case 1:return a=e.a.Za(),s=Ea(e,a),u=Ht,c=new Map,l=new Set,t&&(c.set(u.Nb,t),l.add(t)),n&&(c.set(u.Ua,n),l.add(n)),r&&(c.set(u.va,r),l.add(r)),f=e.a.O,d=e.g.forceTransmuxTS,k(o,f.init(c,d),2);case 2:return e.f?o.return():(function(e){var t=e.c.presentationTimeline.ca();1/0>t?e.a.O.Ba(t):e.a.O.Ba(Math.pow(2,32))}(e),k(o,ya(e,l),3));case 3:if(e.f)return o.return();c.forEach((function(t,n){if(!e.b.has(n)){var r=pa(t,s,i);e.b.set(n,r),Aa(e,r,0)}})),x(o)}}))}))}function pa(e,t,n){return{stream:e,type:e.type,Cb:null,Ha:null,Oa:null,vc:!0,ka:t,endOfStream:!1,Na:!1,Ka:null,Sa:!1,lc:0,Kc:!1,Wa:!1,yd:!1,Xb:!1,Bd:n||0,fb:null}}function ha(e,t){var n=e.h[t];if(n)return Y.debug("(all) Period "+t+" is being or has been set up"),n.promise;Y.debug("(all) setting up Period "+t),n={promise:new ye,Mb:!1},e.h[t]=n;for(var r=new Set,i=p(e.c.periods[t].variants),o=i.next();!o.done;o=i.next())(o=o.value).video&&r.add(o.video),o.video&&o.video.trickModeVideo&&r.add(o.video.trickModeVideo),o.audio&&r.add(o.audio);for(o=(i=p(e.c.periods[t].textStreams)).next();!o.done;o=i.next())r.add(o.value);return e.v=e.v.then(function(){if(!this.f)return ya(this,r)}.bind(e)).then(function(){this.f||(this.h[t].promise.resolve(),this.h[t].Mb=!0,Y.D("(all) setup Period "+t))}.bind(e)).catch(function(e){this.f||(this.h[t].promise.catch((function(){})),this.h[t].promise.reject(),delete this.h[t],Y.m("(all) failed to setup Period "+t),this.a.onError(e))}.bind(e)),n.promise}function ya(e,t){return y((function n(){var r,i,o,a,s,u,c;return L(n,(function(n){switch(n.j){case 1:r=[];for(var l=p(t),f=l.next();!f.done;f=l.next())i=f.value,(o=e.i.get(i.id))?(Y.debug("(all) Stream "+i.id+" is being or has been set up"),r.push(o.promise)):(Y.D("(all) setting up Stream "+i.id),e.i.set(i.id,{promise:new ye,Mb:!1}),r.push(i.createSegmentIndex()));return A(n,2),k(n,Promise.all(r),4);case 4:if(e.f)return n.return();M(n,3);break;case 2:if(a=I(n),e.f)return n.return();for(f=(n=p(t)).next();!f.done;f=n.next())s=f.value,e.i.get(s.id).promise.catch((function(){})),e.i.get(s.id).promise.reject(),e.i.delete(s.id);throw a;case 3:for(f=(l=p(t)).next();!f.done;f=l.next())u=f.value,(c=e.i.get(u.id)).Mb||(c.promise.resolve(),c.Mb=!0,Y.D("(all) setup Stream "+u.id));x(n)}}))}))}function ma(e,t){if(!e.f){var n=Ra(t);if(!t.Na&&null!=t.Ka&&!t.Wa)if(t.Ka=null,t.Sa)Y.debug(n,"skipping update and clearing the buffer"),xa(e,t,t.Kc,t.lc);else{try{var r=function(e,t){if(Sa(t))return kn(e.a.O,t.stream.originalId||""),null;var n=Ra(t),r=e.a.Za(),i=va(e,t,r);Y.J(n,"timeNeeded="+i);var o=Pa(e,t.stream),a=Ea(e,i),s=function(e,t,n){return"text"==t?null==(e=e.a).b||e.b<n?0:e.b-Math.max(n,e.a):Ut(e=En(e,t),n)}(e.a.O,t.type,r);Y.J(n,"update_:","presentationTime="+r,"bufferedAhead="+s);var u=Math.max(e.c.minBufferTime||0,e.g.rebufferingGoal,e.g.bufferingGoal)*e.l;if(i>=e.c.presentationTimeline.ca())return Y.debug(n,"buffered to end of presentation"),t.endOfStream=!0,"video"==t.type&&(i=e.b.get("text"))&&"application/cea-608"==i.stream.mimeType&&(i.endOfStream=!0),null;if(t.endOfStream=!1,t.ka=a,a!=o)return Y.debug(n,"need Period "+a,"presentationTime="+r,"timeNeeded="+i,"currentPeriodIndex="+o),null;if(s>=u)return Y.J(n,"buffering goal met"),.5;if(n=Tn(e.a.O,t.type),!(n=ga(e,t,r,n,o)))return 1;var c=1/0;return Array.from(e.b.values()).forEach((function(t){Sa(t)||(t=va(e,t,r),c=Math.min(c,t))})),i>=c+e.c.presentationTimeline.a?1:(t.Bd=0,function(e,t,n,r,i){var o=Ra(t),a=e.c.periods[r];Y.D(o,"fetchAndAppend_:","presentationTime="+n,"currentPeriod.startTime="+a.startTime,"reference.position="+i.position,"reference.startTime="+i.startTime,"reference.endTime="+i.endTime);var s=t.stream,u=e.c.presentationTimeline.ca(),c=e.c.periods[r+1];r=function(e,t,n,r,i){if(!t.vc)return Promise.resolve();var o=Ra(t);return n=e.c.periods[n].startTime-t.stream.presentationTimeOffset,Y.D(o,"setting timestamp offset to "+n),Y.D(o,"setting append window start to "+r),Y.D(o,"setting append window end to "+i),r=function(e,t,n,r,i){return"text"==t?(e.a.o=n,(e=e.a).f=r,e.h=i,Promise.resolve()):Promise.all([An(e,t,e.Oe.bind(e,t)),An(e,t,e.ug.bind(e,t,n)),An(e,t,e.rg.bind(e,t,r,i))])}(e.a.O,t.type,n,r,i),t.stream.initSegmentReference?(Y.D(o,"fetching init segment"),e=ka(e,t,t.stream.initSegmentReference).then(function(e){if(!this.f)return Y.D(o,"appending init segment"),Pn(this.a.O,t.type,e,null,null,t.stream.closedCaptions&&0<t.stream.closedCaptions.size)}.bind(e)).catch((function(e){return t.vc=!0,Promise.reject(e)})),Promise.all([r,e])):r}(e,t,r,Math.max(0,a.startTime-.1),c?c.startTime+.01:u),t.Na=!0,t.vc=!1,Y.J(o,"fetching segment"),u=ka(e,t,i),Promise.all([r,u]).then(function(e){if(!this.f&&!this.o)return function(e,t,n,r,i,o,a){var s=Ra(t),u=i.closedCaptions&&0<i.closedCaptions.size;return null!=i.emsgSchemeIdUris&&0<i.emsgSchemeIdUris.length&&(new Rr).ia("emsg",e.K.bind(e,r,o,i.emsgSchemeIdUris)).parse(a),function(e,t,n){var r=Ra(t);Y.J(r,"checking buffer length");var i=Math.max(e.g.bufferBehind,e.c.presentationTimeline.a),o=Sn(e.a.O,t.type);if(null==o)return Y.J(r,"buffer behind okay because nothing buffered:","presentationTime="+n,"bufferBehind="+i),Promise.resolve();var a=n-o,s=a-i;return 0>=s?(Y.J(r,"buffer behind okay:","presentationTime="+n,"bufferedBehind="+a,"bufferBehind="+i,"underflow="+-s),Promise.resolve()):(Y.D(r,"buffer behind too large:","presentationTime="+n,"bufferedBehind="+a,"bufferBehind="+i,"overflow="+s),e.a.O.remove(t.type,o,o+s).then(function(){this.f||Y.D(r,"evicted "+s+" seconds")}.bind(e)))}(e,t,n).then(function(){if(!this.f)return Y.D(s,"appending media segment"),Pn(this.a.O,t.type,a,o.startTime+r.startTime,o.endTime+r.startTime,u)}.bind(e)).then(function(){if(!this.f)return Y.J(s,"appended media segment"),t.Cb=i,t.Ha=o,Promise.resolve()}.bind(e))}(this,t,n,a,s,i,e[1])}.bind(e)).then(function(){this.f||this.o||(t.Na=!1,t.yd=!1,t.Sa||this.a.td(),Aa(this,t,0),function(e,t,n){if(!e.u){var r=Ra(t);if(1==(t=Array.from(e.b.values())).length&&"text"==t[0].type||(e.u=t.every((function(e){return"text"==e.type||!e.Sa&&!e.Wa&&e.Ha}))),e.u){for(Y.debug(r,"startup complete"),n=Pa(e,n),e.h[n]||ha(e,n).then(function(){this.f||(Y.D(r,"calling onCanSwitch()..."),this.a.ne())}.bind(e)).catch(Bt.wc),n=0;n<e.c.periods.length;++n)ha(e,n).catch(Bt.wc);e.a.Xf&&(Y.D(r,"calling onStartupComplete()..."),e.a.Xf())}}}(this,t,s),Y.D(o,"finished fetch and append"))}.bind(e)).catch(function(e){this.f||this.o||(t.Na=!1,"text"==t.type&&this.g.ignoreTextStreamFailures?(1001==e.code?Y.m(o,"Text stream failed to download. Proceeding without it."):Y.m(o,"Text stream failed to parse. Proceeding without it."),this.b.delete("text")):7001==e.code?(t.Na=!1,t.Ka=null,Aa(this,t,0)):3017==e.code?function(e,t,n){var r=Ra(t);if(Array.from(e.b.values()).some((function(e){return e!=t&&e.yd})))Y.debug(r,"MediaSource threw QuotaExceededError:","waiting for another stream to recover...");else{var i=Math.round(100*e.l);if(20<i)e.l-=.2;else{if(!(4<i))return Y.error(r,"MediaSource threw QuotaExceededError too many times"),t.Xb=!0,e.o=!0,void e.a.onError(n);e.l-=.04}Y.m(r,"MediaSource threw QuotaExceededError:","reducing buffering goals by "+(100-Math.round(100*e.l))+"%"),t.yd=!0}Aa(e,t,4)}(this,t,e):(Y.error(o,"failed fetch and append: code="+e.code),t.Xb=!0,e.severity=2,Ia(this,e)))}.bind(e))}(e,t,r,o,n),null)}(e,t);null!=r&&(Aa(e,t,r),t.Xb=!1)}catch(t){return void Ia(e,t)}r=Array.from(e.b.values()),function(e,t){var n=Ra(t),r=Pa(e,t.stream);if(t.ka!=r){var i=t.ka,o=Array.from(e.b.values());o.every((function(e){return e.ka==i||Sa(e)}))?o.every(Ta)?(Y.debug(n,"all need Period "+i),ha(e,i).then(function(){if(!this.f)if(o.every(function(e){var t=Ta(e),n=Pa(this,e.stream);return!!Sa(e)||t&&e.ka==i&&n!=i}.bind(this))){var e=this.c.periods[i];Y.D(n,"calling onChooseStreams()...");var t=this.a.oe(e),r=new Map;t.variant&&t.variant.video&&r.set("video",t.variant.video),t.variant&&t.variant.audio&&r.set("audio",t.variant.audio),t.text&&r.set("text",t.text);for(var a=(t=p(this.b.keys())).next();!a.done;a=t.next())if(a=a.value,!r.has(a)&&"text"!=a)return Y.error(n,"invalid Streams chosen: missing "+a+" Stream"),void this.a.onError(new he(2,5,5005));for(a=(t=p(Array.from(r.keys()))).next();!a.done;a=t.next())if(a=a.value,!this.b.has(a)){if("text"!=a)return Y.error(n,"invalid Streams chosen: unusable "+a+" Stream"),void this.a.onError(new he(2,5,5005));da(this,null,null,r.get("text"),e.startTime),r.delete(a)}for(a=(t=p(Array.from(this.b.keys()))).next();!a.done;a=t.next()){a=a.value;var s=this.b.get(a),u=r.get(a);if(u){var c=Sa(s);c&&(s.ka=i,s.Bd=e.startTime),la(this,u,!1,0,!1),c&&Sa(s)||Aa(this,this.b.get(a),0)}else this.b.delete(a)}Y.D(n,"calling onCanSwitch()..."),this.a.ne()}else Y.debug(n,"ignoring transition to Period",i,"since another is happening")}.bind(e)).catch(Bt.wc)):Y.debug(n,"all MediaStates need Period "+i+", but not all MediaStates are idle"):Y.debug(n,"not all MediaStates need Period "+i)}}(e,t),e.u&&r.every((function(e){return e.endOfStream}))&&(Y.D(n,"calling endOfStream()..."),e.a.O.endOfStream().then(function(){if(!this.f){var e=this.a.O.ca();0!=e&&e<this.c.presentationTimeline.ca()&&this.c.presentationTimeline.Ba(e)}}.bind(e)))}}}function va(e,t,n){return t.Cb&&t.Ha?(n=Pa(e,t.Cb),e.c.periods[n].startTime+t.Ha.endTime):Math.max(n,t.Bd)}function ga(e,t,n,r,i){var o=Ra(t);return t.Ha&&t.stream==t.Cb?(r=t.Ha.position+1,Y.J(o,"next position known:","position="+r),wa(e,t,i,r)):(t.Ha?(Y.D(o,"next position unknown: another Stream buffered"),o=Pa(e,t.Cb),o=ba(e,t,e.c.periods[o].startTime+t.Ha.endTime,i)):(Y.D(o,"next position unknown: nothing buffered"),o=ba(e,t,r||n,i)),null==o?null:(n=null,null==r&&(n=wa(e,t,i,Math.max(0,o-1))),n||wa(e,t,i,o)))}function ba(e,t,n,r){var i=Ra(t);return e=e.c.periods[r],Y.debug(i,"looking up segment:","presentationTime="+n,"currentPeriod.startTime="+e.startTime),n=Math.max(0,n-e.startTime),null==(t=t.stream.findSegmentPosition(n))&&Y.m(i,"cannot find segment:","currentPeriod.startTime="+e.startTime,"lookupTime="+n),t}function wa(e,t,n,r){var i=Ra(t);return n=e.c.periods[n],(t=t.stream.getSegmentReference(r))?(e=(r=e.c.presentationTimeline).Wb(),r=r.xb(),n.startTime+t.endTime<e||n.startTime+t.startTime>r?(Y.J(i,"segment is not available:","currentPeriod.startTime="+n.startTime,"reference.startTime="+t.startTime,"reference.endTime="+t.endTime,"availabilityStart="+e,"availabilityEnd="+r),null):t):(Y.D(i,"segment does not exist:","currentPeriod.startTime="+n.startTime,"position="+r),null)}function Sa(e){return e&&"text"==e.type&&"application/cea-608"==e.stream.mimeType}function Ta(e){return!e.Na&&null==e.Ka&&!e.Sa&&!e.Wa}function Ea(e,t){var n=jo(e.c.periods,t+1/15);return n?e.c.periods.indexOf(n):0}function Pa(e,t){for(var n=e.c.periods,r=0;r<n.length;r++){for(var i=n[r],o=new Set,a=p(i.variants),s=a.next();!s.done;s=a.next())(s=s.value).audio&&o.add(s.audio),s.video&&o.add(s.video),s.video&&s.video.trickModeVideo&&o.add(s.video.trickModeVideo);for(a=(i=p(i.textStreams)).next();!a.done;a=i.next())o.add(a.value);if(o.has(t))return r}return-1}function ka(e,t,n){var r=mi(n.c(),n.b,n.a,e.g.retryParameters);return Y.J("fetching: reference=",n),e=e.a.Db.request(1,r),t.fb=e,e.promise.then((function(e){return t.fb=null,e.data}))}function xa(e,t,n,r){return y((function i(){var o,a,s,u;return L(i,(function(i){switch(i.j){case 1:return o=Ra(t),t.Sa=!1,t.Kc=!1,t.lc=0,t.Wa=!0,Y.debug(o,"clearing buffer"),r?(s=e.a.Za(),u=e.a.O.ca(),a=e.a.O.remove(t.type,s+r,u)):a=xn(e.a.O,t.type).then(function(){if(!this.f&&n)return this.a.O.flush(t.type)}.bind(e)),k(i,a,2);case 2:if(e.f)return i.return();Y.debug(o,"cleared buffer"),t.Cb=null,t.Ha=null,t.Wa=!1,t.endOfStream=!1,Aa(e,t,0),x(i)}}))}))}function Aa(e,t,n){Y.J(Ra(t),"updating in "+n+" seconds"),t.Ka=new le((function(){return y((function n(){var r;return L(n,(function(n){switch(n.j){case 1:return A(n,2),k(n,ma(e,t),4);case 4:M(n,0);break;case 2:r=I(n),e.a&&e.a.onError(r),x(n)}}))}))})).T(n)}function Oa(e){null!=e.Ka&&(e.Ka.stop(),e.Ka=null)}function Ma(e){return y((function t(){return L(t,(function(t){switch(t.j){case 1:if(e.fb)return k(t,e.fb.abort(),0);t.C(0)}}))}))}function Ia(e,t){pe(e.H).then(function(){this.f||(this.a.onError(t),t.handled||this.g.failureCallback(t))}.bind(e))}function Ra(e){return"("+e.type+":"+e.stream.id+")"}function Ca(e,t,n,r,i,o){if(200<=n&&299>=n&&202!=n)return{uri:i||r,vd:r,data:t,headers:e,fromCache:!!e["x-shaka-from-cache"]};i=null;try{i=at(t)}catch(e){}throw Y.debug("HTTP error text:",i),new he(401==n||403==n?2:1,1,1001,r,n,i,e,o)}function Da(e,t,n,r){var i=new Da.b;qe(t.headers).forEach((function(e,t){i.append(t,e)}));var o=new Da.a,a={Ud:!1,Ge:!1};if(e=new me(e=Da.l(e,n,{body:t.body||void 0,headers:i,method:t.method,signal:o.signal,credentials:t.allowCrossSiteCredentials?"include":void 0},a,r),(function(){return a.Ud=!0,o.abort(),Promise.resolve()})),t=t.retryParameters.timeout){var s=new fe((function(){a.Ge=!0,o.abort()}));s.T(t/1e3),e.finally((function(){s.stop()}))}return e}function ja(e,t,n,r){var i=new ja.f,o=Date.now(),a=0;return new me(new Promise((function(s,u){for(var c in i.open(t.method,e,!0),i.responseType="arraybuffer",i.timeout=t.retryParameters.timeout,i.withCredentials=t.allowCrossSiteCredentials,i.onabort=function(){u(new he(1,1,7001,e,n))},i.onload=function(t){for(var r=(t=t.target).getAllResponseHeaders().trim().split("\r\n"),i={},o=(r=p(r)).next();!o.done;o=r.next())i[(o=o.value.split(": "))[0].toLowerCase()]=o.slice(1).join(": ");try{var a=Ca(i,t.response,t.status,e,t.responseURL,n);s(a)}catch(e){u(e)}},i.onerror=function(t){u(new he(1,1,1002,e,t,n))},i.ontimeout=function(){u(new he(1,1,1003,e,n))},i.onprogress=function(e){var t=Date.now();(100<t-o||e.lengthComputable&&e.loaded==e.total)&&(r(t-o,e.loaded-a,e.total-e.loaded),a=e.loaded,o=t)},t.headers)i.setRequestHeader(c.toLowerCase(),t.headers[c]);i.send(t.body)})),(function(){return i.abort(),Promise.resolve()}))}function Na(){this.a=this.f=this.b=0,this.c=new Map,this.g=0}function _a(e,t,n){this.h=e,this.b=new Map,this.c=!1,this.g=t,this.f=n,this.a=new Na}function La(e,t,n,r,i,o){var a=function(e,t){e.b+=t;var n=e.g;return e.g++,e.c.set(n,t),n}(e.a,r);r=e.b.get(t)||Promise.resolve(),e.b.set(t,r.then((function(){return y((function t(){var r,s,u,c,l,f;return L(t,(function(t){switch(t.j){case 1:return k(t,function(e,t){return y((function n(){var r;return L(n,(function(n){switch(n.j){case 1:return k(n,e.h.request(1,t).promise,2);case 2:return r=n.s,n.return(r.data)}}))}))}(e,n),2);case 2:if(r=t.s,e.c)throw new he(2,9,7001);if(i)for(var d in s=new Uint8Array(r),(u=new Lr(s)).data)c=Number(d),l=u.data[c],f=u.a[c],e.f(l,f);return e.a.close(a,r.byteLength),d=e.a,e.g(0==d.b?0:d.f/d.b,e.a.a),t.return(o(r))}}))}))})))}function Ua(e,t){var n=this;this.c=e,this.b=e.objectStore(t),this.a=new ye,e.onabort=function(e){e.preventDefault(),n.a.reject()},e.onerror=function(e){e.preventDefault(),n.a.reject()},e.oncomplete=function(){n.a.resolve()}}function Ka(e,t){return new Promise((function(n,r){var i=e.b.openCursor();i.onerror=r,i.onsuccess=function(e){if(!(e=e.target.result))return n();t(e.key,e.value,e),e.continue()}}))}function Ba(e){this.b=e,this.a=[]}function Va(e,t){return Fa(e,t,"readwrite")}function Fa(e,t,n){var r=new Ua(n=e.b.transaction([t],n),t);return e.a.push(r),r.promise().then((function(){Ae(e.a,r)}),(function(){Ae(e.a,r)})),r}function Ha(e,t,n){this.b=new Ba(e),this.c=t,this.a=n}function za(e){return Promise.reject(new he(2,9,9011,"Cannot add new value to "+e))}function qa(e,t,n,r){t=(e=Va(e.b,t)).store();for(var i={},o=(n=p(n)).next();!o.done;i={key:i.key},o=n.next())i.key=o.value,t.delete(i.key).onsuccess=function(e){return function(){return r(e.key)}}(i);return e.promise()}function Ga(e,t,n){return y((function r(){var i,o,a,s,u,c,l;return L(r,(function(r){switch(r.j){case 1:for(i=Fa(e.b,t,"readonly"),o=i.store(),a={},s=[],u={},c=p(n),l=c.next();!l.done;u={request:u.request,key:u.key},l=c.next())u.key=l.value,u.request=o.get(u.key),u.request.onsuccess=function(e){return function(){null==e.request.result&&s.push(e.key),a[e.key]=e.request.result}}(u);return k(r,i.promise(),2);case 2:if(s.length)throw new he(2,9,9012,"Could not find values for "+s);return r.return(n.map((function(e){return a[e]})))}}))}))}function Wa(e){this.a=new Ba(e)}function Xa(){this.a=new Map}function Ya(e,t,n){if(!(e=e.a.get(t)))throw new he(2,9,9013,"Could not find mechanism with name "+t);if(!(t=e.getCells().get(n)))throw new he(2,9,9013,"Could not find cell with name "+n);return t}function $a(e,t){Ja.set(e,t)}ra.prototype.destroy=function(){var e=this;return y((function t(){var n,r;return L(t,(function(t){switch(t.j){case 1:n=[];for(var i=p(e.b.values()),o=i.next();!o.done;o=i.next())Oa(r=o.value),n.push(Ma(r));return k(t,Promise.all(n),2);case 2:e.b.clear(),e.i.clear(),e.a=null,e.c=null,e.v=null,e.h=null,e.g=null,e.f=!0,x(t)}}))}))},ra.prototype.configure=function(e){this.g=e,this.H=new de({maxAttempts:Math.max(e.retryParameters.maxAttempts,2),baseDelay:e.retryParameters.baseDelay,backoffFactor:e.retryParameters.backoffFactor,fuzzFactor:e.retryParameters.fuzzFactor,timeout:0},!0)},ra.prototype.start=function(){var e=this;return y((function t(){var n,r,i;return L(t,(function(t){switch(t.j){case 1:return n=e.a.Za(),r=Ea(e,n),(i=e.a.oe(e.c.periods[r])).variant||i.text?k(t,da(e,i.variant?i.variant.audio:null,i.variant?i.variant.video:null,i.text,n),2):(Y.error("init: no Streams chosen"),t.return(new he(2,5,5005)));case 2:if(e.f)return t.return();Y.debug("init: completed initial Stream setup"),e.a&&e.a.Of&&(Y.D("init: calling onInitialStreamsSetup()..."),e.a.Of()),x(t)}}))}))},ra.prototype.K=function(e,t,n,r){var i=r.reader.wd(),o=r.reader.wd(),a=r.reader.I(),s=r.reader.I(),u=r.reader.I(),c=r.reader.I();r=r.reader.gb(r.reader.N.byteLength-r.reader.ga()),e=e.startTime+t.startTime+s/a,n.includes(i)&&("urn:mpeg:dash:event:2012"==i?this.a.Pf():this.a.onEvent(new Te("emsg",{detail:{startTime:e,endTime:e+u/a,schemeIdUri:i,value:o,timescale:a,presentationTimeDelta:s,eventDuration:u,id:c,messageData:r}})))},H("shaka.net.HttpFetchPlugin",Da),Da.l=function(e,t,n,r,i){return y((function o(){var a,s,u,c,l,f,d,p,h,m,v,g;return L(o,(function(o){switch(o.j){case 1:return a=Da.g,s=Da.c,f=l=0,d=Date.now(),A(o,2),k(o,a(e,n),4);case 4:return u=o.s,p=u.clone().body.getReader(),m=(h=u.headers.get("Content-Length"))?parseInt(h,10):0,new s({start:function(e){!function t(){return y((function n(){var r,o,a;return L(n,(function(n){switch(n.j){case 1:return A(n,2),k(n,p.read(),4);case 4:r=n.s,M(n,3);break;case 2:return o=I(n),Y.D("error reading from stream",o.message),n.return();case 3:r.done||(l+=r.value.byteLength),(100<(a=Date.now())-d||r.done)&&(i(a-d,l-f,m-l),f=l,d=a),r.done?e.close():(e.enqueue(r.value),t()),x(n)}}))}))}()}}),k(o,u.arrayBuffer(),5);case 5:c=o.s,M(o,3);break;case 2:if(v=I(o),r.Ud)throw new he(1,1,7001,e,t);if(r.Ge)throw new he(1,1,1003,e,t);throw new he(1,1,1002,e,v,t);case 3:return g={},u.headers.forEach((function(e,t){g[t.trim()]=e})),o.return(Ca(g,c,u.status,e,u.url,t))}}))}))},Da.isSupported=function(){if(!e.ReadableStream)return!1;try{new ReadableStream({})}catch(e){return!1}return!(!e.fetch||!e.AbortController)},Da.isSupported=Da.isSupported,Da.g=e.fetch,Da.a=e.AbortController,Da.c=e.ReadableStream,Da.b=e.Headers,Da.isSupported()&&(De("http",Da,2),De("https",Da,2)),H("shaka.net.HttpXHRPlugin",ja),ja.f=e.XMLHttpRequest,De("http",ja,1),De("https",ja,1),Na.prototype.close=function(e,t){if(this.c.has(e)){var n=this.c.get(e);this.c.delete(e),this.f+=n,this.a+=t}},_a.prototype.destroy=function(){return this.c=!0,Promise.all(this.b.values()).then((function(){}),(function(){}))},Ua.prototype.abort=function(){try{this.c.abort()}catch(e){}return this.a.catch((function(){}))},Ua.prototype.store=function(){return this.b},Ua.prototype.promise=function(){return this.a},Ba.prototype.destroy=function(){return Promise.all(this.a.map((function(e){return e.abort()})))},(i=Ha.prototype).destroy=function(){return this.b.destroy()},i.hasFixedKeySpace=function(){return!0},i.addSegments=function(){return za(this.c)},i.removeSegments=function(e,t){return qa(this,this.c,e,t)},i.getSegments=function(e){var t=this;return y((function n(){var r;return L(n,(function(n){switch(n.j){case 1:return k(n,Ga(t,t.c,e),2);case 2:return r=n.s,n.return(r.map((function(e){return t.Wd(e)})))}}))}))},i.addManifests=function(){return za(this.a)},i.updateManifestExpiration=function(e,t){var n=Va(this.b,this.a),r=n.store();return r.get(e).onsuccess=function(n){(n=n.target.result)&&(n.expiration=t,r.put(n,e))},n.promise()},i.removeManifests=function(e,t){return qa(this,this.a,e,t)},i.getManifests=function(e){var t=this;return y((function n(){var r;return L(n,(function(n){switch(n.j){case 1:return k(n,Ga(t,t.a,e),2);case 2:return r=n.s,n.return(r.map((function(e){return t.mc(e)})))}}))}))},i.getAllManifests=function(){var e=this;return y((function t(){var n,r;return L(t,(function(t){switch(t.j){case 1:return n=Fa(e.b,e.a,"readonly"),r=new Map,k(t,Ka(n,(function(t,n){r.set(t,e.mc(n))})),2);case 2:return k(t,n.promise(),3);case 3:return t.return(r)}}))}))},i.Wd=function(e){return e},i.mc=function(e){return e},i.add=function(e,t){var n=this;return y((function r(){var i,o,a,s;return L(r,(function(r){switch(r.j){case 1:i=Va(n.b,e),o=i.store(),a=[];for(var u=p(t),c=u.next();!c.done;c=u.next())s=c.value,o.add(s).onsuccess=function(e){a.push(e.target.result)};return k(r,i.promise(),2);case 2:return r.return(a)}}))}))},Wa.prototype.destroy=function(){return this.a.destroy()},Wa.prototype.getAll=function(){var e=this;return y((function t(){var n,r;return L(t,(function(t){switch(t.j){case 1:return n=Fa(e.a,"session-ids","readonly"),r=[],k(t,Ka(n,(function(e,t){r.push(t)})),2);case 2:return k(t,n.promise(),3);case 3:return t.return(r)}}))}))},Wa.prototype.add=function(e){for(var t=Va(this.a,"session-ids"),n=t.store(),r=(e=p(e)).next();!r.done;r=e.next())n.add(r.value);return t.promise()},Wa.prototype.remove=function(e){var t=this;return y((function n(){var r;return L(n,(function(n){switch(n.j){case 1:return k(n,Ka(r=Va(t.a,"session-ids"),(function(t,n,r){0<=e.indexOf(n.sessionId)&&r.delete()})),2);case 2:return k(n,r.promise(),0)}}))}))},Xa.prototype.destroy=function(){for(var e=[],t=p(this.a.values()),n=t.next();!n.done;n=t.next())e.push(n.value.destroy());return this.a.clear(),Promise.all(e)},Xa.prototype.init=function(){var e=this;Ja.forEach((function(t,n){var r=t();r?e.a.set(n,r):Y.info("Skipping "+n+" as it is not supported on this platform")}));for(var t=[],n=p(this.a.values()),r=n.next();!r.done;r=n.next())t.push(r.value.init());return Promise.all(t)},Xa.prototype.erase=function(){var e=this;return y((function t(){var n,r;return L(t,(function(t){switch(t.j){case 1:return n=Array.from(e.a.values()),(r=0<n.length)||Ja.forEach((function(e){(e=e())&&n.push(e)})),k(t,Promise.all(n.map((function(e){return e.erase()}))),2);case 2:if(!r)return k(t,Promise.all(n.map((function(e){return e.destroy()}))),0);t.C(0)}}))}))},H("shaka.offline.StorageMuxer.register",$a),H("shaka.offline.StorageMuxer.unregister",(function(e){Ja.delete(e)}));var Ja=new Map;function Qa(e){Ha.apply(this,arguments)}function Za(e){return function(e){var t=e.streams.filter((function(e){return"audio"==e.contentType})),n=e.streams.filter((function(e){return"video"==e.contentType}));if(!t.every((function(e){return e.variantIds}))||!n.every((function(e){return e.variantIds}))){t.forEach((function(e){e.variantIds=[]})),n.forEach((function(e){e.variantIds=[]}));var r=0;if(n.length&&!t.length){Y.debug("Found video-only content. Creating variants for video.");var i=r++;n.forEach((function(e){e.variantIds.push(i)}))}if(!n.length&&t.length){Y.debug("Found audio-only content. Creating variants for audio.");var o=r++;t.forEach((function(e){e.variantIds.push(o)}))}n.length&&t.length&&(Y.debug("Found audio-video content. Creating variants."),t.forEach((function(e){n.forEach((function(t){var n=r++;e.variantIds.push(n),t.variantIds.push(n)}))})))}}(e),e.streams.forEach((function(){})),{startTime:e.startTime,streams:e.streams.map(es)}}function es(e){var t=e.initSegmentUri?ns(e.initSegmentUri):null;return{id:e.id,originalId:null,primary:e.primary,presentationTimeOffset:e.presentationTimeOffset,contentType:e.contentType,mimeType:e.mimeType,codecs:e.codecs,frameRate:e.frameRate,pixelAspectRatio:void 0,kind:e.kind,language:e.language,label:e.label,width:e.width,height:e.height,initSegmentKey:t,encrypted:e.encrypted,keyId:e.keyId,segments:e.segments.map(ts),variantIds:e.variantIds}}function ts(e){var t=ns(e.uri);return{startTime:e.startTime,endTime:e.endTime,dataKey:t}}function ns(e){var t;if((t=/^offline:[0-9]+\/[0-9]+\/([0-9]+)$/.exec(e))||(t=/^offline:segment\/([0-9]+)$/.exec(e)))return Number(t[1]);throw new he(2,9,9004,"Could not parse uri "+e)}function rs(e,t,n,r){Ha.call(this,e,t,n),this.f=r}function is(){this.g=this.c=this.b=this.a=this.f=null}function os(e,t,n,r){this.a=e,this.g=t,this.f=n,this.c=r,this.b=["offline:",e,"/",t,"/",n,"/",r].join("")}function as(e){if(null==(e=/^offline:([a-z]+)\/([^/]+)\/([^/]+)\/([0-9]+)$/.exec(e)))return null;var t=e[1];if("manifest"!=t&&"segment"!=t)return null;var n=e[2];if(!n)return null;var r=e[3];return r&&null!=t?new os(t,n,r,Number(e[4])):null}function ss(e,t){this.b=e,this.a=t}function us(e,t,n){var r=t.streams.filter((function(e){return"audio"==e.contentType})),i=t.streams.filter((function(e){return"video"==e.contentType}));return r=function(e,t,n){for(var r=new Set,i=p(t),o=i.next();!o.done;o=i.next()){var a=p(o.value.variantIds);for(o=a.next();!o.done;o=a.next())r.add(o.value)}for(i=p(n),o=i.next();!o.done;o=i.next())for(a=p(o.value.variantIds),o=a.next();!o.done;o=a.next())r.add(o.value);for(i=new Map,r=p(r),o=r.next();!o.done;o=r.next())o=o.value,i.set(o,{id:o,language:"",primary:!1,audio:null,video:null,bandwidth:0,drmInfos:[],allowedByApplication:!0,allowedByKeySystem:!0});for(t=p(t),r=t.next();!r.done;r=t.next())for(r=r.value,o=cs(e,r),a=p(r.variantIds),r=a.next();!r.done;r=a.next())(r=i.get(r.value)).language=o.language,r.primary=r.primary||o.primary,r.audio=o;for(n=p(n),t=n.next();!t.done;t=n.next())for(r=t.value,t=cs(e,r),o=p(r.variantIds),r=o.next();!r.done;r=o.next())(r=i.get(r.value)).primary=r.primary||t.primary,r.video=t;return i}(e,r,i),i=t.streams.filter((function(e){return"text"==e.contentType})).map((function(t){return cs(e,t)})),t.streams.forEach((function(r){r=r.segments.map((function(t,n){return ls(e,n,t)})),n.Eb(r,t.startTime)})),{startTime:t.startTime,variants:Array.from(r.values()),textStreams:i}}function cs(e,t){var n=t.segments.map((function(t,n){return ls(e,n,t)})),r=new Qr(n);return n={id:t.id,originalId:t.originalId,createSegmentIndex:function(){return Promise.resolve()},findSegmentPosition:function(e){return r.find(e)},getSegmentReference:function(e){return r.get(e)},initSegmentReference:null,presentationTimeOffset:t.presentationTimeOffset,mimeType:t.mimeType,codecs:t.codecs,width:t.width||void 0,height:t.height||void 0,frameRate:t.frameRate||void 0,pixelAspectRatio:t.pixelAspectRatio||void 0,kind:t.kind,encrypted:t.encrypted,keyId:t.keyId,language:t.language,label:t.label||null,type:t.contentType,primary:t.primary,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],channelsCount:null,audioSamplingRate:null,closedCaptions:null},null!=t.initSegmentKey&&(n.initSegmentReference=function(e,t){var n=new os("segment",e.b,e.a,t);return new Yr((function(){return[n.toString()]}),0,null)}(e,t.initSegmentKey)),n}function ls(e,t,n){var r=new os("segment",e.b,e.a,n.dataKey);return new $r(t,n.startTime,n.endTime,(function(){return[r.toString()]}),0,null)}function fs(){this.a=null}function ds(e){var t=as(e);return t&&"manifest"==t.a?ds.h(e):t&&"segment"==t.a?ds.i(t.key(),t):ve(new he(2,1,9004,e))}function ps(e,t,n){return y((function r(){var i,o,a,s,u,c;return L(r,(function(r){switch(r.j){case 1:i=[];for(var l=[],f=p(n),d=f.next();!d.done;d=f.next()){d=d.value;for(var h=!1,m=p(l),v=m.next();!v.done;v=m.next())if(hs((v=v.value).info,d)){v.sessionIds.push(d.sessionId),h=!0;break}h||l.push({info:d,sessionIds:[d.sessionId]})}o=p(l),a=o.next();case 2:if(a.done){r.C(4);break}return s=a.value,u=function(e,t,n){return y((function r(){var i,o,a,s;return L(r,(function(r){switch(r.j){case 1:return i=new dt({Db:t,onError:function(){},yc:function(){},onExpirationUpdated:function(){},onEvent:function(){}}),A(r,2),i.configure(e),k(r,function(e,t,n,r,i,o){var a=new Map;return a.set(t,{audioCapabilities:i,videoCapabilities:o,distinctiveIdentifier:"optional",persistentState:"required",sessionTypes:["persistent-license"],label:t,drmInfos:[{keySystem:t,licenseServerUri:n,distinctiveIdentifierRequired:!1,persistentStateRequired:!0,audioRobustness:"",videoRobustness:"",serverCertificate:r,initData:null,keyIds:null}]}),St(e,a)}(i,n.info.keySystem,n.info.licenseUri,n.info.serverCertificate,n.info.audioCapabilities,n.info.videoCapabilities),4);case 4:M(r,3);break;case 2:return o=I(r),Y.m("Error initializing EME",o),k(r,i.destroy(),5);case 5:return r.return([]);case 3:return A(r,6),k(r,yt(i),8);case 8:M(r,7);break;case 6:return a=I(r),Y.m("Error setting server certificate",a),k(r,i.destroy(),9);case 9:return r.return([]);case 7:return s=[],k(r,Promise.all(n.sessionIds.map((function(e){return y((function t(){var n;return L(t,(function(t){switch(t.j){case 1:return A(t,2),k(t,function(e,t){return y((function n(){var r,i,o;return L(n,(function(n){switch(n.j){case 1:return k(n,Tt(e,t),2);case 2:return(r=n.s)?(i=[],(o=e.b.get(r))&&(o.Ca=new ye,i.push(o.Ca)),Y.J("Attempting to remove session",t),i.push(r.remove()),k(n,Promise.all(i),0)):(Y.J("Ignoring attempt to remove missing session",t),n.return())}}))}))}(i,e),4);case 4:s.push(e),M(t,0);break;case 2:n=I(t),Y.m("Error deleting offline session",n),x(t)}}))}))}))),10);case 10:return k(r,i.destroy(),11);case 11:return r.return(s)}}))}))}(e,t,s),k(r,u,5);case 5:c=r.s,i=i.concat(c),a=o.next(),r.C(2);break;case 4:return r.return(i)}}))}))}function hs(e,t){function n(e,t){return e.robustness==t.robustness&&e.contentType==t.contentType}return e.keySystem==t.keySystem&&e.licenseUri==t.licenseUri&&Oe(e.audioCapabilities,t.audioCapabilities,n)&&Oe(e.videoCapabilities,t.videoCapabilities,n)}function ys(e,t){var n={Ea:null,w:null,mimeType:null,startTime:null,Ld:null,uri:null},r=this;this.h=t,this.c=e,this.f=n,this.i=null,this.g=[],this.b=this.a=null,this.l=!0,this.o=Promise.resolve().then((function(){return function(e){return y((function t(){return L(t,(function(t){switch(t.j){case 1:if(e.l){if(0==e.g.length||e.a&&!e.a.$a)var n=!1;else{e.a&&(e.a.za.eb(),e.a=null);var r=(n=e.g.shift()).create(e.f);r?(n.za.Fb(),e.a={node:r.node,payload:r.payload,$a:r.$a,za:n.za}):n.za.zc(),n=!0}return n?n=Promise.resolve():e.a?n=function(e){return y((function t(){var n,r;return L(t,(function(t){switch(t.j){case 1:return e.c=e.h.rf(e.c,e.f,e.a.node,e.a.payload),A(t,2),e.b=e.h.Ye(e.c,e.f,e.a.payload),k(t,e.b.promise,4);case 4:e.b=null,e.c==e.a.node&&(e.a.za.xc(),e.a=null),M(t,0);break;case 2:return 7001==(n=I(t)).code?e.a.za.eb():e.a.za.onError(n),e.a=null,e.b=null,r=e,k(t,e.h.handleError(e.f,n),5);case 5:r.c=t.s,x(t)}}))}))}(e):(e.h.Nf(e.c),e.i=new ye,n=e.i),k(t,n,1)}t.C(0)}}))}))}(r)}))}function ms(e,t){var n={Fb:function(){},xc:function(){},eb:function(){},onError:function(){},zc:function(){},Sg:function(){}};return e.g.push({create:t,za:n}),e.b&&e.b.abort(),vs(e),n}function vs(e){e.i&&(e.i.resolve(),e.i=null)}function gs(e){this.a=null;for(var t=0;t<e.textTracks.length;++t){var n=e.textTracks[t];n.mode="disabled","Shaka Player TextTrack"==n.label&&(this.a=n)}this.a||(this.a=e.addTextTrack("subtitles","Shaka Player TextTrack")),this.a.mode="hidden"}function bs(e){if(e.startTime>=e.endTime)return Y.m("Invalid cue times: "+e.startTime+" - "+e.endTime),null;var t=new VTTCue(e.startTime,e.endTime,e.payload);t.lineAlign=e.lineAlign,t.positionAlign=e.positionAlign,e.size&&(t.size=e.size);try{t.align=e.textAlign}catch(e){}return"center"==e.textAlign&&"center"!=t.align&&(t.align="middle"),"vertical-lr"==e.writingMode?t.vertical="lr":"vertical-rl"==e.writingMode&&(t.vertical="rl"),1==e.lineInterpretation&&(t.snapToLines=!1),null!=e.line&&(t.line=e.line),null!=e.position&&(t.position=e.position),t}function ws(e,t){var n=e.mode;e.mode="showing"==n?"showing":"hidden";for(var r=e.cues,i=r.length-1;0<=i;i--){var o=r[i];o&&t(o)&&e.removeCue(o)}e.mode=n}function Ss(e,t,r,i,o){var a,s=o in i,u=!0;for(a in t){var c=o+"."+a,l=s?i[o]:r[a];s||a in r?void 0===t[a]?void 0===l||s?delete e[a]:e[a]=ke(l):l.constructor==Object&&t[a]&&t[a].constructor==Object?(e[a]||(e[a]=ke(l)),c=Ss(e[a],t[a],l,i,c),u=u&&c):n(t[a])!=n(l)||null==t[a]||"function"!=typeof t[a]&&t[a].constructor!=l.constructor?(Y.jc("Invalid config, wrong type for "+c),u=!1):("function"==typeof r[a]&&r[a].length!=t[a].length&&Y.Z("Unexpected number of arguments for "+c),e[a]=t[a]):(Y.jc("Invalid config, unrecognized key "+c),u=!1)}return u}function Ts(e,t){for(var n={},r=n,i=0,o=0;!(0>(i=e.indexOf(".",i)));)0!=i&&"\\"==e[i-1]||(r[o=e.substring(o,i).replace(/\\\./g,".")]={},r=r[o],o=i+1),i+=1;return r[e.substring(o).replace(/\\\./g,".")]=t,n}function Es(){}function Ps(){var e=5e5,t=1/0;navigator.connection&&(e=1e6*navigator.connection.downlink,navigator.connection.saveData&&(t=360));var n={retryParameters:{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:0},servers:{},clearKeys:{},advanced:{},delayLicenseRequestUntilPlayed:!1,initDataTransform:Pt,fairPlayTransform:!0,updateExpirationTime:1},r={retryParameters:{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:0},availabilityWindowOverride:NaN,disableAudio:!1,disableVideo:!1,disableText:!1,dash:{customScheme:function(e){if(e)return null},clockSyncUri:"",ignoreDrmInfo:!1,xlinkFailGracefully:!1,defaultPresentationDelay:10,ignoreMinBufferTime:!1,autoCorrectDrift:!0,ignoreSuggestedPresentationDelay:!1,ignoreEmptyAdaptationSet:!1},hls:{ignoreTextStreamFailures:!1,useFullSegmentsForStartTime:!1}},i={retryParameters:{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:0},failureCallback:function(e){return Y.error("Unhandled streaming error",e),[e]},rebufferingGoal:2,bufferingGoal:10,bufferBehind:30,ignoreTextStreamFailures:!1,alwaysStreamText:!1,startAtSegmentBoundary:!1,smallGapLimit:.5,jumpLargeGaps:!1,durationBackoff:1,forceTransmuxTS:!1,safeSeekOffset:5,stallEnabled:!0,stallThreshold:1,stallSkip:.1,useNativeHlsOnSafari:!0};et("Web0S")&&(i.stallEnabled=!1);var o={trackSelectionCallback:function(e){return y((function t(){return L(t,(function(t){switch(t.j){case 1:return t.return(e)}}))}))},progressCallback:function(e,t){return[e,t]},usePersistentLicense:!0},a={drm:n,manifest:r,streaming:i,offline:o,abrFactory:Ln,abr:{enabled:!0,defaultBandwidthEstimate:e,switchInterval:8,bandwidthUpgradeTarget:.85,bandwidthDowngradeTarget:.95,restrictions:{minWidth:0,maxWidth:1/0,minHeight:0,maxHeight:t,minPixels:0,maxPixels:1/0,minFrameRate:0,maxFrameRate:1/0,minBandwidth:0,maxBandwidth:1/0}},preferredAudioLanguage:"",preferredTextLanguage:"",preferredVariantRole:"",preferredTextRole:"",preferredAudioChannelCount:2,restrictions:{minWidth:0,maxWidth:1/0,minHeight:0,maxHeight:1/0,minPixels:0,maxPixels:1/0,minFrameRate:0,maxFrameRate:1/0,minBandwidth:0,maxBandwidth:1/0},playRangeStart:0,playRangeEnd:1/0,textDisplayFactory:function(){return null}};return o.trackSelectionCallback=function(e){return y((function t(){return L(t,(function(t){switch(t.j){case 1:return t.return(function(e,t){var n=e.filter((function(e){return"variant"==e.type})),r=[],i=jn(t,n.map((function(e){return e.language})));i&&(r=n.filter((function(e){return Cn(e.language)==i}))),0==r.length&&(r=n.filter((function(e){return e.primary}))),0==r.length&&(1<new Set(n.map((function(e){return e.language}))).size&&Y.m("Could not choose a good audio track based on language preferences or primary tracks.  An arbitrary language will be stored!"),r=n);var o=r.filter((function(e){return e.height&&480>=e.height}));if(o.length&&(o.sort((function(e,t){return t.height-e.height})),r=o.filter((function(e){return e.height==o[0].height}))),n=[],r.length){var a=Math.floor(r.length/2);r.sort((function(e,t){return e.bandwidth-t.bandwidth})),n.push(r[a])}for(r=p(e),a=r.next();!a.done;a=r.next())"text"==(a=a.value).type&&n.push(a);return n}(e,a.preferredAudioLanguage))}}))}))},a}function ks(e,t,n){var r={".drm.servers":"",".drm.clearKeys":"",".drm.advanced":{distinctiveIdentifierRequired:!1,persistentStateRequired:!1,videoRobustness:"",audioRobustness:"",serverCertificate:new Uint8Array(0),individualizationServer:""}};return Ss(e,t,n||Ps(),r,"")}function xs(){this.a=null,this.b=[]}function As(e,t){if(null==e.a)e.a={timestamp:Date.now()/1e3,state:t,duration:0};else{var n=Date.now()/1e3;e.a.duration=n-e.a.timestamp,e.a.state!=t&&(e.b.push(e.a),e.a={timestamp:n,state:t,duration:0})}}function Os(e,t){var n=0;e.a&&e.a.state==t&&(n+=e.a.duration);for(var r=p(e.b),i=r.next();!i.done;i=r.next())n+=(i=i.value).state==t?i.duration:0;return n}function Ms(){this.b=this.c=null,this.a=[]}function Is(){this.f=this.u=this.h=this.b=this.i=this.l=this.o=this.g=this.v=NaN,this.a=new xs,this.c=new Ms}function Rs(t,n){var r=this;Pe.call(this),this.i=wu,this.a=null,this.ob=!1,this.g=new Ue,this.Lc=this.l=this.Ob=this.c=this.u=this.f=this.ec=this.F=this.fc=this.H=this.qb=this.o=this.G=this.h=this.S=null,this.ke=1e9,this.hc=new Set,this.sb=!0,this.sa=null,this.je=!1,this.ge=0,this.ra=null,this.ea=new fo,this.b=Hs(this),this.ic={width:1/0,height:1/0},this.v=null,this.Pb=new So(this.b.preferredAudioLanguage,this.b.preferredVariantRole,this.b.preferredAudioChannelCount),this.qa=this.b.preferredTextLanguage,this.nb=this.b.preferredTextRole,this.Mc=[],n&&n(this),this.S=function(e){return new Re((function(t,n){e.l&&e.l.segmentDownloaded(t,n)}))}(this),this.g.B(e,"online",(function(){r.Cd()})),this.K={name:"detach"},this.V={name:"attach"},this.La={name:"unload"},this.Zc={name:"manifest-parser"},this.Uc={name:"manifest"},this.pb={name:"media-source"},this.Nc={name:"drm-engine"},this.$={name:"load"},this.dd={name:"src-equals-drm-engine"},this.rb={name:"src-equals"};var i=new Map;i.set(this.V,(function(e,t){return we(function(e,t,n){return null==t.w&&(t.w=n.w,e.g.B(t.w,"error",(function(){var t=au(e);t&&e.Qa(t)}))),e.a=t.w,Promise.resolve()}(r,e,t))})),i.set(this.K,(function(e){return e.w&&(r.g.pa(e.w,"error"),e.w=null),r.a=null,we(e=Promise.resolve())})),i.set(this.La,(function(e){return we(Ns(r,e))})),i.set(this.pb,(function(t){return we(t=function(t,n){return y((function r(){var i,o,a,s;return L(r,(function(r){switch(r.j){case 1:return i=e.muxjs?new jt:new Nt,o=t.b.textDisplayFactory,a=new o,t.Rc=o,k(r,(s=new mn(n.w,i,a)).u,2);case 2:t.G=s,x(r)}}))}))}(r,t))})),i.set(this.Zc,(function(e,t){return we(function(e,t,n){return y((function r(){var i,o,a,s;return L(r,(function(r){switch(r.j){case 1:if(t.Ea=n.Ea,t.mimeType=n.mimeType,t.uri=n.uri,i=t.uri,o=e.S,e.Ob=i,t.Ea){e.u=t.Ea(),r.C(2);break}return a=e,k(r,hi.create(i,o,e.b.manifest.retryParameters,t.mimeType),3);case 3:a.u=r.s;case 2:s=ke(e.b.manifest),n.w&&"AUDIO"===n.w.nodeName&&(s.disableVideo=!0),e.u.configure(s),x(r)}}))}))}(r,e,t))})),i.set(this.Uc,(function(e){return function(e,t){var n=t.uri,r=e.S;e.ec=new Qo,function(e,t){e.b=t}(e.ec,(function(t){ou(e,"timelineregionadded",t)}));var i={networkingEngine:r,filterNewPeriod:function(t){return e.Vc(t)},filterAllPeriods:function(t){return zs(e,t)},onTimelineRegionAdded:function(t){var n=e.ec;e:{for(var r=p(n.a),i=r.next();!i.done;i=r.next())if((i=i.value).schemeIdUri==t.schemeIdUri&&i.id==t.id&&i.startTime==t.startTime&&i.endTime==t.endTime){r=i;break e}r=null}null==r&&(n.a.add(t),n.b(t))},onEvent:function(t){return e.dispatchEvent(t)},onError:function(t){return e.Qa(t)}};return new me(Promise.resolve().then((function(){return y((function t(){var r;return L(t,(function(t){switch(t.j){case 1:return r=e,k(t,e.u.start(n,i),2);case 2:if(r.c=t.s,e.dispatchEvent(new Te("manifestparsed")),0==e.c.periods.length)throw new he(2,4,4014);!function(e){function t(e){return e.video&&e.audio||e.video&&e.video.codecs.includes(",")}e.some((function(e){return e.variants.some(t)}))&&(Y.debug("Found variant with audio and video content, so filtering out audio-only content in all periods."),e.forEach((function(e){e.variants=e.variants.filter(t)})))}(e.c.periods),x(t)}}))}))})),(function(){return Y.info("Aborting parser step..."),e.u.stop()}))}(r,e)})),i.set(this.Nc,(function(){return we(function(e){return y((function t(){return L(t,(function(t){switch(t.j){case 1:return e.h=_s(e,{Db:e.S,onError:function(t){e.Qa(t)},yc:function(t){su(e,t)},onExpirationUpdated:function(t,n){uu(e,t,n)},onEvent:function(t){e.dispatchEvent(t)}}),e.h.configure(e.b.drm),k(t,pt(e.h,Do(e.c.periods),e.c.offlineSessionIds),2);case 2:zs(e,e.c.periods),x(t)}}))}))}(r))})),i.set(this.$,(function(e,t){return we(function(e,t,n){return y((function r(){var i,o,a,s,u,c,l,f,d,h;return L(r,(function(r){switch(r.j){case 1:return t.startTime=n.startTime,i=t.w,o=t.uri,e.Ob=o,e.H=new _o({rc:function(){return t.w.playbackRate},Id:function(e){t.w.playbackRate=e},le:function(e){t.w.currentTime+=e}}),e.v=new Is,a=function(){return Ys(e)},s=function(){return Xs(e)},e.g.B(i,"playing",a),e.g.B(i,"pause",a),e.g.B(i,"ended",a),e.g.B(i,"ratechange",s),u=e.b.abrFactory,e.l&&e.Lc==u||(e.Lc=u,e.l=new u,e.l.configure(e.b.abr)),function(e,t){for(var n=0;n<t.length;n++){for(var r=t[n],i=new Map,o=p(r.variants),a=o.next();!a.done;a=o.next())if((a=a.value).video&&a.video.closedCaptions)for(var s=p((a=a.video).closedCaptions.keys()),u=s.next();!u.done;u=s.next())if(u=u.value,!i.has(u)){var c={id:e.ke++,originalId:u,createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(){return null},getSegmentReference:function(){return null},initSegmentReference:null,presentationTimeOffset:0,mimeType:"application/cea-608",codecs:"",kind:"caption",encrypted:!1,keyId:null,language:a.closedCaptions.get(u),label:null,type:"text",primary:!1,frameRate:void 0,pixelAspectRatio:void 0,trickModeVideo:null,emsgSchemeIdUris:null,roles:a.roles,channelsCount:null,audioSamplingRate:null,closedCaptions:null};i.set(u,c)}for(i=p(i.values()),o=i.next();!o.done;o=i.next())r.textStreams.push(o.value)}}(e,e.c.periods),e.Pb=new So(e.b.preferredAudioLanguage,e.b.preferredVariantRole,e.b.preferredAudioChannelCount),e.qa=e.b.preferredTextLanguage,function(e,t,n){0<t&&(e.X()?Y.m("|playRangeStart| has been configured for live content. Ignoring the setting."):e.De(t)),n<e.ca()&&(e.X()?Y.m("|playRangeEnd| has been configured for live content. Ignoring the setting."):e.Ba(n))}(e.c.presentationTimeline,e.b.playRangeStart,e.b.playRangeEnd),k(r,e.h.Qb(i),2);case 2:return e.l.init((function(t,n,r){n=void 0!==n&&n,r=void 0===r?0:r,Y.debug("switch_");e:{for(var i=p(e.c.periods),o=i.next();!o.done;o=i.next())if((o=o.value).variants.includes(t)){i=o;break e}i=null}Vs(e,i,t,!0),e.f&&ca(e.f,t,n,r)&&Zs(e)})),e.o=function(e,t){return new Xo(e.a,e.c,e.b.streaming,t,(function(){e.qb&&Co(e.qb,!0),e.f&&function(e){function t(t){var i=e.a.O;return"text"==t?t=null!=(t=i.a).a&&null!=t.b&&(n>=t.a&&n<t.b):t=Lt(t=En(i,t),n,r),t}var n=e.a.Za(),r=e.g.smallGapLimit,i=!1,o=Ea(e,n);if(ze(e.b.values(),(function(e){return e.ka==o})))for(var a=p(e.b.keys()),s=a.next();!s.done;s=a.next())t(s=s.value)||(fa(e,e.b.get(s)),i=!0);else ze(e.b.keys(),t)||(Y.debug("(all): seeked: unbuffered seek: clearing all buffers"),e.b.forEach((function(t){fa(e,t)})),i=!0);i||Y.debug("(all): seeked: buffered seek: presentationTime="+n)}(e.f),e.F&&Us(e)}),(function(t){return e.dispatchEvent(t)}))}(e,t.startTime),e.qb=function(e){var t=new No(e.c);!function(e,t){e.b=t}(t,(function(){eu(e)}));var n=new Zo(e.ec);!function(e,t,n,r){e.a=t,e.b=n,e.c=r}(n,(function(t){ou(e,"timelineregionenter",t)}),(function(t){ou(e,"timelineregionexit",t)}),(function(t,n){n||(ou(e,"timelineregionenter",t),ou(e,"timelineregionexit",t))}));var r=new Ro(e.a);return r.a.add(t),r.a.add(n),r}(e),c=Math.max(e.c.minBufferTime,e.b.streaming.rebufferingGoal),Ls(e,c),e.f=function(e){return new ra(e.c,{Za:function(){return e.o.g()},getBandwidthEstimate:function(){return e.l.getBandwidthEstimate()},O:e.G,Db:e.S,oe:e.Lf.bind(e),ne:e.Se.bind(e),onError:e.Qa.bind(e),onEvent:function(t){return e.dispatchEvent(t)},Pf:e.Qf.bind(e),td:e.Vf.bind(e)})}(e),e.f.configure(e.b.streaming),_n.Vd(e.c,e.b.preferredAudioChannelCount),e.i=Su,e.dispatchEvent(new Te("streaming")),k(r,e.f.start(),3);case 3:e.b.streaming.startAtSegmentBoundary&&(l=e.o.g(),f=function(e,t){function n(e,t){if(!e)return null;var n=e.findSegmentPosition(t-o.startTime);return null==n?null:(n=e.getSegmentReference(n))?n.startTime+o.startTime:null}var r=ia(e.f),i=oa(e.f),o=hu(e);return r=n(r,t),null!=(i=n(i,t))&&null!=r?Math.max(i,r):null!=i?i:null!=r?r:t}(e,l),e.o.o(f)),e.c.periods.forEach(e.Vc.bind(e)),eu(e),Zs(e),d=hu(e)||e.c.periods[0],h=d.variants.some((function(e){return e.primary})),e.b.preferredAudioLanguage||h||Y.m("No preferred audio language set.  We will choose an arbitrary language initially"),$s(e,d.variants),e.g.ua(i,"loadedmetadata",(function(){e.v.b=Date.now()/1e3-n.Ld})),x(r)}}))}))}(r,e,t))})),i.set(this.dd,(function(e){return we(e=function(e,t){return y((function n(){var r,i;return L(n,(function(n){switch(n.j){case 1:return r=Ht,e.h=_s(e,{Db:e.S,onError:function(t){e.Qa(t)},yc:function(t){su(e,t)},onExpirationUpdated:function(t,n){uu(e,t,n)},onEvent:function(t){e.dispatchEvent(t)}}),e.h.configure(e.b.drm),i={id:0,language:"und",primary:!1,audio:null,video:{id:0,originalId:null,createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(){return null},getSegmentReference:function(){return null},initSegmentReference:null,presentationTimeOffset:0,mimeType:"video/mp4",codecs:"",encrypted:!0,keyId:null,language:"und",label:null,type:r.Ua,primary:!1,frameRate:void 0,pixelAspectRatio:void 0,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],channelsCount:null,audioSamplingRate:null,closedCaptions:null},bandwidth:100,drmInfos:[],allowedByApplication:!0,allowedByKeySystem:!0},k(n,pt(e.h,[i],[]),2);case 2:return k(n,e.h.Qb(t.w),0)}}))}))}(r,e))})),i.set(this.rb,(function(e,t){return function(e,t,n){function r(){return Ys(e)}if(t.uri=n.uri,t.startTime=n.startTime,e.Ob=t.uri,e.v=new Is,e.o=new Wo(t.w),null!=t.startTime&&e.o.o(t.startTime),e.H=new _o({rc:function(){return t.w.playbackRate},Id:function(e){t.w.playbackRate=e},le:function(e){t.w.currentTime+=e}}),Ls(e,e.b.streaming.rebufferingGoal),e.g.B(t.w,"playing",r),e.g.B(t.w,"pause",r),e.g.B(t.w,"ended",r),e.g.B(t.w,"ratechange",(function(){return Xs(e)})),"none"!=e.a.preload&&e.g.ua(t.w,"loadedmetadata",(function(){e.v.b=Date.now()/1e3-n.Ld})),e.a.audioTracks&&(e.g.B(e.a.audioTracks,"addtrack",(function(){return eu(e)})),e.g.B(e.a.audioTracks,"removetrack",(function(){return eu(e)})),e.g.B(e.a.audioTracks,"change",(function(){return eu(e)}))),e.a.textTracks){var i=e.a.textTracks;e.g.B(i,"addtrack",(function(){return eu(e)})),e.g.B(i,"removetrack",(function(){return eu(e)})),e.g.B(i,"change",(function(){return eu(e)}))}t.w.src=t.uri,e.i=Tu,e.dispatchEvent(new Te("streaming"));var o=new ye;Uo(e.a,HTMLMediaElement.HAVE_METADATA,e.g,(function(){o.resolve()}));var a=!1;return e.Mc.push((function(){a=!0})),Uo(e.a,HTMLMediaElement.HAVE_CURRENT_DATA,e.g,(function(){return y((function t(){return L(t,(function(t){switch(t.j){case 1:if(a)return t.return();if(function(e){var t=e.b.preferredAudioLanguage;if(""!=t){e.Dd(t);var n=e.b.preferredVariantRole;""!=n&&e.Dd(t,n)}}(e),Bs(e).find((function(e){return"disabled"!=e.mode}))){t.C(2);break}return k(t,new Promise((function(t){e.g.ua(e.a.textTracks,"change",t),new fe(t).T(1)})),2);case 2:if(a)return t.return();!function(e){var t=e.b.preferredTextLanguage;if(""!=t){e.Ed(t);var n=e.b.preferredTextRole;""!=n&&e.Ed(t,n)}}(e),x(t)}}))}))})),e.a.error?o.reject(au(e)):"none"==e.a.preload&&(Y.Z('With <video preload="none">, the browser will not load anything until play() is called. We are unable to measure load latency in a meaningful way, and we cannot provide track info yet. Please do not use preload="none" with Shaka Player.'),o.resolve()),e.g.ua(e.a,"error",(function(){o.reject(au(e))})),new me(o,(function(){return o.reject(new he(2,7,7001)),Promise.resolve()}))}(r,e,t)})),this.Ta=new ys(this.K,{rf:function(e,t,n,i){var o=null;return e==r.K&&(o=n==r.K?r.K:r.V),e==r.V&&(o=n==r.K||t.w!=i.w?r.K:n==r.V?r.V:n==r.pb||n==r.$?r.pb:n==r.rb?r.dd:null),e==r.pb&&(o=n==r.$&&t.w==i.w?r.Zc:r.La),e==r.Zc&&(o=vu(r.$,r.Uc,r.La,n,t,i)),e==r.Uc&&(o=vu(r.$,r.Nc,r.La,n,t,i)),e==r.Nc&&(o=vu(r.$,r.$,r.La,n,t,i)),e==r.dd&&(o=n==r.rb&&t.w==i.w?r.rb:r.La),e!=r.$&&e!=r.rb||(o=r.La),e==r.La&&(o=i.w&&t.w==i.w?r.V:r.K),o},Ye:function(e,t,n){return r.dispatchEvent(new Te("onstatechange",{state:e.name})),i.get(e)(t,n)},handleError:function(e,t){return y((function n(){return L(n,(function(n){switch(n.j){case 1:return Y.m("The walker saw an error:"),t instanceof he?Y.m("Error Code:",t.code):(Y.m("Error Message:",t.message),Y.m("Error Stack:",t.stack)),k(n,Ns(r,e),2);case 2:return n.return(e.w?r.V:r.K)}}))}))},Nf:function(e){r.dispatchEvent(new Te("onstateidle",{state:e.name}))}}),t&&this.Qb(t,!0)}S(Qa,Ha),Qa.prototype.updateManifestExpiration=function(e,t){var n=Va(this.b,this.a),r=n.store(),i=new ye;return r.get(e).onsuccess=function(n){(n=n.target.result)?(n.expiration=t,r.put(n),i.resolve()):i.reject(new he(2,9,9012,"Could not find values for "+e))},n.promise().then((function(){return i}))},Qa.prototype.mc=function(e){return{originalManifestUri:e.originalManifestUri,duration:e.duration,size:e.size,expiration:null==e.expiration?1/0:e.expiration,periods:e.periods.map(Za),sessionIds:e.sessionIds,drmInfo:e.drmInfo,appMetadata:e.appMetadata}},Qa.prototype.Wd=function(e){return{data:e.data}},S(rs,Ha),rs.prototype.hasFixedKeySpace=function(){return this.f},rs.prototype.addSegments=function(e){return this.f?za(this.c):this.add(this.c,e)},rs.prototype.addManifests=function(e){return this.f?za(this.a):this.add(this.a,e)},rs.prototype.mc=function(e){return null==e.expiration&&(e.expiration=1/0),e},(i=is.prototype).init=function(){var t=this,n=new ye,r=e.indexedDB.open("shaka_offline_db",4);return r.onsuccess=function(e){e=e.target.result,t.f=e;var r=e.objectStoreNames;r.contains("manifest")&&r.contains("segment")?(Y.debug("Mounting v1 idb storage cell"),r=new Qa(e,"segment","manifest")):r=null,t.a=r,(r=e.objectStoreNames).contains("manifest-v2")&&r.contains("segment-v2")?(Y.debug("Mounting v2 idb storage cell"),r=new rs(e,"segment-v2","manifest-v2",!0)):r=null,t.b=r,(r=e.objectStoreNames).contains("manifest-v3")&&r.contains("segment-v3")?(Y.debug("Mounting v3 idb storage cell"),r=new rs(e,"segment-v3","manifest-v3",!1)):r=null,t.c=r,e.objectStoreNames.contains("session-ids")?(Y.debug("Mounting session ID idb storage cell"),e=new Wa(e)):e=null,t.g=e,n.resolve()},r.onupgradeneeded=function(e){e=e.target.result;for(var t=p(["segment-v3","manifest-v3","session-ids"]),n=t.next();!n.done;n=t.next())n=n.value,e.objectStoreNames.contains(n)||e.createObjectStore(n,{autoIncrement:!0})},r.onerror=function(e){n.reject(new he(2,9,9001,r.error)),e.preventDefault()},n},i.destroy=function(){var e=this;return y((function t(){return L(t,(function(t){switch(t.j){case 1:if(!e.a){t.C(2);break}return k(t,e.a.destroy(),2);case 2:if(!e.b){t.C(4);break}return k(t,e.b.destroy(),4);case 4:if(!e.c){t.C(6);break}return k(t,e.c.destroy(),6);case 6:if(!e.g){t.C(8);break}return k(t,e.g.destroy(),8);case 8:e.f&&e.f.close(),x(t)}}))}))},i.getCells=function(){var e=new Map;return this.a&&e.set("v1",this.a),this.b&&e.set("v2",this.b),this.c&&e.set("v3",this.c),e},i.getEmeSessionCell=function(){return this.g},i.erase=function(){var t=this;return y((function n(){return L(n,(function(n){switch(n.j){case 1:if(!t.a){n.C(2);break}return k(n,t.a.destroy(),2);case 2:if(!t.b){n.C(4);break}return k(n,t.b.destroy(),4);case 4:if(!t.c){n.C(6);break}return k(n,t.c.destroy(),6);case 6:return t.f&&t.f.close(),k(n,function(){var t=new ye,n=e.indexedDB.deleteDatabase("shaka_offline_db");return n.onblocked=function(){Y.m("Deleting","shaka_offline_db","is being blocked")},n.onsuccess=function(){t.resolve()},n.onerror=function(e){t.reject(new he(2,9,9001,n.error)),e.preventDefault()},t}(),8);case 8:return t.f=null,t.a=null,t.b=null,t.c=null,k(n,t.init(),0)}}))}))},$a("idb",(function(){return e.indexedDB?new is:null})),os.prototype.Aa=function(){return this.g},os.prototype.fa=function(){return this.f},os.prototype.key=function(){return this.c},os.prototype.toString=function(){return this.b},(i=fs.prototype).configure=function(){},i.start=function(e){var t=this;return y((function n(){var r,i,o,a,s;return L(n,(function(n){switch(n.j){case 1:return r=as(e),t.a=r,null==r||"manifest"!=r.a?n.return(Promise.reject(new he(2,1,9004,r))):(i=new Xa,O(n,2),k(n,i.init(),4));case 4:return k(n,Ya(i,r.Aa(),r.fa()),5);case 5:return k(n,n.s.getManifests([r.key()]),6);case 6:return o=n.s,a=o[0],s=new ss(r.Aa(),r.fa()),n.return(function(e,t){var n=new yi(null,0);n.Ba(t.duration);var r=t.periods.map((function(t){return us(e,t,n)})),i=t.drmInfo?[t.drmInfo]:[];return t.drmInfo&&r.forEach((function(e){e.variants.forEach((function(e){e.drmInfos=i}))})),{presentationTimeline:n,minBufferTime:2,offlineSessionIds:t.sessionIds,periods:r}}(s,a));case 2:return R(n),k(n,i.destroy(),7);case 7:C(n,0)}}))}))},i.stop=function(){return Promise.resolve()},i.update=function(){},i.onExpirationUpdated=function(e,t){var n=this;return y((function r(){var i,o,a,s,u,c,l,f;return L(r,(function(r){switch(r.j){case 1:return i=n.a,o=new Xa,A(r,2,3),k(r,o.init(),5);case 5:return k(r,Ya(o,i.Aa(),i.fa()),6);case 6:return k(r,(a=r.s).getManifests([i.key()]),7);case 7:if(s=r.s,u=s[0],c=u.sessionIds.includes(e),l=null==u.expiration||u.expiration>t,!c||!l){r.C(3);break}return Y.debug("Updating expiration for stored content"),k(r,a.updateManifestExpiration(i.key(),t),3);case 3:return R(r),k(r,o.destroy(),10);case 10:C(r,0);break;case 2:f=I(r),Y.error("There was an error updating",i,f),r.C(3)}}))}))},hi.Lb("application/x-offline-manifest",fs),H("shaka.offline.OfflineScheme",ds),ds.h=function(e){return be(e={uri:e,vd:e,data:new ArrayBuffer(0),headers:{"content-type":"application/x-offline-manifest"}})},ds.i=function(e,t){var n=new Xa;return be(void 0).Y((function(){return n.init()})).Y((function(){return Ya(n,t.Aa(),t.fa())})).Y((function(e){return e.getSegments([t.key()])})).Y((function(e){return{uri:t,vd:t,data:e[0].data,headers:{}}})).finally((function(){return n.destroy()}))},De("offline",ds),ys.prototype.destroy=function(){var e=this;return y((function t(){return L(t,(function(t){switch(t.j){case 1:return e.l=!1,e.b&&e.b.abort(),vs(e),k(t,e.o,2);case 2:e.a&&e.a.za.eb();for(var n=p(e.g),r=n.next();!r.done;r=n.next())r.value.za.eb();e.a=null,e.g=[],e.h=null,x(t)}}))}))},H("shaka.text.SimpleTextDisplayer",gs),gs.prototype.remove=function(e,t){return!!this.a&&(ws(this.a,(function(n){return n.startTime<t&&n.endTime>e})),!0)},gs.prototype.remove=gs.prototype.remove,gs.prototype.append=function(e){for(var t=bs,n=[],r=(e=p(e)).next();!r.done;r=e.next())(r=r.value).nestedCues.length?n=n.concat(r.nestedCues):n.push(r);var i=[];e=this.a.cues?Array.from(this.a.cues):[],r={};for(var o=(n=p(n)).next();!o.done;r={Ab:r.Ab},o=n.next())r.Ab=o.value,e.some(function(e){return function(t){return t.startTime==e.Ab.startTime&&t.endTime==e.Ab.endTime&&t.text==e.Ab.payload}}(r))||(o=t(r.Ab))&&i.push(o);i.slice().sort((function(e,t){return e.startTime!=t.startTime?e.startTime-t.startTime:e.endTime!=t.endTime?e.endTime-t.startTime:i.indexOf(t)-i.indexOf(e)})).forEach(function(e){this.a.addCue(e)}.bind(this))},gs.prototype.append=gs.prototype.append,gs.prototype.destroy=function(){return this.a&&ws(this.a,(function(){return!0})),this.a=null,Promise.resolve()},gs.prototype.destroy=gs.prototype.destroy,gs.prototype.isTextVisible=function(){return"showing"==this.a.mode},gs.prototype.isTextVisible=gs.prototype.isTextVisible,gs.prototype.setTextVisibility=function(e){this.a.mode=e?"showing":"hidden"},gs.prototype.setTextVisibility=gs.prototype.setTextVisibility,H("shaka.util.ConfigUtils.mergeConfigObjects",Ss),H("shaka.util.ConfigUtils.convertToConfigObject",Ts),H("shaka.util.PlayerConfiguration",Es),Es.mergeConfigObjects=ks,z(Rs,Pe),H("shaka.Player",Rs),Rs.prototype.destroy=function(){var e=this;return y((function t(){var n;return L(t,(function(t){switch(t.j){case 1:return e.i==bu?t.return():(e.i=bu,n=ms(e.Ta,(function(){return{node:e.K,payload:{Ea:null,w:null,mimeType:null,startTime:null,Ld:null,uri:null},$a:!1}})),k(t,new Promise((function(t){n.Fb=function(){Y.info("Preparing to destroy walker...")},n.xc=function(){t(),e.dispatchEvent(new Te("loaded"))},n.eb=function(){t()},n.onError=function(){t()},n.zc=function(){t()}})),2));case 2:return k(t,e.Ta.destroy(),3);case 3:if(e.g&&(e.g.release(),e.g=null),e.Lc=null,e.l=null,e.b=null,!e.S){t.C(0);break}return k(t,e.S.destroy(),5);case 5:e.S=null,x(t)}}))}))},Rs.prototype.destroy=Rs.prototype.destroy,Rs.version="v2.5.13";var Cs=["2","5"];Hn=new function(e){this.a=e,this.c=Vn,this.b=Fn}(new Kn(Number(Cs[0]),Number(Cs[1])));var Ds=["output-restricted","internal-error"],js={};function Ns(e,t){return y((function n(){var r;return L(n,(function(n){switch(n.j){case 1:return e.i!=bu&&(e.i=wu),r=e.Mc.map((function(e){return e()})),e.Mc=[],k(n,Promise.all(r),2);case 2:if(e.dispatchEvent(new Te("unloading")),t.Ea=null,t.mimeType=null,t.startTime=null,t.uri=null,t.w&&(e.g.pa(t.w,"loadedmetadata"),e.g.pa(t.w,"playing"),e.g.pa(t.w,"pause"),e.g.pa(t.w,"ended"),e.g.pa(t.w,"ratechange")),e.qb&&(e.qb.release(),e.qb=null),e.fc&&(e.fc.stop(),e.fc=null),!e.u){n.C(3);break}return k(n,e.u.stop(),4);case 4:e.u=null;case 3:if(!e.l){n.C(5);break}return k(n,e.l.stop(),5);case 5:if(!e.f){n.C(7);break}return k(n,e.f.destroy(),8);case 8:e.f=null;case 7:if(e.H&&(e.H.release(),e.H=null),e.o&&(e.o.release(),e.o=null),!e.G){n.C(9);break}return k(n,e.G.destroy(),10);case 10:e.G=null;case 9:if(!t.w||!t.w.src){n.C(11);break}return k(n,new Promise((function(e){return new fe(e).T(.1)})),12);case 12:t.w.removeAttribute("src"),t.w.load();case 11:if(!e.h){n.C(13);break}return k(n,e.h.destroy(),14);case 14:e.h=null;case 13:e.ea.a.clear(),e.Ob=null,e.F=null,e.hc.clear(),e.c=null,e.v=null,e.Rc=null,e.sb=!0,Ws(e),x(n)}}))}))}function _s(e,t){return new dt(t,e.b.drm.updateExpirationTime)}function Ls(e,t){e.F=new To,e.F.a=Po,Eo(e.F,t,Math.min(.5,t/2)),Ws(e),e.fc=new fe((function(){Us(e)})).Ra(.25)}function Us(e){switch(e.i){case Tu:var t=!!e.a.ended||_t(e.a.buffered)>=e.a.duration-1;break;case Su:e:if(e.a.ended||wn(e.G))t=!0;else{if(e.c.presentationTimeline.X()){var n=e.c.presentationTimeline.xb();if(_t(e.a.buffered)>=n){t=!0;break e}}t=!1}break;default:t=!1}var r=Ut(e.a.buffered,e.a.currentTime),i=t,o=(n=e.F).b.get(n.a);t=n.a,r=i||r>=o?ko:Po,n.a=r,t!=r&&Ws(e)}function Ks(e){if(e.u){var t=ke(e.b.manifest);e.a&&"AUDIO"===e.a.nodeName&&(t.disableVideo=!0),e.u.configure(t)}if(e.h&&e.h.configure(e.b.drm),e.f){e.f.configure(e.b.streaming);try{e.c.periods.forEach(e.Vc.bind(e))}catch(t){e.Qa(t)}var n=ia(e.f),r=oa(e.f);t=hu(e),n=_n.ce(n,r,t.variants),e.l&&n&&n.allowedByApplication&&n.allowedByKeySystem?$s(e,t.variants):(Y.debug("Choosing new streams after changing configuration"),Js(e,t))}if(e.G&&(t=e.b.textDisplayFactory,e.Rc!=t)){n=new t;var i=(r=e.G).g;r.g=n,i&&(n.setTextVisibility(i.isTextVisible()),i.destroy()),r.a&&(r.a.c=n),e.Rc=t,e.f&&((n=(t=e.f).b.get("text"))&&la(t,n.stream,!0,0,!0))}e.l&&(e.l.configure(e.b.abr),e.b.abr.enabled&&!e.sb?e.l.enable():e.l.disable(),iu(e)),e.F&&(t=e.b.streaming.rebufferingGoal,e.c&&(t=Math.max(t,e.c.minBufferTime)),Eo(e.F,t,Math.min(.5,t/2)))}function Bs(e){return Array.from(e.a.textTracks).filter((function(e){return"metadata"!=e.kind&&"Shaka Player TextTrack"!=e.label}))}function Vs(e,t,n,r){ho(e.ea,t).variant=n,(e=e.v.c).c!=n&&(e.c=n,e.a.push({timestamp:Date.now()/1e3,id:n.id,type:"variant",fromAdaptation:r,bandwidth:n.bandwidth}))}function Fs(e,t,n,r){po(e.ea,t,n),(e=e.v.c).b!=n&&(e.b=n,e.a.push({timestamp:Date.now()/1e3,id:n.id,type:"text",fromAdaptation:r,bandwidth:null}))}function Hs(e){var t=Ps();return t.streaming.failureCallback=function(t){e.X()&&[1001,1002,1003].includes(t.code)&&(t.severity=1,Y.m("Live streaming error.  Retrying automatically..."),e.Cd())},t.textDisplayFactory=function(){return new gs(e.a)},t}function zs(e,t){var n=e.f?ia(e.f):null,r=e.f?oa(e.f):null;if(t.forEach(_n.filterNewPeriod.bind(null,e.h,n,r)),0==(n=function(e,t){var n=0;return e.forEach((function(e){n+=t(e)?1:0})),n}(t,(function(e){return e.variants.some(_n.Bb)}))))throw new he(2,4,4032);if(n<t.length)throw new he(2,4,4011);t.forEach(function(e){_n.Sd(e.variants,this.b.restrictions,this.ic)&&this.f&&hu(this)==e&&eu(this),cu(this,e.variants)}.bind(e))}function qs(e,t,n,r){return n=void 0!==n&&n,r=void 0===r?0:r,e.sb?(e.sa=t,e.je=n,e.ge=r,!0):((t=ca(e.f,t,n,r))&&tu(e),t)}function Gs(e,t){if(e.sb)return e.ra=t,!0;var n=la(e.f,t,!0,0,!1);return n&&nu(e),n}function Ws(e){var t=e.fd();if(e.v&&e.F&&e.o){var n=e.H;n.f=t,Lo(n),Ys(e)}e.dispatchEvent(new Te("buffering",{buffering:t}))}function Xs(e){var t=e.a.playbackRate;0!=t&&e.H.set(t)}function Ys(e){if(e.v&&e.F){var t=e.v.a;e.F.a==Po?As(t,"buffering"):e.a.paused?As(t,"paused"):e.a.ended?As(t,"ended"):As(t,"playing")}}function $s(e,t){try{cu(e,t)}catch(t){return e.Qa(t),null}var n=t.filter((function(e){return _n.Bb(e)}));return n=e.Pb.create(n),e.l.setVariants(Array.from(n.values())),e.l.chooseVariant()}function Js(e,t){var n=Qs(e,t,!1),r=_n.Sb(t.textStreams,e.qa,e.nb)[0]||null,i=!1;r&&(e.b.streaming.alwaysStreamText||e.uc())&&(Fs(e,t,r,!0),i=Gs(e,r)),(n||i)&&Zs(e)}function Qs(e,t,n){n=void 0===n||n;var r=$s(e,t.variants),i=!1;return r&&(Vs(e,t,r,!0),i=qs(e,r,!0)),n&&i&&Zs(e),i}function Zs(e){lu(e,new Te("adaptation"))}function eu(e){lu(e,new Te("trackschanged"))}function tu(e){lu(e,new Te("variantchanged"))}function nu(e){lu(e,new Te("textchanged"))}function ru(e){lu(e,new Te("texttrackvisibility"))}function iu(e){lu(e,new Te("abrstatuschanged",{Rg:e.b.abr.enabled}))}function ou(e,t,n){e.dispatchEvent(new Te(t,{detail:{schemeIdUri:n.schemeIdUri,value:n.value,startTime:n.startTime,endTime:n.endTime,id:n.id,eventElement:n.eventElement}}))}function au(e){if(!e.a.error)return null;var t=e.a.error.code;if(1==t)return null;var n=e.a.error.msExtendedCode;return n&&(0>n&&(n+=Math.pow(2,32)),n=n.toString(16)),new he(2,3,3016,t,n,e.a.error.message)}function su(e,t){if(e.f){var n=hu(e),r=!1,i=Object.keys(t);0==i.length&&Y.m("Got a key status event without any key statuses, so we don't know the real key statuses. If we don't have all the keys, you'll need to set restrictions so we don't select those tracks.");var o=1==i.length&&"00"==i[0];o&&Y.m("Got a synthetic key status event, so we don't know the real key statuses. If we don't have all the keys, you'll need to set restrictions so we don't select those tracks."),i.length&&e.c.periods.forEach((function(e){e.variants.forEach((function(e){_n.Bf(e).forEach((function(n){var i=e.allowedByKeySystem;n.keyId&&(n=t[o?"00":n.keyId],e.allowedByKeySystem=!!n&&!Ds.includes(n)),i!=e.allowedByKeySystem&&(r=!0)}))}))})),i=ia(e.f);var a=oa(e.f);(i=_n.ce(i,a,n.variants))&&!i.allowedByKeySystem&&(Y.debug("Choosing new variants after key status changed"),Qs(e,n)),r&&(eu(e),$s(e,n.variants))}}function uu(e,t,n){e.u&&e.u.onExpirationUpdated&&e.u.onExpirationUpdated(t,n),e.dispatchEvent(new Te("expirationupdated"))}function cu(e,t){var n=e.h?Ge(e.h.$):{},r=Object.keys(n);r=r.length&&"00"==r[0];for(var i=!1,o=!1,a=[],s=[],u=p(t),c=u.next();!c.done;c=u.next()){var l=[];(c=c.value).audio&&l.push(c.audio),c.video&&l.push(c.video);for(var f=(l=p(l)).next();!f.done;f=l.next())if((f=f.value).keyId){var d=n[r?"00":f.keyId];d?Ds.includes(d)&&(s.includes(d)||s.push(d)):a.includes(f.keyId)||a.push(f.keyId)}c.allowedByApplication?c.allowedByKeySystem&&(i=!0):o=!0}if(!i)throw new he(2,4,4012,{hasAppRestrictions:o,missingKeys:a,restrictedKeyStatuses:s})}function lu(e,t){y((function n(){return L(n,(function(n){switch(n.j){case 1:return k(n,Promise.resolve(),2);case 2:e.i!=bu&&e.dispatchEvent(t),x(n)}}))}))}function fu(e){for(var t=new Set,n=(e=p(e)).next();!n.done;n=e.next())(n=n.value).language?t.add(Cn(n.language)):t.add("und");return t}function du(e){for(var t=new Map,n=(e=p(e)).next();!n.done;n=e.next()){var r=n.value;n="und";var i=[];for(r.language&&(n=Cn(r.language)),(i="variant"==r.type?r.audioRoles:r.roles)&&i.length||(i=[""]),t.has(n)||t.set(n,new Set),i=(r=p(i)).next();!i.done;i=r.next())i=i.value,t.get(n).add(i)}var o=[];return t.forEach((function(e,t){for(var n=p(e),r=n.next();!r.done;r=n.next())o.push({language:t,role:r.value})})),o}function pu(e){return null==(e=hu(e))?[]:e.variants.filter((function(e){return _n.Bb(e)}))}function hu(e){for(var t=e.o.g(),n=null,r=(e=p(e.c.periods)).next();!r.done;r=e.next())(r=r.value).startTime<=t&&(n=r);return n}function yu(e){var t=hu(e);return ho(e.ea,t).variant}function mu(){return new he(2,7,7e3)}function vu(e,t,n,r,i,o){return r==e&&i.w==o.w&&i.uri==o.uri&&i.mimeType==o.mimeType&&i.Ea==o.Ea?t:n}function gu(e){return new Promise((function(t,n){e.eb=function(){return n(mu())},e.xc=function(){return t()},e.onError=function(e){return n(e)},e.zc=function(){return n(mu())}}))}Rs.registerSupportPlugin=function(e,t){js[e]=t},Rs.isBrowserSupported=function(){if(!(e.Promise&&e.Uint8Array&&Array.prototype.forEach))return!1;var t=Ze();return!(t&&12>t||!(e.MediaKeys&&e.navigator&&e.navigator.requestMediaKeySystemAccess&&e.MediaKeySystemAccess&&e.MediaKeySystemAccess.prototype.getConfiguration))&&(!!$e()||Je("application/x-mpegurl"))},Rs.probeSupport=function(){return xt().then((function(e){for(var t=hi.dg(),n={},r=p('video/mp4; codecs="avc1.42E01E",video/mp4; codecs="avc3.42E01E",video/mp4; codecs="hev1.1.6.L93.90",video/mp4; codecs="hvc1.1.6.L93.90",video/mp4; codecs="hev1.2.4.L153.B0"; eotf="smpte2084",video/mp4; codecs="hvc1.2.4.L153.B0"; eotf="smpte2084",video/mp4; codecs="vp9",video/mp4; codecs="vp09.00.10.08",video/mp4; codecs="av01.0.01M.08",audio/mp4; codecs="mp4a.40.2",audio/mp4; codecs="ac-3",audio/mp4; codecs="ec-3",audio/mp4; codecs="opus",audio/mp4; codecs="flac",video/webm; codecs="vp8",video/webm; codecs="vp9",video/webm; codecs="vp09.00.10.08",audio/webm; codecs="vorbis",audio/webm; codecs="opus",video/mp2t; codecs="avc1.42E01E",video/mp2t; codecs="avc3.42E01E",video/mp2t; codecs="hvc1.1.6.L93.90",video/mp2t; codecs="mp4a.40.2",video/mp2t; codecs="ac-3",video/mp2t; codecs="ec-3",text/vtt,application/mp4; codecs="wvtt",application/ttml+xml,application/mp4; codecs="stpp"'.split(",")),i=r.next();!i.done;i=r.next()){n[i=i.value]=$e()?!!pn(i)||(MediaSource.isTypeSupported(i)||qt(i)):Je(i);var o=i.split(";")[0];n[o]=n[o]||n[i]}for(var a in e={manifest:t,media:n,drm:e},js)e[a]=js[a]();return e}))},Rs.prototype.Qb=function(e,t){if(t=void 0===t||t,this.i==bu)return Promise.reject(mu());var n={Ea:null,w:null,mimeType:null,startTime:null,Ld:null,uri:null};n.w=e,$e()||(t=!1);var r=t?this.pb:this.V,i=ms(this.Ta,(function(){return{node:r,payload:n,$a:!1}}));return i.Fb=function(){return Y.info("Starting attach...")},gu(i)},Rs.prototype.attach=Rs.prototype.Qb,Rs.prototype.detach=function(){var e=this;if(this.i==bu)return Promise.reject(mu());var t=ms(this.Ta,(function(){return{node:e.K,payload:{Ea:null,w:null,mimeType:null,startTime:null,Ld:null,uri:null},$a:!1}}));return t.Fb=function(){return Y.info("Starting detach...")},gu(t)},Rs.prototype.detach=Rs.prototype.detach,Rs.prototype.Od=function(e){var t=this;if(e=void 0===e||e,this.i==bu)return Promise.reject(mu());$e()||(e=!1);var n={Ea:null,w:null,mimeType:null,startTime:null,Ld:null,uri:null},r=ms(this.Ta,(function(r){var i=r.w&&e?t.pb:r.w?t.V:t.K;return n.w=r.w,{node:i,payload:n,$a:!1}}));return r.Fb=function(){return Y.info("Starting unload...")},gu(r)},Rs.prototype.unload=Rs.prototype.Od,Rs.prototype.load=function(e,t,n){if(this.i==bu)return Promise.reject(mu());this.dispatchEvent(new Te("loading"));var r={Ea:null,w:null,mimeType:null,startTime:null,Ld:null,uri:null};r.uri=e,r.Ld=Date.now()/1e3,n&&"string"!=typeof n&&(Bn("Loading with a manifest parser factory","Please register a manifest parser and for the mime-type."),r.Ea=function(){return new n}),n&&"string"==typeof n&&(r.mimeType=n),void 0!==t&&(r.startTime=t);var i=function(e,t){if(t.Ea)return!1;if(!$e())return!0;var n=t.mimeType,r=t.uri||"";return n||(n={mp4:"video/mp4",m4v:"video/mp4",m4a:"audio/mp4",webm:"video/webm",weba:"audio/webm",mkv:"video/webm",ts:"video/mp2t",ogv:"video/ogg",ogg:"audio/ogg",mpg:"video/mpeg",mpeg:"video/mpeg",m3u8:"application/x-mpegurl",mp3:"audio/mpeg",aac:"audio/aac",flac:"audio/flac",wav:"audio/wav"}[hi.getExtension(r)]),!!n&&(""!=(t.w||tt()).canPlayType(n)&&(!hi.isSupported(r,n)||Qe()&&e.b.streaming.useNativeHlsOnSafari))}(this,r)?this.rb:this.$,o=ms(this.Ta,(function(e){return null==e.w?null:(r.w=e.w,{node:i,payload:r,$a:!0})}));return o.Fb=function(){return Y.info("Starting load of "+e+"...")},new Promise((function(e,t){o.zc=function(){return t(new he(2,7,7002))},o.xc=function(){return e()},o.eb=function(){return t(mu())},o.onError=function(e){return t(e)}}))},Rs.prototype.load=Rs.prototype.load,Rs.prototype.configure=function(e,t){2==arguments.length&&"string"==typeof e&&(e=Ts(e,t));var n=ks(this.b,e,Hs(this));return Ks(this),n},Rs.prototype.configure=Rs.prototype.configure,Rs.prototype.getConfiguration=function(){var e=Hs(this);return ks(e,this.b,Hs(this)),e},Rs.prototype.getConfiguration=Rs.prototype.getConfiguration,Rs.prototype.lg=function(){for(var e in this.b)delete this.b[e];ks(this.b,Hs(this),Hs(this)),Ks(this)},Rs.prototype.resetConfiguration=Rs.prototype.lg,Rs.prototype.jf=function(){return this.i},Rs.prototype.getLoadMode=Rs.prototype.jf,Rs.prototype.pf=function(){return this.a},Rs.prototype.getMediaElement=Rs.prototype.pf,Rs.prototype.Ub=function(){return this.S},Rs.prototype.getNetworkingEngine=Rs.prototype.Ub,Rs.prototype.pc=function(){return this.Ob},Rs.prototype.getAssetUri=Rs.prototype.pc,Rs.prototype.mf=function(){return Bn("getManifestUri",'Please use "getAssetUri" instead.'),this.pc()},Rs.prototype.getManifestUri=Rs.prototype.mf,Rs.prototype.X=function(){return this.c?this.c.presentationTimeline.X():!(!this.a||!this.a.src)&&1/0==this.a.duration},Rs.prototype.isLive=Rs.prototype.X,Rs.prototype.bb=function(){return!!this.c&&this.c.presentationTimeline.bb()},Rs.prototype.isInProgress=Rs.prototype.bb,Rs.prototype.Gf=function(){if(this.c){if(!this.c.periods.length)return!1;var e=this.c.periods[0].variants;return!!e.length&&!e[0].video}return!(!this.a||!this.a.src)&&(this.a.videoTracks?0==this.a.videoTracks.length:0==this.a.videoHeight)},Rs.prototype.isAudioOnly=Rs.prototype.Gf,Rs.prototype.ng=function(){if(this.c){var e=this.c.presentationTimeline;return{start:e.wb(),end:e.Ga()}}return this.a&&this.a.src&&(e=this.a.seekable).length?{start:e.start(0),end:e.end(e.length-1)}:{start:0,end:0}},Rs.prototype.seekRange=Rs.prototype.ng,Rs.prototype.keySystem=function(){return gt(this.drmInfo())},Rs.prototype.keySystem=Rs.prototype.keySystem,Rs.prototype.drmInfo=function(){return this.h?this.h.a:null},Rs.prototype.drmInfo=Rs.prototype.drmInfo,Rs.prototype.Tb=function(){return this.h?this.h.Tb():1/0},Rs.prototype.getExpiration=Rs.prototype.Tb,Rs.prototype.fd=function(){return!!this.F&&this.F.a==Po},Rs.prototype.isBuffering=Rs.prototype.fd,Rs.prototype.tf=function(){if(this.H){var e=this.H;e=e.f?0:e.c}else e=0;return e},Rs.prototype.getPlaybackRate=Rs.prototype.tf,Rs.prototype.Eg=function(e){0==e?Y.Z("A trick play rate of 0 is unsupported!"):(this.a.paused&&this.a.play(),this.H&&this.H.set(e),this.i==Su&&ua(this.f,1<Math.abs(e)))},Rs.prototype.trickPlay=Rs.prototype.Eg,Rs.prototype.Te=function(){this.i==Tu&&this.H.set(1),this.i==Su&&(this.H.set(1),ua(this.f,!1))},Rs.prototype.cancelTrickPlay=Rs.prototype.Te,Rs.prototype.cd=function(){if(this.c&&this.o){for(var e=yu(this),t=[],n=p(pu(this)),r=n.next();!r.done;r=n.next()){r=r.value;var i=_n.Qd(r);i.active=r==e,t.push(i)}return t}return this.a&&this.a.audioTracks?Array.from(this.a.audioTracks).map((function(e){return _n.de(e)})):[]},Rs.prototype.getVariantTracks=Rs.prototype.cd,Rs.prototype.zb=function(){if(this.c&&this.o){for(var e=function(e){var t=hu(e);if(null==t)return null;if(!ho(e.ea,t).text){var n=_n.Sb(t.textStreams,e.qa,e.nb);n.length&&po(e.ea,t,n[0])}return ho(e.ea,t).text}(this),t=[],n=p(function(e){var t=hu(e);return null==t?[]:t.textStreams.filter((function(t){return!e.hc.has(t)}))}(this)),r=n.next();!r.done;r=n.next()){r=r.value;var i=_n.Fc(r);i.active=r==e,t.push(i)}return t}return this.a&&this.a.src&&this.a.textTracks?Bs(this).map((function(e){return _n.Ef(e)})):[]},Rs.prototype.getTextTracks=Rs.prototype.zb,Rs.prototype.Fd=function(e){if(this.c&&this.f){var t=hu(this),n=t.textStreams.find((function(t){return t.id==e.id}));n?(Fs(this,t,n,!1),Gs(this,n),this.qa=n.language):Y.error("No stream with id",e.id)}else if(this.a&&this.a.src&&this.a.textTracks){for(n=(t=p(t=Bs(this))).next();!n.done;n=t.next())n=n.value,_n.ed(n)==e.id?n.mode=this.ob?"showing":"hidden":n.mode="disabled";nu(this)}},Rs.prototype.selectTextTrack=Rs.prototype.Fd,Rs.prototype.og=function(){Bn("selectEmbeddedTextTrack","If closed captions are signaled in the manifest, a text stream will be created to represent them. Please use SelectTextTrack.");var e=this.zb().filter((function(e){return"application/cea-608"==e.mimeType}));0<e.length?this.Fd(e[0]):Y.m("Unable to find the text track embedded in the video.")},Rs.prototype.selectEmbeddedTextTrack=Rs.prototype.og,Rs.prototype.Jg=function(){Bn("usingEmbeddedTextTrack","If closed captions are signaled in the manifest, a text stream will be created to represent them. There should be no reason to know if the player is playing embedded text.");var e=this.zb().filter((function(e){return e.active}))[0];return!!e&&"application/cea-608"==e.mimeType},Rs.prototype.usingEmbeddedTextTrack=Rs.prototype.Jg,Rs.prototype.pg=function(e,t,n){if(n=void 0===n?0:n,this.c&&this.f){var r=hu(this);this.b.abr.enabled&&Y.Z("Changing tracks while abr manager is enabled will likely result in the selected track being overriden. Consider disabling abr before calling selectVariantTrack().");var i=r.variants.find((function(t){return t.id==e.id}));i?_n.Bb(i)?(Vs(this,r,i,!1),qs(this,i,t,n),this.Pb=new wo(i),$s(this,r.variants)):Y.error("Unable to switch to restricted track",e.id):Y.error("No variant with id",e.id)}else if(this.a&&this.a.audioTracks){for(n=(t=p(t=Array.from(this.a.audioTracks))).next();!n.done;n=t.next())n=n.value,_n.ed(n)==e.id&&(n.enabled=!0);tu(this)}},Rs.prototype.selectVariantTrack=Rs.prototype.pg,Rs.prototype.df=function(){return du(this.cd())},Rs.prototype.getAudioLanguagesAndRoles=Rs.prototype.df,Rs.prototype.Af=function(){return du(this.zb())},Rs.prototype.getTextLanguagesAndRoles=Rs.prototype.Af,Rs.prototype.cf=function(){return Array.from(fu(this.cd()))},Rs.prototype.getAudioLanguages=Rs.prototype.cf,Rs.prototype.zf=function(){return Array.from(fu(this.zb()))},Rs.prototype.getTextLanguages=Rs.prototype.zf,Rs.prototype.Dd=function(e,t){if(this.c&&this.o){var n=hu(this);this.Pb=new So(e,t||"",0,"","audio"),Qs(this,n)}else if(this.a&&this.a.audioTracks){var r=Array.from(this.a.audioTracks);n=Cn(e);for(var i=(r=p(r)).next();!i.done;i=r.next()){i=i.value;var o=_n.de(i);Cn(o.language)!=n||t&&!o.roles.includes(t)||(i.enabled=!0)}tu(this)}},Rs.prototype.selectAudioLanguage=Rs.prototype.Dd,Rs.prototype.Ed=function(e,t){if(this.c&&this.o){var n=hu(this);this.qa=e,this.nb=t||"";var r=_n.Sb(n.textStreams,this.qa,this.nb)[0]||null;r&&(Fs(this,n,r,!1),(this.b.streaming.alwaysStreamText||this.uc())&&Gs(this,r))}else{var i=Cn(e);(n=this.zb().filter((function(e){return Cn(e.language)==i&&(!t||e.roles.includes(t))}))[0])&&this.Fd(n)}},Rs.prototype.selectTextLanguage=Rs.prototype.Ed,Rs.prototype.qg=function(e){if(this.c&&this.o){for(var t=hu(this),n=null,r=p(pu(this)),i=r.next();!i.done;i=r.next())if((i=i.value).audio.label==e){n=i;break}null==n?Y.m("No variants were found with label: "+e+". Ignoring the request to switch."):(this.Pb=new So(n.language,"",0,e),Qs(this,t))}},Rs.prototype.selectVariantsByLabel=Rs.prototype.qg,Rs.prototype.uc=function(){var e=this.ob;return this.G?this.G.g.isTextVisible():this.a&&this.a.src&&this.a.textTracks?Bs(this).some((function(e){return"showing"==e.mode})):e},Rs.prototype.isTextTrackVisible=Rs.prototype.uc,Rs.prototype.tg=function(e){var t=this;return y((function n(){var r,i,o,a;return L(n,(function(n){switch(n.j){case 1:if(t.ob==(r=!!e))return n.return();if(t.ob=r,t.i!=Su){if(t.a&&t.a.src&&t.a.textTracks)for(var s=p(Bs(t)),u=s.next();!u.done;u=s.next())"disabled"!=(i=u.value).mode&&(i.mode=r?"showing":"hidden");n.C(2);break}if(t.G.g.setTextVisibility(r),t.b.streaming.alwaysStreamText){n.C(2);break}if(!r){!function(e){e.G=!0;var t=e.b.get("text");t&&(Oa(t),Ma(t).catch((function(){})),e.b.delete("text"))}(t.f),n.C(2);break}if(aa(t.f,"text")){n.C(2);break}if(o=hu(t),!(0<(a=_n.Sb(o.textStreams,t.qa,t.nb)).length)){n.C(2);break}return k(n,sa(t.f,a[0]),2);case 2:ru(t),x(n)}}))}))},Rs.prototype.setTextTrackVisibility=Rs.prototype.tg,Rs.prototype.vf=function(){if(!this.X())return Y.m("getPlayheadTimeAsDate is for live streams!"),null;var e=this.Ta.f,t=0;if(this.o)t=this.o.g();else if(e){if(null==e.startTime)return new Date;t=e.startTime}return this.c?new Date(1e3*(this.c.presentationTimeline.f+this.a.currentTime)):this.a&&this.a.getStartDate?(e=this.a.getStartDate(),isNaN(e.getTime())?(Y.m("EXT-X-PROGRAM-DATETIME required to get playhead time as Date!"),null):new Date(e.getTime()+1e3*t)):(Y.m("No way to get playhead time as Date!"),null)},Rs.prototype.getPlayheadTimeAsDate=Rs.prototype.vf,Rs.prototype.xf=function(){if(!this.X())return Y.m("getPresentationStartTimeAsDate is for live streams!"),null;if(this.c)return new Date(1e3*this.c.presentationTimeline.f);if(this.a&&this.a.getStartDate){var e=this.a.getStartDate();return isNaN(e.getTime())?(Y.m("EXT-X-PROGRAM-DATETIME required to get presentation start time as Date!"),null):e}return Y.m("No way to get presentation start time as Date!"),null},Rs.prototype.getPresentationStartTimeAsDate=Rs.prototype.xf,Rs.prototype.$c=function(){var e={total:[],audio:[],video:[],text:[]};return this.i==Tu&&(e.total=Kt(this.a.buffered)),this.i==Su&&this.G.$c(e),e},Rs.prototype.getBufferedInfo=Rs.prototype.$c,Rs.prototype.getStats=function(){if(this.i!=Su&&this.i!=Tu)return{width:NaN,height:NaN,streamBandwidth:NaN,decodedFrames:NaN,droppedFrames:NaN,corruptedFrames:NaN,estimatedBandwidth:NaN,loadLatency:NaN,playTime:NaN,pauseTime:NaN,bufferingTime:NaN,licenseTime:NaN,switchHistory:[],stateHistory:[]};Ys(this);var e=this.a;if(e.getVideoPlaybackQuality){e=e.getVideoPlaybackQuality();var t=this.v,n=Number(e.totalVideoFrames);t.o=Number(e.droppedVideoFrames),t.l=n,this.v.i=Number(e.corruptedVideoFrames)}this.h?e=(e=this.h).K?e.K:NaN:e=NaN,this.v.h=e,this.i==Su&&((e=yu(this))&&(this.v.u=e.bandwidth),e&&e.video&&(t=this.v,n=e.video.height||NaN,t.v=e.video.width||NaN,t.g=n),e=this.l.getBandwidthEstimate(),this.v.f=e);var r=this.v;e=r.v,t=r.g,n=r.u;for(var i=r.l,o=r.o,a=r.i,s=r.f,u=r.b,c=Os(r.a,"playing"),l=Os(r.a,"paused"),f=Os(r.a,"buffering"),d=r.h,h=function(e){function t(e){return{timestamp:e.timestamp,state:e.state,duration:e.duration}}for(var n=[],r=p(e.b),i=r.next();!i.done;i=r.next())n.push(t(i.value));return e.a&&n.push(t(e.a)),n}(r.a),y=[],m=(r=p(r.c.a)).next();!m.done;m=r.next())m=m.value,y.push({timestamp:m.timestamp,id:m.id,type:m.type,fromAdaptation:m.fromAdaptation,bandwidth:m.bandwidth});return{width:e,height:t,streamBandwidth:n,decodedFrames:i,droppedFrames:o,corruptedFrames:a,estimatedBandwidth:s,loadLatency:u,playTime:c,pauseTime:l,bufferingTime:f,licenseTime:d,stateHistory:h,switchHistory:y}},Rs.prototype.getStats=Rs.prototype.getStats,Rs.prototype.addTextTrack=function(e,t,n,r,i,o){var a=this;return y((function s(){var u,c,l,f,d,p,h,y,m;return L(s,(function(s){switch(s.j){case 1:if(a.i==Tu)throw Y.error("Cannot add text when loaded with src="),Error("State error!");if(a.i!=Su)throw Y.error("Must call load() and wait for it to resolve before adding text tracks."),Error("State error!");if(u=hu(a),c=Ht,l=a.c.periods.indexOf(u),d=(f=l+1)>=a.c.periods.length?a.c.presentationTimeline.ca():a.c.periods[f].startTime,1/0==(p=d-u.startTime))throw new he(1,4,4033);return h=new $r(1,0,p,(function(){return[e]}),0,null),y={id:a.ke++,originalId:null,createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(){return 1},getSegmentReference:function(e){return 1==e?h:null},initSegmentReference:null,presentationTimeOffset:0,mimeType:r,codecs:i||"",kind:n,encrypted:!1,keyId:null,language:t,label:o||null,type:c.va,primary:!1,frameRate:void 0,pixelAspectRatio:void 0,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],channelsCount:null,audioSamplingRate:null,closedCaptions:null},a.hc.add(y),u.textStreams.push(y),k(s,sa(a.f,y),2);case 2:return(m=aa(a.f,"text"))&&po(a.ea,u,m),a.hc.delete(y),Y.debug("Choosing new streams after adding a text stream"),Js(a,u),eu(a),s.return(_n.Fc(y))}}))}))},Rs.prototype.addTextTrack=Rs.prototype.addTextTrack,Rs.prototype.Hd=function(e,t){this.ic.width=e,this.ic.height=t},Rs.prototype.setMaxHardwareResolution=Rs.prototype.Hd,Rs.prototype.Cd=function(){if(this.i==Su){var e=this.f;if(e.f)Y.error("Unable to retry after StreamingEngine is destroyed!"),e=!1;else if(e.o)Y.error("Unable to retry after StreamingEngine encountered a fatal error!"),e=!1;else{for(var t=p(e.b.values()),n=t.next();!n.done;n=t.next()){var r=Ra(n=n.value);n.Xb&&(Y.info(r,"Retrying after failure..."),n.Xb=!1,Aa(e,n,.1))}e=!0}}else e=!1;return e},Rs.prototype.retryStreaming=Rs.prototype.Cd,Rs.prototype.kf=function(){return this.c},Rs.prototype.getManifest=Rs.prototype.kf,Rs.prototype.lf=function(){return this.u?this.u.constructor:null},Rs.prototype.getManifestParserFactory=Rs.prototype.lf,(i=Rs.prototype).Vc=function(e){var t=this.f?ia(this.f):null,n=this.f?oa(this.f):null;if(_n.filterNewPeriod(this.h,t,n,e),!(t=e.variants).some(_n.Bb))throw new he(2,4,4011);if(cu(this,e.variants),_n.Sd(t,this.b.restrictions,this.ic)&&this.f&&hu(this)==e&&eu(this),e=this.h?this.h.a:null)for(n=(t=p(t)).next();!n.done;n=t.next())for(var r=(n=p(n.value.drmInfos)).next();!r.done;r=n.next())if((r=r.value).keySystem==e.keySystem)for(var i=(r=p(r.initData||[])).next();!i.done;i=r.next())i=i.value,vt(this.h,i.initDataType,i.initData)},i.Lf=function(e){Y.debug("onChooseStreams_",e);try{Y.J("onChooseStreams_, choosing variant from ",e.variants),Y.J("onChooseStreams_, choosing text from ",e.textStreams),this.sb=!0,this.l.disable(),iu(this),Y.debug("Choosing new streams after period changed");var t=$s(this,e.variants),n=_n.Sb(e.textStreams,this.qa,this.nb)[0]||null;this.sa&&(e.variants.includes(this.sa)&&(t=this.sa),this.sa=null),this.ra&&(e.textStreams.includes(this.ra)&&(n=this.ra),this.ra=null),t&&Vs(this,e,t,!0),n&&Fs(this,e,n,!0);var r=this.f,i=r.b.get("video");if(i)var o=r.c.periods[i.ka];else{var a=r.b.get("audio");o=a?r.c.periods[a.ka]:null}var s=t?t.audio:null;if(!o&&n){var u;if(u=s){e=n;var c=Cn(this.b.preferredTextLanguage),l=Cn(s.language),f=Cn(e.language);u=In(f,c)&&!In(l,f)}u&&(this.ob=!0),this.ob&&this.G.g.setTextVisibility(!0),ru(this)}var d=this.b.streaming.alwaysStreamText||this.uc()?{variant:t,text:n}:{variant:t,text:null};return Y.J("onChooseStreams_, chose variant ",d.variant),Y.J("onChooseStreams_, chose text ",d.text),d}catch(e){return this.Qa(e),{variant:null,text:null}}},i.Se=function(){Y.debug("canSwitch_"),this.sb=!1,this.b.abr.enabled&&(this.l.enable(),iu(this)),this.sa&&(ca(this.f,this.sa,this.je,this.ge),tu(this),this.sa=null),this.ra&&(la(this.f,this.ra,!0,0,!1),nu(this),this.ra=null)},i.Qf=function(){this.u&&this.u.update&&this.u.update()},i.Vf=function(){this.o&&this.o.u()},i.Qa=function(e){if(this.i!=bu){var t=new Te("error",{detail:e});this.dispatchEvent(t),t.defaultPrevented&&(e.handled=!0)}};var bu=0,wu=1,Su=2,Tu=3;function Eu(e,t){var n=us(new ss(e.Aa(),e.fa()),t.periods[0],new yi(null,0)),r=t.appMetadata||{};return n=Pu(n),{offlineUri:e.toString(),originalManifestUri:t.originalManifestUri,duration:t.duration,size:t.size,expiration:t.expiration,tracks:n,appMetadata:r}}function Pu(e){for(var t=[],n=_n.sf(e.variants),r=(n=p(n)).next();!r.done;r=n.next())t.push(_n.Qd(r.value));for(n=(e=p(e.textStreams)).next();!n.done;n=e.next())t.push(_n.Fc(n.value));return t}function ku(){this.a={}}function xu(e,t){var n=t.audio,r=t.video;if(n&&!r&&(e.a[n.id]=n.bandwidth||t.bandwidth),!n&&r&&(e.a[r.id]=r.bandwidth||t.bandwidth),n&&r){var i=n.bandwidth||393216,o=r.bandwidth||t.bandwidth-i;0>=o&&(Y.m("Audio bit rate consumes variants bandwidth. Setting video bandwidth to match variant's bandwidth."),o=t.bandwidth),e.a[n.id]=i,e.a[r.id]=o}}function Au(e,t){var n=e.a[t];return null==n&&(n=0,Y.error("Asking for bitrate of stream not given to the estimator")),0==n&&Y.m("Using bitrate of 0, this stream won't affect progress"),n}function Ou(e){this.a=!1,this.b=new ye,this.c=e}function Mu(e){var t=new Ru;e.periods.forEach((function(e,n){var r=Du(e.variants);if(0==n)for(var i=(r=p(r.a)).next();!i.done;i=r.next())t.add(i.value);else!function(e,t){e.a=e.a.filter((function(e){return Cu(t,e)}))}(t,r)}));for(var n=(e=p(e.periods)).next();!n.done;n=e.next())(n=n.value).variants=n.variants.filter((function(e){return Cu(t,new Iu(e))}))}function Iu(e){var t=e.audio;e=e.video,this.b=t?t.mimeType:null,this.a=t?t.codecs.split(".")[0]:null,this.f=e?e.mimeType:null,this.c=e?e.codecs.split(".")[0]:null}function Ru(){this.a=[]}function Cu(e,t){return e.a.some((function(e){return t.b==e.b&&t.a==e.a&&t.f==e.f&&t.c==e.c}))}function Du(e){for(var t=new Ru,n=(e=p(e)).next();!n.done;n=e.next())t.add(new Iu(n.value));return t}function ju(e){var t=this;if(e&&e.constructor!=Rs)throw new he(2,9,9008);this.b=this.a=null,e?(this.a=e.b,this.b=e.Ub()):(this.a=Ps(),this.b=new Re),this.f=!1,this.c=[],this.g=[];var n=!e;this.h=new Ou((function(){return y((function e(){var r;return L(e,(function(e){switch(e.j){case 1:return r=function(){},k(e,Promise.all(t.g.map((function(e){return e.then(r,r)}))),2);case 2:if(!n){e.C(3);break}return k(e,t.b.destroy(),3);case 3:t.a=null,t.b=null,x(e)}}))}))}))}function Nu(){if($e())e:{for(var e=p(Ja.values()),t=e.next();!t.done;t=e.next())if(t=(t=t.value)()){t.destroy(),e=!0;break e}e=!1}else e=!1;return e}function _u(e,t){for(var n=[],r=p(e.periods),i=r.next();!i.done;i=r.next())for(var o=(i=p(i.value.streams)).next();!o.done;o=i.next())o=o.value,t&&"video"==o.contentType?n.push({contentType:We(o.mimeType,o.codecs),robustness:e.drmInfo.videoRobustness}):t||"audio"!=o.contentType||n.push({contentType:We(o.mimeType,o.codecs),robustness:e.drmInfo.audioRobustness});return n}function Lu(e,t,n){return y((function r(){return L(r,(function(r){switch(r.j){case 1:return k(r,function(e,t,n,r){return y((function i(){var o,a,s;return L(i,(function(i){switch(i.j){case 1:return r.drmInfo?(o=function(e){var t=Array.from(e.a.keys());if(!t.length)throw new he(2,9,9e3,"No supported storage mechanisms found");return e.a.get(t[0]).getEmeSessionCell()}(n),a=r.sessionIds.map((function(e){return{sessionId:e,keySystem:r.drmInfo.keySystem,licenseUri:r.drmInfo.licenseServerUri,serverCertificate:r.drmInfo.serverCertificate,audioCapabilities:_u(r,!1),videoCapabilities:_u(r,!0)}})),k(i,ps(t,e,a),2)):i.return();case 2:return s=i.s,k(i,o.remove(s),3);case 3:return k(i,o.add(a.filter((function(e){return-1==s.indexOf(e.sessionId)}))),0)}}))}))}(e.b,e.a.drm,n,t),0)}}))}))}function Uu(e,t,n,r){function i(){s+=1,e.a.offline.progressCallback(u,s/a)}var o=function(e){var t=[];return e.periods.forEach((function(e){e.streams.forEach((function(e){null!=e.initSegmentKey&&t.push(e.initSegmentKey),e.segments.forEach((function(e){t.push(e.dataKey)}))}))})),t}(r),a=o.length+1,s=0,u=Eu(n,r);return Promise.all([t.removeSegments(o,i),t.removeManifests([n.key()],i)])}function Ku(e,t,n,r,i,o){var a={id:o.id,originalId:o.originalId,primary:o.primary,presentationTimeOffset:o.presentationTimeOffset||0,contentType:o.type,mimeType:o.mimeType,codecs:o.codecs,frameRate:o.frameRate,pixelAspectRatio:o.pixelAspectRatio,kind:o.kind,language:o.language,label:o.label,width:o.width||null,height:o.height||null,initSegmentKey:null,encrypted:o.encrypted,keyId:o.keyId,segments:[],variantIds:[]};i=i.presentationTimeline.Wb();var s=o.id,u=o.initSegmentReference;return u&&(u=mi(u.c(),u.b,u.a,e.a.streaming.retryParameters),La(t,s,u,.5*Au(r,o.id),!0,(function(t){return y((function r(){var i;return L(r,(function(r){switch(r.j){case 1:return k(r,n.addSegments([{data:t}]),2);case 2:i=r.s,e.c.push(i[0]),a.initSegmentKey=i[0],x(r)}}))}))}))),function(e,t,n){for(var r=null==(t=e.findSegmentPosition(t))?null:e.getSegmentReference(t);r;)n(r),r=e.getSegmentReference(++t)}(o,i,(function(i){var u=mi(i.c(),i.b,i.a,e.a.streaming.retryParameters);La(t,s,u,function(e,t,n){return n=n.endTime-n.startTime,Au(e,t)*n}(r,o.id,i),!1,(function(t){return y((function r(){var o;return L(r,(function(r){switch(r.j){case 1:return k(r,n.addSegments([{data:t}]),2);case 2:o=r.s,e.c.push(o[0]),a.segments.push({startTime:i.startTime,endTime:i.endTime,dataKey:o[0]}),x(r)}}))}))}))})),a}function Bu(e){if(e.h.a)throw new he(2,9,7001)}function Vu(){if(!Nu())throw new he(2,9,9e3)}function Fu(e,t){return y((function n(){return L(n,(function(n){switch(n.j){case 1:return e.g.push(t),O(n,2),k(n,t,4);case 4:return n.return(n.s);case 2:R(n),Ae(e.g,t),C(n,0)}}))}))}function Hu(e){var t=new Set(e.variants.map((function(e){return e.video}))),n=new Set(e.variants.map((function(e){return e.audio})));e=e.textStreams,1<t.size&&Y.m("Multiple video tracks selected to be stored");for(var r=(t=p(n)).next();!r.done;r=t.next()){r=r.value;for(var i=p(n),o=i.next();!o.done;o=i.next())r!=(o=o.value)&&r.language==o.language&&Y.m("Similar audio tracks were selected to be stored",r.id,o.id)}for(t=(n=p(e)).next();!t.done;t=n.next())for(t=t.value,i=(r=p(e)).next();!i.done;i=r.next())t!=(i=i.value)&&t.language==i.language&&Y.m("Similar text tracks were selected to be stored",t.id,i.id)}Rs.LoadMode={DESTROYED:bu,NOT_LOADED:wu,MEDIA_SOURCE:Su,SRC_EQUALS:Tu},Ou.prototype.destroy=function(){var e=this;return this.a?this.b:(this.a=!0,this.c().then((function(){e.b.resolve()}),(function(){e.b.resolve()})))},Ru.prototype.add=function(e){Cu(this,e)||this.a.push(e)},H("shaka.offline.Storage",ju),ju.support=Nu,ju.prototype.destroy=function(){return this.h.destroy()},ju.prototype.destroy=ju.prototype.destroy,ju.prototype.configure=function(e,t){2==arguments.length&&"string"==typeof e&&(e=Ts(e,t));var n=e,r=!1;return null!=n.trackSelectionCallback&&(r=!0,n.offline=n.offline||{},n.offline.trackSelectionCallback=n.trackSelectionCallback,delete n.trackSelectionCallback),null!=n.progressCallback&&(r=!0,n.offline=n.offline||{},n.offline.progressCallback=n.progressCallback,delete n.progressCallback),null!=n.usePersistentLicense&&(r=!0,n.offline=n.offline||{},n.offline.usePersistentLicense=n.usePersistentLicense,delete n.usePersistentLicense),r&&Bn("Storage.configure with OfflineConfig","Please configure storage with a player configuration."),ks(this.a,e)},ju.prototype.configure=ju.prototype.configure,ju.prototype.getConfiguration=function(){var e=Ps();return ks(e,this.a,Ps()),e},ju.prototype.getConfiguration=ju.prototype.getConfiguration,ju.prototype.Ub=function(){return this.b},ju.prototype.getNetworkingEngine=ju.prototype.Ub,ju.prototype.store=function(e,t,n){var r=this;return Fu(this,function(e,t,n,r){return y((function i(){var o,a,s,u,c,l,f,d,h;return L(i,(function(i){switch(i.j){case 1:return Vu(),e.f?i.return(Promise.reject(new he(2,9,9006))):(e.f=!0,k(i,function(e,t,n){return y((function r(){var i,o,a,s,u,c;return L(r,(function(r){switch(r.j){case 1:return i=null,o=e.b,a={networkingEngine:o,filterAllPeriods:function(){},filterNewPeriod:function(){},onTimelineRegionAdded:function(){},onEvent:function(){},onError:function(e){i=e}},k(r,n(),2);case 2:return(s=r.s).configure(e.a.manifest),Bu(e),O(r,3),k(r,s.start(t,a),5);case 5:return u=r.s,Bu(e),c=function(e){for(var t=new Set,n=(e=p(e.periods)).next();!n.done;n=e.next()){for(var r=p((n=n.value).textStreams),i=r.next();!i.done;i=r.next())t.add(i.value);for(n=p(n.variants),r=n.next();!r.done;r=n.next())(r=r.value).audio&&t.add(r.audio),r.video&&t.add(r.video)}return t}(u),k(r,Promise.all(He(c,(function(e){return e.createSegmentIndex()}))),6);case 6:if(Bu(e),i)throw i;return r.return(u);case 3:return R(r),k(r,s.stop(),7);case 7:C(r,0)}}))}))}(e,t,r),2));case 2:if(o=i.s,Bu(e),!(!o.presentationTimeline.X()&&!o.presentationTimeline.bb()))throw new he(2,9,9005,t);return a=null,s=new Xa,c=u=null,A(i,3,4),k(i,function(e,t,n){return y((function r(){var i,o,a;return L(r,(function(r){switch(r.j){case 1:return i=new dt({Db:e.b,onError:n,yc:function(){},onExpirationUpdated:function(){},onEvent:function(){}}),o=Do(t.periods),a=e.a,i.configure(a.drm),k(r,function(e,t,n){return e.u=[],e.G=n,ht(e,t)}(i,o,a.offline.usePersistentLicense),2);case 2:return k(r,yt(i),3);case 3:return k(r,mt(i),4);case 4:return r.return(i)}}))}))}(e,o,(function(e){c=c||e})),6);case 6:if(a=i.s,Bu(e),c)throw c;return k(i,function(e,t,n){return y((function r(){var i,o;return L(r,(function(r){switch(r.j){case 1:return i={width:1/0,height:1/0},function(e,t,n){for(var r=(e=p(e.periods)).next();!r.done;r=e.next())(r=r.value).variants=r.variants.filter((function(e){return _n.ld(e,t,n)}))}(t,e.a.restrictions,i),function(e){for(var t=(e=p(e.periods)).next();!t.done;t=e.next())(t=t.value).variants=t.variants.filter((function(e){var t=!0;return e.audio&&(t=t&&gn(e.audio)),e.video&&(t=t&&gn(e.video)),t}))}(t),function(e,t){for(var n=p(e.periods),r=n.next();!r.done;r=n.next())(r=r.value).variants=r.variants.filter((function(e){return At(t,e)}))}(t,n),Mu(t),o=e.a.preferredAudioChannelCount,_n.Vd(t,o),k(r,function(e,t){return y((function n(){var r,i,o,a;return L(n,(function(n){switch(n.j){case 1:r=null,i=p(e.periods),o=i.next();case 2:if(o.done){n.C(0);break}return a=o.value,r&&(a.variants=a.variants.filter((function(e){return Cu(r,new Iu(e))}))),k(n,t(a),5);case 5:r=Du(a.variants),o=i.next(),n.C(2)}}))}))}(t,(function(t){return y((function n(){var r,i,o,a,s,u,c,l;return L(n,(function(n){switch(n.j){case 1:r=_n,i=[];for(var f=p(t.variants),d=f.next();!d.done;d=f.next())o=d.value,i.push(r.Qd(o));for(d=(f=p(t.textStreams)).next();!d.done;d=f.next())a=d.value,i.push(r.Fc(a));return k(n,e.a.offline.trackSelectionCallback(i),2);case 2:for(s=n.s,u=new Set,c=new Set,d=(f=p(s)).next();!d.done;d=f.next())"variant"==(l=d.value).type&&u.add(l.id),"text"==l.type&&c.add(l.id);t.variants=t.variants.filter((function(e){return u.has(e.id)})),t.textStreams=t.textStreams.filter((function(e){return c.has(e.id)})),x(n)}}))}))})),2);case 2:(function(e){if(0==e.periods.length)throw new he(2,4,4014);for(var t=(e=p(e.periods)).next();!t.done;t=e.next())Hu(t.value)})(t),x(r)}}))}))}(e,o,a),7);case 7:return k(i,s.init(),8);case 8:return Bu(e),k(i,function(e){var t=null;if(e.a.forEach((function(e,n){e.getCells().forEach((function(e,r){e.hasFixedKeySpace()||t||(t={path:{Aa:n,fa:r},fa:e})}))})),t)return t;throw new he(2,9,9013,"Could not find a cell that supports add-operations")}(s),9);case 9:return u=i.s,Bu(e),k(i,function(e,t,n,r,i,o){return y((function a(){var s,u,c,l,f,d,h,m,v,g;return L(a,(function(a){switch(a.j){case 1:return s=function(e,t,n){var r=null==t.expiration?1/0:t.expiration;return{offlineUri:null,originalManifestUri:e,duration:t.presentationTimeline.ca(),size:0,expiration:r,tracks:t=Pu(t.periods[0]),appMetadata:n}}(i,r,o),u=r.periods.some((function(e){return e.variants.some((function(e){return e.drmInfos&&e.drmInfos.length}))})),c=r.periods.some((function(e){return e.variants.some((function(e){return e.drmInfos.some((function(e){return e.initData&&e.initData.length}))}))})),f=null,(l=u&&!c)&&(d=n.a,f=zu.get(d.keySystem)),h=new _a(e.b,(function(t,n){s.size=n,e.a.offline.progressCallback(s,t)}),(function(t,r){l&&e.a.offline.usePersistentLicense&&f==r&&vt(n,"cenc",t)})),O(a,2),v=m=function(e,t,n,r,i,o,a){var s=new ku,u=i.periods.map((function(r){return function(e,t,n,r,i,o){for(var a=p(o.variants),s=a.next();!s.done;s=a.next())xu(r,s.value);for(a=p(o.textStreams),s=a.next();!s.done;s=a.next())r.a[s.value.id]=52;a=function(e){for(var t=new Set,n=p(e.textStreams),r=n.next();!r.done;r=n.next())t.add(r.value);for(e=p(e.variants),n=e.next();!n.done;n=e.next())(n=n.value).audio&&t.add(n.audio),n.video&&t.add(n.video);return t}(o);var u=new Map;for(a=p(a),s=a.next();!s.done;s=a.next()){s=s.value;var c=Ku(e,t,n,r,i,s);u.set(s.id,c)}return o.variants.forEach((function(e){e.audio&&u.get(e.audio.id).variantIds.push(e.id),e.video&&u.get(e.video.id).variantIds.push(e.id)})),{startTime:o.startTime,streams:Array.from(u.values())}}(e,t,n,s,i,r)})),c=r.a,l=e.a.offline.usePersistentLicense;return c&&l&&(c.initData=[]),{originalManifestUri:o,duration:i.presentationTimeline.ca(),size:0,expiration:r.Tb(),periods:u,sessionIds:l?wt(r):[],drmInfo:c,appMetadata:a}}(e,h,t,n,r,i,o),k(a,function(e){return y((function t(){return L(t,(function(t){switch(t.j){case 1:return k(t,Promise.all(e.b.values()),2);case 2:return t.return(e.a.a)}}))}))}(h),4);case 4:if(v.size=a.s,m.expiration=n.Tb(),g=wt(n),m.sessionIds=e.a.offline.usePersistentLicense?g:[],u&&e.a.offline.usePersistentLicense&&!g.length)throw new he(2,9,9007);return a.return(m);case 2:return R(a),k(a,h.destroy(),5);case 5:C(a,0)}}))}))}(e,u.fa,a,o,t,n),10);case 10:if(l=i.s,Bu(e),c)throw c;return k(i,u.fa.addManifests([l]),11);case 11:return f=i.s,Bu(e),d=new os("manifest",u.path.Aa,u.path.fa,f[0]),i.return(Eu(d,l));case 4:return R(i),e.f=!1,e.c=[],k(i,s.destroy(),12);case 12:if(!a){i.C(13);break}return k(i,a.destroy(),13);case 13:C(i,0);break;case 3:if(h=I(i),!u){i.C(15);break}return k(i,u.fa.removeSegments(e.c,(function(){})),15);case 15:throw c||h}}))}))}(this,e,t||{},(function(){return y((function t(){var i,o;return L(t,(function(t){switch(t.j){case 1:return n&&"string"!=typeof n?(Bn("Storing with a manifest parser factory","Please register a manifest parser and for the mime-type."),i=n,t.return(new i)):k(t,hi.create(e,r.b,r.a.manifest.retryParameters,n),2);case 2:return o=t.s,t.return(o)}}))}))})))},ju.prototype.store=ju.prototype.store,ju.prototype.yf=function(){return this.f},ju.prototype.getStoreInProgress=ju.prototype.yf,ju.prototype.remove=function(e){return Fu(this,function(e,t){return y((function n(){var r,i,o,a,s,u;return L(n,(function(n){switch(n.j){case 1:return Vu(),null==(r=as(t))||"manifest"!=r.a?n.return(Promise.reject(new he(2,9,9004,t))):(i=r,o=new Xa,O(n,2),k(n,o.init(),4));case 4:return k(n,Ya(o,i.Aa(),i.fa()),5);case 5:return k(n,(a=n.s).getManifests([i.key()]),6);case 6:return s=n.s,u=s[0],k(n,Promise.all([Lu(e,u,o),Uu(e,a,i,u)]),2);case 2:return R(n),k(n,o.destroy(),8);case 8:C(n,0)}}))}))}(this,e))},ju.prototype.remove=ju.prototype.remove,ju.prototype.ig=function(){return Fu(this,function(e){return y((function t(){var n,r,i,o,a,s,u,c,l;return L(t,(function(t){switch(t.j){case 1:return Vu(),n=e.b,r=e.a.drm,i=new Xa,o=!1,O(t,2),k(t,i.init(),4);case 4:for(a=[],function(e,t){e.a.forEach((function(e){t(e.getEmeSessionCell())}))}(i,(function(e){return a.push(e)})),s=Promise.resolve(),u={},c=p(a),l=c.next();!l.done;u={Ec:u.Ec},l=c.next())u.Ec=l.value,s=s.then(function(e){return function(){return y((function t(){var i,a;return L(t,(function(t){switch(t.j){case 1:return k(t,e.Ec.getAll(),2);case 2:return i=t.s,k(t,ps(r,n,i),3);case 3:return a=t.s,k(t,e.Ec.remove(a),4);case 4:a.length!=i.length&&(o=!0),x(t)}}))}))}}(u));return k(t,s,2);case 2:return R(t),k(t,i.destroy(),6);case 6:C(t,3);break;case 3:return t.return(!o)}}))}))}(this))},ju.prototype.removeEmeSessions=ju.prototype.ig,ju.prototype.list=function(){return Fu(this,y((function e(){var t,n,r;return L(e,(function(e){switch(e.j){case 1:return Vu(),t=[],n=new Xa,O(e,2),k(e,n.init(),4);case 4:return r=Promise.resolve(),function(e,t){e.a.forEach((function(e,n){e.getCells().forEach((function(e,r){t({Aa:n,fa:r},e)}))}))}(n,(function(e,n){r=r.then((function(){return y((function r(){return L(r,(function(r){switch(r.j){case 1:return k(r,n.getAllManifests(),2);case 2:r.s.forEach((function(n,r){var i=Eu(new os("manifest",e.Aa,e.fa,r),n);t.push(i)})),x(r)}}))}))}))})),k(e,r,2);case 2:return R(e),k(e,n.destroy(),6);case 6:C(e,3);break;case 3:return e.return(t)}}))})))},ju.prototype.list=ju.prototype.list,ju.deleteAll=function(){return y((function e(){var t;return L(e,(function(e){switch(e.j){case 1:return t=new Xa,O(e,2),k(e,t.erase(),2);case 2:return R(e),k(e,t.destroy(),5);case 5:C(e,0)}}))}))};var zu=(new Map).set("org.w3.clearkey","1077efecc0b24d02ace33c1e52e2fb4b").set("com.widevine.alpha","edef8ba979d64acea3c827dcd51d21ed").set("com.microsoft.playready","9a04f07998404286ab92e65be0885f95").set("com.adobe.primetime","f239e769efa348509c16a903c6932efb");js.offline=Nu,H("shaka.polyfill.installAll",(function(){for(var e=0;e<Wu.length;++e)try{Wu[e].Qe()}catch(e){Y.Z("Error installing polyfill!",e)}}));var qu,Gu,Wu=[];function Xu(e,t){for(var n={priority:t=t||0,Qe:e},r=0;r<Wu.length;r++)if(Wu[r].priority<t)return void Wu.splice(r,0,n);Wu.push(n)}function Yu(e){var t=e.type.replace(/^(webkit|moz|MS)/,"").toLowerCase();if("function"==typeof Event)var n=new Event(t,e);else(n=document.createEvent("Event")).initEvent(t,e.bubbles,e.cancelable);e.target.dispatchEvent(n)}function $u(e,t,n){if("input"==e)switch(this.type){case"range":e="change"}HTMLInputElement.prototype.originalAddEventListener.call(this,e,t,n)}function Ju(){var e=MediaSource.prototype.addSourceBuffer;MediaSource.prototype.addSourceBuffer=function(t){for(var n=[],r=0;r<arguments.length;++r)n[r]=arguments[r];return(n=e.apply(this,n)).abort=function(){},n}}function Qu(e,t){Y.debug("PatchedMediaKeysApple.requestMediaKeySystemAccess");try{var n=new Zu(e,t);return Promise.resolve(n)}catch(e){return Promise.reject(e)}}function Zu(e,t){if(Y.debug("PatchedMediaKeysApple.MediaKeySystemAccess"),this.keySystem=e,e.startsWith("com.apple.fps"))for(var n=p(t),r=n.next();!r.done;r=n.next()){var i=r.value;if("required"==i.persistentState)r=null;else{r={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:i.initDataTypes,sessionTypes:["temporary"],label:i.label};var o=!1,a=!1;if(i.audioCapabilities)for(var s=p(i.audioCapabilities),u=s.next();!u.done;u=s.next())if((u=u.value).contentType){o=!0;var c=u.contentType.split(";")[0];WebKitMediaKeys.isTypeSupported(this.keySystem,c)&&(r.audioCapabilities.push(u),a=!0)}if(i.videoCapabilities)for(u=(i=p(i.videoCapabilities)).next();!u.done;u=i.next())(s=u.value).contentType&&(o=!0,u=s.contentType.split(";")[0],WebKitMediaKeys.isTypeSupported(this.keySystem,u)&&(r.videoCapabilities.push(s),a=!0));o||(a=WebKitMediaKeys.isTypeSupported(this.keySystem,"video/mp4")),r=a?r:null}if(r)return void(this.a=r)}throw(n=Error("Unsupported keySystem")).name="NotSupportedError",n.code=DOMException.NOT_SUPPORTED_ERR,n}function ec(e){Y.debug("PatchedMediaKeysApple.setMediaKeys");var t=this.mediaKeys;return t&&t!=e&&nc(t,null),delete this.mediaKeys,(this.mediaKeys=e)?nc(e,this):Promise.resolve()}function tc(e){Y.debug("PatchedMediaKeysApple.MediaKeys"),this.b=new WebKitMediaKeys(e),this.a=new Ue}function nc(e,t){if(e.a.hb(),!t)return Promise.resolve();e.a.B(t,"webkitneedkey",ic);try{return Uo(t,HTMLMediaElement.HAVE_METADATA,e.a,(function(){t.webkitSetMediaKeys(e.b)})),Promise.resolve()}catch(e){return Promise.reject(e)}}function rc(e){Y.debug("PatchedMediaKeysApple.MediaKeySession"),Pe.call(this),this.b=null,this.g=e,this.c=this.a=null,this.f=new Ue,this.sessionId="",this.expiration=NaN,this.closed=new ye,this.keyStatuses=new ac}function ic(e){if(Y.debug("PatchedMediaKeysApple.onWebkitNeedKey_",e),e=new Uint8Array(e.initData),new DataView(e.buffer,e.byteOffset,e.byteLength).getUint32(0,!0)+4!=e.byteLength)throw new RangeError("Malformed FairPlay init data");e=st(e=ot(e.subarray(4),!0));var t=new Event("encrypted");t.initDataType="skd",t.initData=e,this.dispatchEvent(t)}function oc(e,t){var n=e.keyStatuses;n.size=null==t?0:1,n.a=t,e.dispatchEvent(new Te("keystatuseschange"))}function ac(){this.size=0,this.a=void 0}function sc(e,t){Y.debug("PatchedMediaKeysMs.requestMediaKeySystemAccess");try{var n=new uc(e,t);return Promise.resolve(n)}catch(e){return Promise.reject(e)}}function uc(e,t){Y.debug("PatchedMediaKeysMs.MediaKeySystemAccess"),this.keySystem=e;for(var n=!1,r=0;r<t.length;++r){var i=t[r],o={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:i.initDataTypes,sessionTypes:["temporary"],label:i.label},a=!1;if(i.audioCapabilities)for(var s=0;s<i.audioCapabilities.length;++s){var u=i.audioCapabilities[s];if(u.contentType){a=!0;var c=u.contentType.split(";")[0];MSMediaKeys.isTypeSupported(this.keySystem,c)&&(o.audioCapabilities.push(u),n=!0)}}if(i.videoCapabilities)for(s=0;s<i.videoCapabilities.length;++s)(u=i.videoCapabilities[s]).contentType&&(a=!0,c=u.contentType.split(";")[0],MSMediaKeys.isTypeSupported(this.keySystem,c)&&(o.videoCapabilities.push(u),n=!0));if(a||(n=MSMediaKeys.isTypeSupported(this.keySystem,"video/mp4")),"required"==i.persistentState&&(n=!1),n)return void(this.a=o)}throw(n=Error("Unsupported keySystem")).name="NotSupportedError",n.code=DOMException.NOT_SUPPORTED_ERR,n}function cc(e){Y.debug("PatchedMediaKeysMs.setMediaKeys");var t=this.mediaKeys;return t&&t!=e&&fc(t,null),delete this.mediaKeys,(this.mediaKeys=e)?fc(e,this):Promise.resolve()}function lc(e){Y.debug("PatchedMediaKeysMs.MediaKeys"),this.b=new MSMediaKeys(e),this.a=new Ue}function fc(e,t){if(e.a.hb(),!t)return Promise.resolve();e.a.B(t,"msneedkey",pc);try{return Uo(t,HTMLMediaElement.HAVE_METADATA,e.a,(function(){t.msSetMediaKeys(e.b)})),Promise.resolve()}catch(e){return Promise.reject(e)}}function dc(e){Y.debug("PatchedMediaKeysMs.MediaKeySession"),Pe.call(this),this.c=null,this.g=e,this.b=this.a=null,this.f=new Ue,this.sessionId="",this.expiration=NaN,this.closed=new ye,this.keyStatuses=new yc}function pc(e){if(Y.debug("PatchedMediaKeysMs.onMsNeedKey_",e),e.initData){var t=document.createEvent("CustomEvent");t.initCustomEvent("encrypted",!1,!1,null),t.initDataType="cenc",t.initData=function(e){if(!e)return e;var t=new Lr(e);if(1>=t.data.length)return e;e=[];for(var n={},r=(t=p(t.data)).next();!r.done;n={tc:n.tc},r=t.next())n.tc=r.value,e.some(function(e){return function(t){return ft.Da(t,e.tc)}}(n))||e.push(n.tc);return ft.concat.apply(ft,e instanceof Array?e:function(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n}(p(e)))}(e.initData).buffer,this.dispatchEvent(t)}}function hc(e,t){var n=e.keyStatuses;n.size=null==t?0:1,n.a=t,e.dispatchEvent(new Te("keystatuseschange"))}function yc(){this.size=0,this.a=void 0}function mc(){return Y.debug("PatchedMediaKeysNop.requestMediaKeySystemAccess"),Promise.reject(Error("The key system specified is not supported."))}function vc(e){return Y.debug("PatchedMediaKeysNop.setMediaKeys"),null==e?Promise.resolve():Promise.reject(Error("MediaKeys not supported."))}function gc(){throw new TypeError("Illegal constructor.")}function bc(){throw new TypeError("Illegal constructor.")}H("shaka.polyfill.register",Xu),Xu((function(){Il()}),-1),Xu((function(){if(e.Document){var t=Element.prototype;t.requestFullscreen=t.requestFullscreen||t.mozRequestFullScreen||t.msRequestFullscreen||t.webkitRequestFullscreen,(t=Document.prototype).exitFullscreen=t.exitFullscreen||t.mozCancelFullScreen||t.msExitFullscreen||t.webkitCancelFullScreen,"fullscreenElement"in document||(Object.defineProperty(document,"fullscreenElement",{get:function(){return document.mozFullScreenElement||document.msFullscreenElement||document.webkitCurrentFullScreenElement||document.webkitFullscreenElement}}),Object.defineProperty(document,"fullscreenEnabled",{get:function(){return document.mozFullScreenEnabled||document.msFullscreenEnabled||document.webkitFullscreenEnabled}})),document.addEventListener("webkitfullscreenchange",Yu),document.addEventListener("webkitfullscreenerror",Yu),document.addEventListener("mozfullscreenchange",Yu),document.addEventListener("mozfullscreenerror",Yu),document.addEventListener("MSFullscreenChange",Yu),document.addEventListener("MSFullscreenError",Yu)}})),Xu((function(){Y.debug("IndexedDB.install");var t=!1;if(et("CrKey"))Y.debug("Removing IndexedDB from ChromeCast"),t=!0;else try{e.indexedDB&&(t=!1)}catch(e){Y.debug("Removing IndexedDB due to an exception when accessing it"),t=!0}t&&delete e.indexedDB})),Xu((function(){Y.debug("InputEvent.install"),et("Trident/")&&!HTMLInputElement.prototype.originalAddEventListener&&(Y.info("Patching input event support on IE."),HTMLInputElement.prototype.originalAddEventListener=HTMLInputElement.prototype.addEventListener,HTMLInputElement.prototype.addEventListener=$u)})),Xu((function(){navigator.languages||Object.defineProperty(navigator,"languages",{get:function(){return navigator.language?[navigator.language]:["en"]}})})),Xu((function(){Y.debug("mathRound.install")})),Xu((function(){Y.debug("MediaSource.install");var t=Ze();e.MediaSource?e.cast&&cast.__platform__&&cast.__platform__.canDisplayType?(Y.info("Patching Chromecast MSE bugs."),function(){var e=MediaSource.isTypeSupported,t=/^dv(?:h[e1]|a[v1])\./;MediaSource.isTypeSupported=function(n){for(var r=n.split(/ *; */),i=r[0],o={},a=1;a<r.length;++a){var s=r[a].split("="),u=s[0];s=s[1].replace(/"(.*)"/,"$1"),o[u]=s}if(!(r=o.codecs))return e(n);var c=!1,l=!1;for(var f in n=r.split(",").filter((function(e){return t.test(e)&&(l=!0),/^(hev|hvc)1\.2/.test(e)&&(c=!0),!0})),l&&(c=!1),o.codecs=n.join(","),c&&(o.eotf="smpte2084"),o)i+="; "+f+'="'+o[f]+'"';return cast.__platform__.canDisplayType(i)}}()):t?(function(){var e=MediaSource.isTypeSupported;MediaSource.isTypeSupported=function(t){return"mp2t"!=t.split(/ *; */)[0].split("/")[1].toLowerCase()&&e(t)}}(),12>=t?(Y.info("Patching Safari 11 & 12 MSE bugs."),Ju(),function(){var e=SourceBuffer.prototype.remove;SourceBuffer.prototype.remove=function(t,n){return e.call(this,t,n-.001)}}()):(Y.info("Patching Safari 13 MSE bugs."),Ju())):et("Tizen 2")||et("Tizen 3")||et("Tizen 4")?function(){var e=MediaSource.isTypeSupported;MediaSource.isTypeSupported=function(t){return"opus"!=Xe(t)[0]&&e(t)}}():Y.info("Using native MSE as-is."):Y.info("No MSE implementation available.")})),Zu.prototype.createMediaKeys=function(){Y.debug("PatchedMediaKeysApple.MediaKeySystemAccess.createMediaKeys");var e=new tc(this.keySystem);return Promise.resolve(e)},Zu.prototype.getConfiguration=function(){return Y.debug("PatchedMediaKeysApple.MediaKeySystemAccess.getConfiguration"),this.a},tc.prototype.createSession=function(e){if(Y.debug("PatchedMediaKeysApple.MediaKeys.createSession"),"temporary"!=(e=e||"temporary"))throw new TypeError("Session type "+e+" is unsupported on this platform.");return new rc(this.b,e)},tc.prototype.setServerCertificate=function(e){return Y.debug("PatchedMediaKeysApple.MediaKeys.setServerCertificate"),e&&new Uint8Array(e),Promise.resolve(!0)},z(rc,Pe),(i=rc.prototype).generateRequest=function(e,t){Y.debug("PatchedMediaKeysApple.MediaKeySession.generateRequest"),this.a=new ye;try{this.b=this.g.createSession("video/mp4",new Uint8Array(t)),this.sessionId=this.b.sessionId||"",this.f.B(this.b,"webkitkeymessage",this.yg.bind(this)),this.f.B(this.b,"webkitkeyadded",this.wg.bind(this)),this.f.B(this.b,"webkitkeyerror",this.xg.bind(this)),oc(this,"status-pending")}catch(e){this.a.reject(e)}return this.a},i.load=function(){return Y.debug("PatchedMediaKeysApple.MediaKeySession.load"),Promise.reject(Error("MediaKeySession.load not yet supported"))},i.update=function(e){Y.debug("PatchedMediaKeysApple.MediaKeySession.update"),this.c=new ye;try{this.b.update(new Uint8Array(e))}catch(e){this.c.reject(e)}return this.c},i.close=function(){Y.debug("PatchedMediaKeysApple.MediaKeySession.close");try{this.b.close(),this.closed.resolve(),this.f.hb()}catch(e){this.closed.reject(e)}return this.closed},i.remove=function(){return Y.debug("PatchedMediaKeysApple.MediaKeySession.remove"),Promise.reject(Error("MediaKeySession.remove is only applicable for persistent licenses, which are not supported on this platform"))},i.yg=function(e){Y.debug("PatchedMediaKeysApple.onWebkitKeyMessage_",e),this.a&&(this.a.resolve(),this.a=null),this.dispatchEvent(new Te("message",{messageType:null==this.keyStatuses.a?"license-request":"license-renewal",message:e.message.buffer}))},i.wg=function(e){Y.debug("PatchedMediaKeysApple.onWebkitKeyAdded_",e),this.c&&(oc(this,"usable"),this.c.resolve(),this.c=null)},i.xg=function(e){if(Y.debug("PatchedMediaKeysApple.onWebkitKeyError_",e),(e=Error("EME PatchedMediaKeysApple key error")).errorCode=this.b.error,null!=this.a)this.a.reject(e),this.a=null;else if(null!=this.c)this.c.reject(e),this.c=null;else switch(this.b.error.code){case WebKitMediaKeyError.MEDIA_KEYERR_OUTPUT:case WebKitMediaKeyError.MEDIA_KEYERR_HARDWARECHANGE:oc(this,"output-not-allowed");break;default:oc(this,"internal-error")}},(i=ac.prototype).forEach=function(e){this.a&&e(this.a,qu)},i.get=function(e){if(this.has(e))return this.a},i.has=function(e){var t=qu;return!(!this.a||!ft.Da(new Uint8Array(e),new Uint8Array(t)))},i.entries=function(){},i.keys=function(){},i.values=function(){},Xu((function(){e.HTMLVideoElement&&e.WebKitMediaKeys&&(Y.info("Using Apple-prefixed EME"),qu=new Uint8Array([0]).buffer,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=ec,e.MediaKeys=tc,e.MediaKeySystemAccess=Zu,navigator.requestMediaKeySystemAccess=Qu)})),uc.prototype.createMediaKeys=function(){Y.debug("PatchedMediaKeysMs.MediaKeySystemAccess.createMediaKeys");var e=new lc(this.keySystem);return Promise.resolve(e)},uc.prototype.getConfiguration=function(){return Y.debug("PatchedMediaKeysMs.MediaKeySystemAccess.getConfiguration"),this.a},lc.prototype.createSession=function(e){if(Y.debug("PatchedMediaKeysMs.MediaKeys.createSession"),"temporary"!=(e=e||"temporary"))throw new TypeError("Session type "+e+" is unsupported on this platform.");return new dc(this.b,e)},lc.prototype.setServerCertificate=function(){return Y.debug("PatchedMediaKeysMs.MediaKeys.setServerCertificate"),Promise.resolve(!1)},z(dc,Pe),(i=dc.prototype).generateRequest=function(e,t){Y.debug("PatchedMediaKeysMs.MediaKeySession.generateRequest"),this.a=new ye;try{this.c=this.g.createSession("video/mp4",new Uint8Array(t),null),this.f.B(this.c,"mskeymessage",this.Uf.bind(this)),this.f.B(this.c,"mskeyadded",this.Sf.bind(this)),this.f.B(this.c,"mskeyerror",this.Tf.bind(this)),hc(this,"status-pending")}catch(e){this.a.reject(e)}return this.a},i.load=function(){return Y.debug("PatchedMediaKeysMs.MediaKeySession.load"),Promise.reject(Error("MediaKeySession.load not yet supported"))},i.update=function(e){Y.debug("PatchedMediaKeysMs.MediaKeySession.update"),this.b=new ye;try{this.c.update(new Uint8Array(e))}catch(e){this.b.reject(e)}return this.b},i.close=function(){Y.debug("PatchedMediaKeysMs.MediaKeySession.close");try{this.c.close(),this.closed.resolve(),this.f.hb()}catch(e){this.closed.reject(e)}return this.closed},i.remove=function(){return Y.debug("PatchedMediaKeysMs.MediaKeySession.remove"),Promise.reject(Error("MediaKeySession.remove is only applicable for persistent licenses, which are not supported on this platform"))},i.Uf=function(e){Y.debug("PatchedMediaKeysMs.onMsKeyMessage_",e),this.a&&(this.a.resolve(),this.a=null),this.dispatchEvent(new Te("message",{messageType:null==this.keyStatuses.a?"license-request":"license-renewal",message:e.message.buffer}))},i.Sf=function(e){Y.debug("PatchedMediaKeysMs.onMsKeyAdded_",e),this.a?(Y.debug("Simulating completion for a PR persistent license."),hc(this,"usable"),this.a.resolve(),this.a=null):this.b&&(hc(this,"usable"),this.b.resolve(),this.b=null)},i.Tf=function(e){if(Y.debug("PatchedMediaKeysMs.onMsKeyError_",e),(e=Error("EME PatchedMediaKeysMs key error")).errorCode=this.c.error,null!=this.a)this.a.reject(e),this.a=null;else if(null!=this.b)this.b.reject(e),this.b=null;else switch(this.c.error.code){case MSMediaKeyError.MS_MEDIA_KEYERR_OUTPUT:case MSMediaKeyError.MS_MEDIA_KEYERR_HARDWARECHANGE:hc(this,"output-not-allowed");break;default:hc(this,"internal-error")}},(i=yc.prototype).forEach=function(e){this.a&&e(this.a,Gu)},i.get=function(e){if(this.has(e))return this.a},i.has=function(e){var t=Gu;return!(!this.a||!ft.Da(new Uint8Array(e),new Uint8Array(t)))},i.entries=function(){},i.keys=function(){},i.values=function(){},Xu((function(){!e.HTMLVideoElement||!e.MSMediaKeys||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration||(Y.info("Using ms-prefixed EME v20140218"),Gu=new Uint8Array([0]).buffer,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=cc,e.MediaKeys=lc,e.MediaKeySystemAccess=uc,navigator.requestMediaKeySystemAccess=sc)})),gc.prototype.createSession=function(){},gc.prototype.setServerCertificate=function(){},bc.prototype.getConfiguration=function(){},bc.prototype.createMediaKeys=function(){},Xu((function(){!e.HTMLVideoElement||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration||(Y.info("EME not available."),navigator.requestMediaKeySystemAccess=mc,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=vc,e.MediaKeys=gc,e.MediaKeySystemAccess=bc)}),-10);var wc,Sc="";function Tc(e){return Sc?Sc+e.charAt(0).toUpperCase()+e.slice(1):e}function Ec(e,t){Y.debug("PatchedMediaKeysWebkit.requestMediaKeySystemAccess");try{var n=new kc(e,t);return Promise.resolve(n)}catch(e){return Promise.reject(e)}}function Pc(e){Y.debug("PatchedMediaKeysWebkit.setMediaKeys");var t=this.mediaKeys;return t&&t!=e&&Ac(t,null),delete this.mediaKeys,(this.mediaKeys=e)&&Ac(e,this),Promise.resolve()}function kc(e,t){Y.debug("PatchedMediaKeysWebkit.MediaKeySystemAccess"),this.a=this.keySystem=e;var n=!1;"org.w3.clearkey"==e&&(this.a="webkit-org.w3.clearkey",n=!1);var r=!1,i=document.getElementsByTagName("video");i=i.length?i[0]:document.createElement("video");for(var o=0;o<t.length;++o){var a=t[o],s={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:a.initDataTypes,sessionTypes:["temporary"],label:a.label},u=!1;if(a.audioCapabilities)for(var c=0;c<a.audioCapabilities.length;++c){var l=a.audioCapabilities[c];if(l.contentType){u=!0;var f=l.contentType.split(";")[0];i.canPlayType(f,this.a)&&(s.audioCapabilities.push(l),r=!0)}}if(a.videoCapabilities)for(c=0;c<a.videoCapabilities.length;++c)(l=a.videoCapabilities[c]).contentType&&(u=!0,i.canPlayType(l.contentType,this.a)&&(s.videoCapabilities.push(l),r=!0));if(u||(r=i.canPlayType("video/mp4",this.a)||i.canPlayType("video/webm",this.a)),"required"==a.persistentState&&(n?(s.persistentState="required",s.sessionTypes=["persistent-license"]):r=!1),r)return void(this.b=s)}throw n="Unsupported keySystem","org.w3.clearkey"!=e&&"com.widevine.alpha"!=e||(n="None of the requested configurations were supported."),(n=Error(n)).name="NotSupportedError",n.code=DOMException.NOT_SUPPORTED_ERR,n}function xc(e){Y.debug("PatchedMediaKeysWebkit.MediaKeys"),this.g=e,this.b=null,this.a=new Ue,this.c=[],this.f={}}function Ac(e,t){e.b=t,e.a.hb();var n=Sc;t&&(e.a.B(t,n+"needkey",e.Yf.bind(e)),e.a.B(t,n+"keymessage",e.Bg.bind(e)),e.a.B(t,n+"keyadded",e.zg.bind(e)),e.a.B(t,n+"keyerror",e.Ag.bind(e)))}function Oc(e,t){var n=e.f[t];return n?(Y.debug("PatchedMediaKeysWebkit.MediaKeys.findSession_",n),n):(n=e.c.shift())?(n.sessionId=t,e.f[t]=n,Y.debug("PatchedMediaKeysWebkit.MediaKeys.findSession_",n),n):null}function Mc(e,t,n){Y.debug("PatchedMediaKeysWebkit.MediaKeySession"),Pe.call(this),this.f=e,this.h=!1,this.a=this.b=null,this.c=t,this.g=n,this.sessionId="",this.expiration=NaN,this.closed=new ye,this.keyStatuses=new Cc}function Ic(e,t,n){if(e.h)return Promise.reject(Error("The session is already initialized."));e.h=!0;try{if("persistent-license"==e.g)if(n)var r=new Uint8Array(st("LOAD_SESSION|"+n));else{var i=st("PERSISTENT|"),o=new Uint8Array(i.byteLength+t.byteLength);o.set(new Uint8Array(i),0),o.set(new Uint8Array(t),i.byteLength),r=o}else r=new Uint8Array(t)}catch(e){return Promise.reject(e)}e.b=new ye;var a=Tc("generateKeyRequest");try{e.f[a](e.c,r)}catch(t){if("InvalidStateError"!=t.name)return e.b=null,Promise.reject(t);new fe((function(){try{e.f[a](e.c,r)}catch(t){e.b.reject(t),e.b=null}})).T(.01)}return e.b}function Rc(e,t){var n=e.keyStatuses;n.size=null==t?0:1,n.a=t,e.dispatchEvent(new Te("keystatuseschange"))}function Cc(){this.size=0,this.a=void 0}function Dc(e){if("picture-in-picture"==(e=e.target).webkitPresentationMode){document.pictureInPictureElement=e;var t=new Event("enterpictureinpicture");e.dispatchEvent(t)}else document.pictureInPictureElement==e&&(document.pictureInPictureElement=null),t=new Event("leavepictureinpicture"),e.dispatchEvent(t)}function jc(){return this.webkitSupportsPresentationMode("picture-in-picture")?(this.webkitSetPresentationMode("picture-in-picture"),document.pictureInPictureElement=this,Promise.resolve()):Promise.reject(Error("PiP not allowed by video element"))}function Nc(){var e=document.pictureInPictureElement;return e?(e.webkitSetPresentationMode("inline"),document.pictureInPictureElement=null,Promise.resolve()):Promise.reject(Error("No picture in picture element found"))}function _c(){return!!this.hasAttribute("disablePictureInPicture")||!this.webkitSupportsPresentationMode("picture-in-picture")}function Lc(e){e?this.setAttribute("disablePictureInPicture",""):this.removeAttribute("disablePictureInPicture")}function Uc(){return{droppedVideoFrames:this.webkitDroppedFrameCount,totalVideoFrames:this.webkitDecodedFrameCount,corruptedVideoFrames:0,creationTime:NaN,totalFrameDelay:0}}function Kc(t,n,r){return new e.TextTrackCue(t,n,r)}function Bc(t,n,r){return new e.TextTrackCue(t+"-"+n+"-"+r,t,n,r)}function Vc(){}kc.prototype.createMediaKeys=function(){Y.debug("PatchedMediaKeysWebkit.MediaKeySystemAccess.createMediaKeys");var e=new xc(this.a);return Promise.resolve(e)},kc.prototype.getConfiguration=function(){return Y.debug("PatchedMediaKeysWebkit.MediaKeySystemAccess.getConfiguration"),this.b},(i=xc.prototype).createSession=function(e){if(Y.debug("PatchedMediaKeysWebkit.MediaKeys.createSession"),"temporary"!=(e=e||"temporary")&&"persistent-license"!=e)throw new TypeError("Session type "+e+" is unsupported on this platform.");var t=this.b||document.createElement("video");return t.src||(t.src="about:blank"),e=new Mc(t,this.g,e),this.c.push(e),e},i.setServerCertificate=function(){return Y.debug("PatchedMediaKeysWebkit.MediaKeys.setServerCertificate"),Promise.resolve(!1)},i.Yf=function(e){Y.debug("PatchedMediaKeysWebkit.onWebkitNeedKey_",e);var t=document.createEvent("CustomEvent");t.initCustomEvent("encrypted",!1,!1,null),t.initDataType="cenc",e.initData instanceof ArrayBuffer?t.initData=e.initData:t.initData=e.initData.buffer,this.b.dispatchEvent(t)},i.Bg=function(e){Y.debug("PatchedMediaKeysWebkit.onWebkitKeyMessage_",e);var t=Oc(this,e.sessionId);t?(e=new Te("message",{messageType:null==t.keyStatuses.a?"licenserequest":"licenserenewal",message:e.message}),Y.debug("PatchedMediaKeysWebkit.MediaKeySession.generated"),t.b&&(t.b.resolve(),t.b=null),t.dispatchEvent(e)):Y.error("Session not found",e.sessionId)},i.zg=function(e){Y.debug("PatchedMediaKeysWebkit.onWebkitKeyAdded_",e),(e=Oc(this,e.sessionId))&&(Y.debug("PatchedMediaKeysWebkit.MediaKeySession.ready"),Rc(e,"usable"),e.a&&e.a.resolve(),e.a=null)},i.Ag=function(e){Y.debug("PatchedMediaKeysWebkit.onWebkitKeyError_",e);var t=Oc(this,e.sessionId);t&&t.handleError(e)},z(Mc,Pe),(i=Mc.prototype).handleError=function(e){Y.debug("PatchedMediaKeysWebkit.MediaKeySession.handleError",e);var t=Error("EME v0.1b key error"),n=e.errorCode;n.systemCode=e.systemCode,t.errorCode=n,!e.sessionId&&this.b?(45==e.systemCode&&(t.message="Unsupported session type."),this.b.reject(t),this.b=null):e.sessionId&&this.a?(this.a.reject(t),this.a=null):(t=e.systemCode,e.errorCode.code==MediaKeyError.MEDIA_KEYERR_OUTPUT?Rc(this,"output-restricted"):Rc(this,1==t?"expired":"internal-error"))},i.Kd=function(e,t){if(this.a)this.a.then(this.Kd.bind(this,e,t)).catch(this.Kd.bind(this,e,t));else{if(this.a=e,"webkit-org.w3.clearkey"==this.c){var n=it(t),r=JSON.parse(n);"oct"!=r.keys[0].kty&&(this.a.reject(Error("Response is not a valid JSON Web Key Set.")),this.a=null),n=ft.Fa(r.keys[0].k),r=ft.Fa(r.keys[0].kid)}else n=new Uint8Array(t),r=null;var i=Tc("addKey");try{this.f[i](this.c,n,r,this.sessionId)}catch(e){this.a.reject(e),this.a=null}}},i.generateRequest=function(e,t){return Y.debug("PatchedMediaKeysWebkit.MediaKeySession.generateRequest"),Ic(this,t,null)},i.load=function(e){return Y.debug("PatchedMediaKeysWebkit.MediaKeySession.load"),"persistent-license"==this.g?Ic(this,null,e):Promise.reject(Error("Not a persistent session."))},i.update=function(e){Y.debug("PatchedMediaKeysWebkit.MediaKeySession.update",e);var t=new ye;return this.Kd(t,e),t},i.close=function(){if(Y.debug("PatchedMediaKeysWebkit.MediaKeySession.close"),"persistent-license"!=this.g){if(!this.sessionId)return this.closed.reject(Error("The session is not callable.")),this.closed;var e=Tc("cancelKeyRequest");try{this.f[e](this.c,this.sessionId)}catch(e){}}return this.closed.resolve(),this.closed},i.remove=function(){return Y.debug("PatchedMediaKeysWebkit.MediaKeySession.remove"),"persistent-license"!=this.g?Promise.reject(Error("Not a persistent session.")):this.close()},(i=Cc.prototype).forEach=function(e){this.a&&e(this.a,wc)},i.get=function(e){if(this.has(e))return this.a},i.has=function(e){var t=wc;return!(!this.a||!ft.Da(new Uint8Array(e),new Uint8Array(t)))},i.entries=function(){},i.keys=function(){},i.values=function(){},Xu((function(){if(!(!e.HTMLVideoElement||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration)){if(HTMLMediaElement.prototype.webkitGenerateKeyRequest)Y.info("Using webkit-prefixed EME v0.1b"),Sc="webkit";else{if(!HTMLMediaElement.prototype.generateKeyRequest)return;Y.info("Using nonprefixed EME v0.1b")}wc=new Uint8Array([0]).buffer,navigator.requestMediaKeySystemAccess=Ec,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=Pc,e.MediaKeys=xc,e.MediaKeySystemAccess=kc}})),Xu((function(){if(e.HTMLVideoElement){var t=HTMLVideoElement.prototype;t.requestPictureInPicture&&document.exitPictureInPicture||!t.webkitSupportsPresentationMode||(Y.debug("PiPWebkit.install"),document.pictureInPictureEnabled=!0,document.pictureInPictureElement=null,t.requestPictureInPicture=jc,Object.defineProperty(t,"disablePictureInPicture",{get:_c,set:Lc,enumerable:!0,configurable:!0}),document.exitPictureInPicture=Nc,document.addEventListener("webkitpresentationmodechanged",Dc,!0))}})),Xu((function(){if(Y.debug("VideoPlayPromise.install"),e.HTMLMediaElement){var t=HTMLMediaElement.prototype.play;HTMLMediaElement.prototype.play=function(){var e=t.apply(this);return e&&e.catch((function(){})),e}}})),Xu((function(){if(e.HTMLVideoElement){var t=HTMLVideoElement.prototype;!t.getVideoPlaybackQuality&&"webkitDroppedFrameCount"in t&&(t.getVideoPlaybackQuality=Uc)}})),Xu((function(){if(e.VTTCue)Y.info("Using native VTTCue.");else if(e.TextTrackCue){var t=TextTrackCue.length;if(3==t)Y.info("Using VTTCue polyfill from 3 argument TextTrackCue."),e.VTTCue=Kc;else if(6==t)Y.info("Using VTTCue polyfill from 6 argument TextTrackCue."),e.VTTCue=Bc;else{try{var n=!!Kc(1,2,"")}catch(e){n=!1}n&&(Y.info("Using VTTCue polyfill from 3 argument TextTrackCue."),e.VTTCue=Kc)}}else Y.error("VTTCue not available.")})),H("shaka.text.TtmlTextParser",Vc),Vc.prototype.parseInit=function(){},Vc.prototype.parseInit=Vc.prototype.parseInit,Vc.prototype.parseMedia=function(e,t){var n=it(e),r=[],i=new DOMParser,o=null;if(""==n)return r;try{o=i.parseFromString(n,"text/xml")}catch(e){throw new he(2,2,2005,"Failed to parse TTML.")}if(o){if(n=o.getElementsByTagName("parsererror")[0])throw new he(2,2,2005,n.textContent);if(!(i=o.getElementsByTagName("tt")[0]))throw new he(2,2,2005,"TTML does not contain <tt> tag.");var a=Ur.getAttributeNS(i,"http://www.w3.org/ns/ttml#parameter","frameRate"),s=Ur.getAttributeNS(i,"http://www.w3.org/ns/ttml#parameter","subFrameRate"),u=Ur.getAttributeNS(i,"http://www.w3.org/ns/ttml#parameter","frameRateMultiplier"),c=Ur.getAttributeNS(i,"http://www.w3.org/ns/ttml#parameter","tickRate");if(o=i.getAttribute("xml:space")||"default",n=i.getAttribute("tts:extent"),"default"!=o&&"preserve"!=o)throw new he(2,2,2005,"Invalid xml:space value: "+o);o="default"==o,a=new ll(a,s,u,c),s=tl(i.getElementsByTagName("metadata")[0]),u=tl(i.getElementsByTagName("styling")[0]),c=tl(i.getElementsByTagName("layout")[0]);for(var l=[],f=0;f<c.length;f++){var d,h,y=c[f],m=u,v=n,g=new un,b=y.getAttribute("xml:id");if(b)g.id=b,b=null,v&&(b=zc.exec(v)||Gc.exec(v)),v=b?Number(b[1]):null,b=b?Number(b[2]):null,(d=ol(y,m,"extent"))&&(null!=(d=(h=zc.exec(d))||Gc.exec(d))&&(g.width=null!=v?100*Number(d[1])/v:Number(d[1]),g.height=null!=b?100*Number(d[2])/b:Number(d[2]),g.widthUnits=h||null!=v?cn:0,g.heightUnits=h||null!=b?cn:0)),(y=ol(y,m,"origin"))&&(null!=(d=(h=zc.exec(y))||Gc.exec(y))&&(g.viewportAnchorX=null!=b?100*Number(d[1])/b:Number(d[1]),g.viewportAnchorY=null!=v?100*Number(d[2])/v:Number(d[2]),g.viewportAnchorUnits=h||null!=v?cn:0));else Y.m("TtmlTextParser parser encountered a region with no id. Region will be ignored."),g=null;g&&l.push(g)}for(n=function e(t){if(!t)return[];for(var n=[],r=(t=p(t.childNodes)).next();!r.done;r=t.next())(r=r.value)instanceof Element&&(r.hasAttribute("begin")?n.push(r):n=n.concat(e(r)));return n}(i.getElementsByTagName("body")[0]),i=(n=p(n)).next();!i.done;i=n.next())(i=nl(i.value,t.periodStart,a,s,u,c,l,o,!1))&&r.push(i)}return r},Vc.prototype.parseMedia=Vc.prototype.parseMedia;var Fc,Hc,zc=/^(\d{1,2}(?:\.\d+)?|100(?:\.0+)?)% (\d{1,2}(?:\.\d+)?|100(?:\.0+)?)%$/,qc=/^(\d+px|\d+em)$/,Gc=/^(\d+)px (\d+)px$/,Wc=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,Xc=/^(?:(\d{2,}):)?(\d{2}):(\d{2})$/,Yc=/^(?:(\d{2,}):)?(\d{2}):(\d{2}\.\d{2,})$/,$c=/^(\d*(?:\.\d*)?)f$/,Jc=/^(\d*(?:\.\d*)?)t$/,Qc=/^(?:(\d*(?:\.\d*)?)h)?(?:(\d*(?:\.\d*)?)m)?(?:(\d*(?:\.\d*)?)s)?(?:(\d*(?:\.\d*)?)ms)?$/,Zc={left:nn,center:"center",right:"end",start:nn,end:"end"},el={left:"line-left",center:"center",right:"line-right"};function tl(e){var t=[];if(!e)return t;for(var n=p(e.childNodes),r=n.next();!r.done;r=n.next())(r=r.value).nodeType==Node.ELEMENT_NODE&&"br"!==r.nodeName&&(r=tl(r),t=t.concat(r));return t.length||t.push(e),t}function nl(e,t,n,r,i,o,a,s,u){if(u&&"br"==e.nodeName)return(e=new Wt(0,0,"")).spacer=!0,e;var c=/^[\s\n]*$/.test(e.textContent),l=e.nodeType==Node.ELEMENT_NODE&&!e.hasAttribute("begin")&&!e.hasAttribute("end");if(e.nodeType!=Node.ELEMENT_NODE||l&&c||l&&!u)return null;c=ul(e.getAttribute("begin"),n),l=ul(e.getAttribute("end"),n);var f=ul(e.getAttribute("dur"),n);if(null==l&&null!=f&&(l=c+f),!u&&(null==c||null==l))throw new he(2,2,2001);if(c=u&&null==c?0:c+t,l=u&&null==l?0:l+t,f="",u=[],Array.from(e.childNodes).find((function(e){return e.nodeType===Node.TEXT_NODE&&/\S+/.test(e.textContent)})))f=function e(t,n){for(var r="",i=p(t.childNodes),o=i.next();!o.done;o=i.next())"br"==(o=o.value).nodeName&&t.childNodes[0]!==o?r+="\n":o.childNodes&&0<o.childNodes.length?r+=e(o,n):n?r+=o=(o=o.textContent.trim()).replace(/\s+/g," "):r+=o.textContent;return r}(e,s);else for(var d=p(e.childNodes),h=d.next();!h.done;h=d.next())(h=nl(h.value,t,n,r,i,o,a,s,!0))&&(h.startTime=h.startTime||c,h.endTime=h.endTime||l,u.push(h));if((t=new Wt(c,l,f)).nestedCues=u,(o=sl(e,"region",o,"")[0])&&o.getAttribute("xml:id")){var y=o.getAttribute("xml:id");t.region=a.filter((function(e){return e.id==y}))[0]}return function(e,t,n,r,i){"rtl"==il(t,n,i,"direction")&&(e.direction="rtl");var o=il(t,n,i,"writingMode");"tb"==o||"tblr"==o?e.writingMode="vertical-lr":"tbrl"==o?e.writingMode="vertical-rl":"rltb"==o||"rl"==o?e.direction="rtl":o&&(e.direction=Zt),(o=il(t,n,i,"textAlign"))?(e.positionAlign=el[o],e.lineAlign=Zc[o],e.textAlign=$t[o.toUpperCase()]):e.textAlign="start",(o=il(t,n,i,"displayAlign"))&&(e.displayAlign=Qt[o.toUpperCase()]);(o=il(t,n,i,"color"))&&(e.color=o);(o=il(t,n,i,"backgroundColor"))&&(e.backgroundColor=o);(o=il(t,n,i,"fontFamily"))&&(e.fontFamily=o);(o=il(t,n,i,"fontWeight"))&&"bold"==o&&(e.fontWeight=700),(o=il(t,n,i,"wrapOption"))&&"noWrap"==o&&(e.wrapLine=!1),(o=il(t,n,i,"lineHeight"))&&o.match(qc)&&(e.lineHeight=o),(o=il(t,n,i,"fontSize"))&&o.match(qc)&&(e.fontSize=o),(o=il(t,n,i,"fontStyle"))&&(e.fontStyle=sn[o.toUpperCase()]);if(r){o=r.getAttribute("imagetype");var a=r.getAttribute("encoding");r=r.textContent.trim(),"PNG"==o&&"Base64"==a&&r&&(e.backgroundImage="data:image/png;base64,"+r)}(n=ol(n,i,"textDecoration"))&&rl(e,n),(t=al(t,i,"textDecoration"))&&rl(e,t)}(t,e,o,r=sl(e,"smpte:backgroundImage",r,"#")[0],i),t}function rl(e,t){for(var n=t.split(" "),r=0;r<n.length;r++)switch(n[r]){case"underline":e.textDecoration.includes("underline")||e.textDecoration.push("underline");break;case"noUnderline":e.textDecoration.includes("underline")&&Ae(e.textDecoration,"underline");break;case"lineThrough":e.textDecoration.includes("lineThrough")||e.textDecoration.push("lineThrough");break;case"noLineThrough":e.textDecoration.includes("lineThrough")&&Ae(e.textDecoration,"lineThrough");break;case"overline":e.textDecoration.includes("overline")||e.textDecoration.push("overline");break;case"noOverline":e.textDecoration.includes("overline")&&Ae(e.textDecoration,"overline")}}function il(e,t,n,r){return(e=al(e,n,r))?e:ol(t,n,r)}function ol(e,t,n){for(var r=tl(e),i=0;i<r.length;i++){var o=Ur.getAttributeNS(r[i],"http://www.w3.org/ns/ttml#styling",n);if(o)return o}return(e=sl(e,"style",t,"")[0])?Ur.getAttributeNS(e,"http://www.w3.org/ns/ttml#styling",n):null}function al(e,t,n){var r=Ur.getAttributeNS(e,"http://www.w3.org/ns/ttml#styling",n);if(r)return r;for(e=sl(e,"style",t,""),t=null,r=0;r<e.length;r++){var i=Ur.getAttributeNS(e[r],"http://www.w3.org/ns/ttml#styling",n);i&&(t=i)}return t}function sl(e,t,n,r){var i=[];if(!e||1>n.length)return i;var o=e;for(e=null;o&&!(e=o.getAttribute(t))&&(o=o.parentNode)instanceof Element;);if(t=e)for(e=(t=p(t=t.split(" "))).next();!e.done;e=t.next()){e=e.value;for(var a=(o=p(n)).next();!a.done;a=o.next())if(r+(a=a.value).getAttribute("xml:id")==e){i.push(a);break}}return i}function ul(e,t){var n=null;if(Wc.test(e)){n=Wc.exec(e);var r=Number(n[1]),i=Number(n[2]),o=Number(n[3]),a=Number(n[4]);n=(o+=(a+=(Number(n[5])||0)/t.b)/t.frameRate)+60*i+3600*r}else Xc.test(e)?n=cl(Xc,e):Yc.test(e)?n=cl(Yc,e):$c.test(e)?(n=$c.exec(e),n=Number(n[1])/t.frameRate):Jc.test(e)?(n=Jc.exec(e),n=Number(n[1])/t.a):Qc.test(e)&&(n=cl(Qc,e));return n}function cl(e,t){var n=e.exec(t);return null==n||""==n[0]?null:(Number(n[4])||0)/1e3+(Number(n[3])||0)+60*(Number(n[2])||0)+3600*(Number(n[1])||0)}function ll(e,t,n,r){this.frameRate=Number(e)||30,this.b=Number(t)||1,this.a=Number(r),0==this.a&&(this.a=e?this.frameRate*this.b:1),n&&(e=/^(\d+) (\d+)$/g.exec(n))&&(this.frameRate*=Number(e[1])/Number(e[2]))}function fl(){this.a=new Vc}function dl(){}function pl(e,t,n){var r;if(r=/^align:(start|middle|center|end|left|right)$/.exec(t))t=r[1],e.textAlign="middle"==t?Yt:$t[t.toUpperCase()];else if(r=/^vertical:(lr|rl)$/.exec(t))e.writingMode="lr"==r[1]?"vertical-lr":"vertical-rl";else if(r=/^size:([\d.]+)%$/.exec(t))e.size=Number(r[1]);else if(r=/^position:([\d.]+)%(?:,(line-left|line-right|center|start|end))?$/.exec(t))e.position=Number(r[1]),r[2]&&(t=r[2],e.positionAlign="line-left"==t||"start"==t?"line-left":"line-right"==t||"end"==t?"line-right":"center");else{if(!(r=/^region:(.*)$/.exec(t))){e:{if(n=/^line:([\d.]+)%(?:,(start|end|center))?$/.exec(t))e.lineInterpretation=1,e.line=Number(n[1]),n[2]&&(e.lineAlign=rn[n[2].toUpperCase()]);else{if(!(n=/^line:(-?\d+)(?:,(start|end|center))?$/.exec(t))){e=!1;break e}e.lineInterpretation=tn,e.line=Number(n[1]),n[2]&&(e.lineAlign=rn[n[2].toUpperCase()])}e=!0}return e}(t=function(e,t){var n=e.filter((function(e){return e.id==t}));return n.length?n[0]:(Y.m("VTT parser could not find a region with id: ",t," The region will be ignored."),null)}(n,r[1]))&&(e.region=t)}return!0}function hl(e){if(null==(e=ji(e,/(?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{3})/g)))return null;var t=Number(e[2]),n=Number(e[3]);return 59<t||59<n?null:Number(e[4])/1e3+n+60*t+3600*(Number(e[1])||0)}function yl(){this.a=null}function ml(e,t,n){var r,i,o;return(new Rr).L("payl",jr((function(e){r=it(e)}))).L("iden",jr((function(e){i=it(e)}))).L("sttg",jr((function(e){o=it(e)}))).parse(e),r?function(e,t,n,r,i){if(e=new Wt(r,i,e),t&&(e.id=t),n)for(t=new Ci(n),n=Ni(t);n;)pl(e,n,[])||Y.m("VTT parser encountered an invalid VTT setting: ",n," The setting will be ignored."),Di(t),n=Ni(t);return e}(r,i,o,t,n):null}
/*
    @license
    EME Encryption Scheme Polyfill
    Copyright 2019 Google LLC
    SPDX-License-Identifier: Apache-2.0
    */
function vl(){}function gl(){Fc?console.debug("EmeEncryptionSchemePolyfill: Already installed."):navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration?(Fc=navigator.requestMediaKeySystemAccess,console.debug("EmeEncryptionSchemePolyfill: Waiting to detect encryptionScheme support."),navigator.requestMediaKeySystemAccess=bl):console.debug("EmeEncryptionSchemePolyfill: EME not found")}function bl(e,t){var n=this;return y((function r(){var i;return L(r,(function(r){switch(r.j){case 1:return console.assert(n==navigator,'bad "this" for requestMediaKeySystemAccess'),k(r,Fc.call(n,e,t),2);case 2:return Ol(i=r.s)?(console.debug("EmeEncryptionSchemePolyfill: Native encryptionScheme support found."),navigator.requestMediaKeySystemAccess=Fc,r.return(i)):(console.debug("EmeEncryptionSchemePolyfill: No native encryptionScheme support found. Patching encryptionScheme support."),navigator.requestMediaKeySystemAccess=wl,r.return(wl.call(n,e,t)))}}))}))}function wl(e,t){var n=this;return y((function r(){var i,o,a,s,u,c,l,f;return L(r,(function(r){switch(r.j){case 1:console.assert(n==navigator,'bad "this" for requestMediaKeySystemAccess'),i=Al(e),o=[];for(var d=p(t),h=d.next();!h.done;h=d.next())a=h.value,s=Sl(a.videoCapabilities,i),u=Sl(a.audioCapabilities,i),a.videoCapabilities&&a.videoCapabilities.length&&!s.length||a.audioCapabilities&&a.audioCapabilities.length&&!u.length||((c=Object.assign({},a)).videoCapabilities=s,c.audioCapabilities=u,o.push(c));if(!o.length)throw(l=Error("Unsupported keySystem or supportedConfigurations.")).name="NotSupportedError",l.code=DOMException.NOT_SUPPORTED_ERR,l;return k(r,Fc.call(n,e,o),2);case 2:return f=r.s,r.return(new xl(f,i))}}))}))}function Sl(e,t){return e?e.filter((function(e){return!e.encryptionScheme||e.encryptionScheme==t})):e}function Tl(){}function El(){navigator.mediaCapabilities?(Hc=navigator.mediaCapabilities.decodingInfo,console.debug("McEncryptionSchemePolyfill: Waiting to detect encryptionScheme support."),navigator.mediaCapabilities.decodingInfo=Pl):console.debug("McEncryptionSchemePolyfill: MediaCapabilities not found")}function Pl(e){var t=this;return y((function n(){var r;return L(n,(function(n){switch(n.j){case 1:return console.assert(t==navigator.mediaCapabilities,'bad "this" for decodingInfo'),k(n,Hc.call(t,e),2);case 2:return r=n.s,e.keySystemConfiguration?Ol(r.keySystemAccess)?(console.debug("McEncryptionSchemePolyfill: Native encryptionScheme support found."),navigator.mediaCapabilities.decodingInfo=Hc,n.return(r)):(console.debug("McEncryptionSchemePolyfill: No native encryptionScheme support found. Patching encryptionScheme support."),navigator.mediaCapabilities.decodingInfo=kl,n.return(kl.call(t,e))):n.return(r)}}))}))}function kl(e){var t=this;return y((function n(){var r,i,o,a,s,u,c;return L(n,(function(n){switch(n.j){case 1:return console.assert(t==navigator.mediaCapabilities,'bad "this" for decodingInfo'),r=null,e.keySystemConfiguration&&(i=e.keySystemConfiguration,o=i.keySystem,a=i.audio&&i.audio.encryptionScheme,s=i.video&&i.video.encryptionScheme,r=Al(o),u={powerEfficient:!1,smooth:!1,supported:!1,keySystemAccess:null,configuration:e},a&&a!=r||s&&s!=r)?n.return(u):k(n,Hc.call(t,e),2);case 2:return(c=n.s).keySystemAccess&&(c.keySystemAccess=new xl(c.keySystemAccess,r)),n.return(c)}}))}))}function xl(e,t){this.b=e,this.a=t,this.keySystem=e.keySystem}function Al(e){return e.startsWith("com.widevine")||e.startsWith("com.microsoft")||e.startsWith("com.adobe")||e.startsWith("org.w3")?"cenc":e.startsWith("com.apple")?"cbcs-1-9":(console.warn("EmeEncryptionSchemePolyfill: Unknown key system:",e,"Please contribute!"),null)}function Ol(e){var t=(e=e.getConfiguration()).audioCapabilities&&e.audioCapabilities[0];return!(!(e=e.videoCapabilities&&e.videoCapabilities[0]||t)||void 0===e.encryptionScheme)}function Ml(){}function Il(){gl(),El()}dn["application/ttml+xml"]=Vc,H("shaka.text.Mp4TtmlParser",fl),fl.prototype.parseInit=function(e){var t=!1;if((new Rr).L("moov",Cr).L("trak",Cr).L("mdia",Cr).L("minf",Cr).L("stbl",Cr).ia("stsd",Dr).L("stpp",(function(e){t=!0,e.parser.stop()})).parse(e),!t)throw new he(2,2,2007)},fl.prototype.parseInit=fl.prototype.parseInit,fl.prototype.parseMedia=function(e,t){var n=!1,r=[];if((new Rr).L("mdat",jr(function(e){n=!0,r=r.concat(this.a.parseMedia(e,t))}.bind(this))).parse(e),!n)throw new he(2,2,2007);return r},fl.prototype.parseMedia=fl.prototype.parseMedia,dn['application/mp4; codecs="stpp"']=fl,dn['application/mp4; codecs="stpp.ttml.im1t"']=fl,dn['application/mp4; codecs="stpp.TTML.im1t"']=fl,H("shaka.text.VttTextParser",dl),dl.prototype.parseInit=function(){},dl.prototype.parseInit=dl.prototype.parseInit,dl.prototype.parseMedia=function(e,t){var n=it(e);if(n=(n=n.replace(/\r\n|\r(?=[^\n]|$)/gm,"\n")).split(/\n{2,}/m),!/^WEBVTT($|[ \t\n])/m.test(n[0]))throw new he(2,2,2e3);var r=t.segmentStart;if(null==r&&(r=0,n[0].includes("X-TIMESTAMP-MAP"))){var i=n[0].match(/LOCAL:((?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{3}))/m),o=n[0].match(/MPEGTS:(\d+)/m);if(i&&o){if(null==(r=hl(new Ci(i[1]))))throw new he(2,2,2e3);r=t.periodStart+(Number(o[1])/9e4-r)}}o=[];var a=n[0].split("\n");for(i=1;i<a.length;i++)if(/^Region:/.test(a[i])){var s=new Ci(a[i]),u=new un;Ni(s),Di(s);for(var c=Ni(s);c;){var l;e:{var f=u,d=c;if(l=/^id=(.*)$/.exec(d))f.id=l[1];else if(l=/^width=(\d{1,2}|100)%$/.exec(d))f.width=Number(l[1]);else if(l=/^lines=(\d+)$/.exec(d))f.height=Number(l[1]),f.heightUnits=2;else if(l=/^regionanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(d))f.regionAnchorX=Number(l[1]),f.regionAnchorY=Number(l[2]);else if(l=/^viewportanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(d))f.viewportAnchorX=Number(l[1]),f.viewportAnchorY=Number(l[2]);else{if(!/^scroll=up$/.exec(d)){l=!1;break e}f.scroll="up"}l=!0}l||Y.m("VTT parser encountered an invalid VTTRegion setting: ",c," The setting will be ignored."),Di(s),c=Ni(s)}o.push(u)}for(i=[],s=1;s<n.length;s++){if(l=a=n[s].split("\n"),f=r,a=o,1==l.length&&!l[0]||/^NOTE($|[ \t])/.test(l[0])||"STYLE"==l[0])a=null;else{u=null,l[0].includes("--\x3e")||(u=l[0],l.splice(0,1)),d=hl(c=new Ci(l[0]));var p=ji(c,/[ \t]+--\x3e[ \t]+/g),h=hl(c);if(null==d||null==p||null==h)throw new he(2,2,2001);for(l=new Wt(d+f,h+f,l.slice(1).join("\n").trim()),Di(c),f=Ni(c);f;)pl(l,f,a)||Y.m("VTT parser encountered an invalid VTT setting: ",f," The setting will be ignored."),Di(c),f=Ni(c);null!=u&&(l.id=u),a=l}a&&i.push(a)}return i},dl.prototype.parseMedia=dl.prototype.parseMedia,dn["text/vtt"]=dl,dn['text/vtt; codecs="vtt"']=dl,H("shaka.text.Mp4VttParser",yl),yl.prototype.parseInit=function(e){var t=!1;if((new Rr).L("moov",Cr).L("trak",Cr).L("mdia",Cr).ia("mdhd",function(e){0==e.version?(e.reader.P(4),e.reader.P(4),this.a=e.reader.I(),e.reader.P(4)):(e.reader.P(8),e.reader.P(8),this.a=e.reader.I(),e.reader.P(8)),e.reader.P(4)}.bind(this)).L("minf",Cr).L("stbl",Cr).ia("stsd",Dr).L("wvtt",(function(){t=!0})).parse(e),!this.a)throw new he(2,2,2008);if(!t)throw new he(2,2,2008)},yl.prototype.parseInit=yl.prototype.parseInit,yl.prototype.parseMedia=function(e,t){var n=this;if(!this.a)throw Y.error("No init segment for MP4+VTT!"),new he(2,2,2008);var r,i=0,o=[],a=[],s=!1,u=!1,c=!1,l=null;if((new Rr).L("moof",Cr).L("traf",Cr).ia("tfdt",(function(e){s=!0,i=0==e.version?e.reader.I():e.reader.Kb()})).ia("tfhd",(function(e){var t=e.flags;(e=e.reader).P(4),1&t&&e.P(8),2&t&&e.P(4),l=8&t?e.I():null})).ia("trun",(function(e){u=!0;var t=e.version,n=e.flags,r=(e=e.reader).I();1&n&&e.P(4),4&n&&e.P(4);for(var i=[],a=0;a<r;a++){var s={duration:null,sampleSize:null,Md:null};256&n&&(s.duration=e.I()),512&n&&(s.sampleSize=e.I()),1024&n&&e.P(4),2048&n&&(s.Md=0==t?e.I():e.xe()),i.push(s)}o=i})).L("mdat",jr((function(e){c=!0,r=e}))).parse(e),!c&&!s&&!u)throw new he(2,2,2008);var f=i,d=new Or(new DataView(r.buffer,r.byteOffset,r.byteLength),0);return o.forEach((function(e){var r=e.duration||l,o=e.Md?i+e.Md:f;f=o+(r||0);var s=0;do{var u=d.I();s+=u;var c=d.I(),p=null;"vttc"==(c=_r(c))?8<u&&(p=d.gb(u-8)):("vtte"!=c&&Y.error("Unknown box "+c+"! Skipping!"),d.P(u-8)),r?p&&a.push(ml(p,t.periodStart+o/n.a,t.periodStart+f/n.a)):Y.error("WVTT sample duration unknown, and no default found!")}while(e.sampleSize&&s<e.sampleSize)})),a.filter(Bt.Ma)},yl.prototype.parseMedia=yl.prototype.parseMedia,dn['application/mp4; codecs="wvtt"']=yl,H("shaka.util.Dom.createHTMLElement",(function(e){return document.createElement(e)})),H("shaka.util.Dom.createVideoElement",(function(){var e=document.createElement("video");return e.muted=!0,e.width=600,e.height=400,e})),H("shaka.util.Dom.asHTMLElement",(function(e){return e})),H("shaka.util.Dom.asHTMLMediaElement",(function(e){return e})),H("shaka.util.Dom.removeAllChildren",(function(e){for(;e.firstChild;)e.removeChild(e.firstChild)})),H("EmeEncryptionSchemePolyfill",vl),vl.install=gl,H("McEncryptionSchemePolyfill",Tl),Tl.install=El,xl.prototype.getConfiguration=function(){var e=this.b.getConfiguration();if(e.videoCapabilities)for(var t=p(e.videoCapabilities),n=t.next();!n.done;n=t.next())n.value.encryptionScheme=this.a;if(e.audioCapabilities)for(n=(t=p(e.audioCapabilities)).next();!n.done;n=t.next())n.value.encryptionScheme=this.a;return e},xl.prototype.createMediaKeys=function(){return this.b.createMediaKeys()},H("EncryptionSchemePolyfills",Ml),Ml.install=Il,void 0!==r&&r.$e&&(r.$e=Ml)}.call(i,r,r,void 0),i.shaka)t[o]=i.shaka[o]}()}).call(this,n(10))},function(e,t){function n(e,t){e.onload=function(){this.onerror=this.onload=null,t(null,e)},e.onerror=function(){this.onerror=this.onload=null,t(new Error("Failed to load "+this.src),e)}}function r(e,t){e.onreadystatechange=function(){"complete"!=this.readyState&&"loaded"!=this.readyState||(this.onreadystatechange=null,t(null,e))}}e.exports=function(e,t,i){var o=document.head||document.getElementsByTagName("head")[0],a=document.createElement("script");"function"==typeof t&&(i=t,t={}),t=t||{},i=i||function(){},a.type=t.type||"text/javascript",a.charset=t.charset||"utf8",a.async=!("async"in t)||!!t.async,a.src=e,t.attrs&&function(e,t){for(var n in t)e.setAttribute(n,t[n])}(a,t.attrs),t.text&&(a.text=""+t.text),("onload"in a?n:r)(a,i),a.onload||n(a,i),o.appendChild(a)}},function(e,t,n){"use strict";var r=n(9);function i(){}function o(){}o.resetWarningCache=i,e.exports=function(){function e(e,t,n,i,o,a){if(a!==r){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return e}e.isRequired=e;var n={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:o,resetWarningCache:i};return n.PropTypes=n,n}},function(e,t,n){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},function(e,t){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"===("undefined"==typeof window?"undefined":n(window))&&(r=window)}e.exports=r},function(e,t,n){"use strict";n.r(t);var r=n(0),i=n.n(r),o=n(1),a=n(2),s=[{key:"youtube",name:"YouTube",canPlay:a.l.youtube,lazyPlayer:Object(r.lazy)((function(){return Promise.resolve().then(n.bind(null,12))}))},{key:"soundcloud",name:"SoundCloud",canPlay:a.l.soundcloud,lazyPlayer:Object(r.lazy)((function(){return Promise.resolve().then(n.bind(null,13))}))},{key:"vimeo",name:"Vimeo",canPlay:a.l.vimeo,lazyPlayer:Object(r.lazy)((function(){return Promise.resolve().then(n.bind(null,14))}))},{key:"facebook",name:"Facebook",canPlay:a.l.facebook,lazyPlayer:Object(r.lazy)((function(){return Promise.resolve().then(n.bind(null,15))}))},{key:"streamable",name:"Streamable",canPlay:a.l.streamable,lazyPlayer:Object(r.lazy)((function(){return Promise.resolve().then(n.bind(null,16))}))},{key:"wistia",name:"Wistia",canPlay:a.l.wistia,lazyPlayer:Object(r.lazy)((function(){return Promise.resolve().then(n.bind(null,17))}))},{key:"twitch",name:"Twitch",canPlay:a.l.twitch,lazyPlayer:Object(r.lazy)((function(){return Promise.resolve().then(n.bind(null,18))}))},{key:"dailymotion",name:"DailyMotion",canPlay:a.l.dailymotion,lazyPlayer:Object(r.lazy)((function(){return Promise.resolve().then(n.bind(null,19))}))},{key:"mixcloud",name:"Mixcloud",canPlay:a.l.mixcloud,lazyPlayer:Object(r.lazy)((function(){return Promise.resolve().then(n.bind(null,20))}))},{key:"vidyard",name:"Vidyard",canPlay:a.l.vidyard,lazyPlayer:Object(r.lazy)((function(){return Promise.resolve().then(n.bind(null,21))}))},{key:"file",name:"FilePlayer",canPlay:a.l.file,canEnablePIP:function(e){return a.l.file(e)&&(document.pictureInPictureEnabled||Object(o.i)())&&!a.a.test(e)},lazyPlayer:Object(r.lazy)((function(){return Promise.resolve().then(n.bind(null,22))}))}],u=n(5),c=n.n(u);function l(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}var f=function(e,t){var n;void 0===t&&(t=l);var r,i=[],o=!1;return function(){for(var a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];return o&&n===this&&t(a,i)||(r=e.apply(this,a),o=!0,n=this,i=a),r}},d=n(4),p=n.n(d),h=n(3),y=n.n(h),m=y.a.string,v=y.a.bool,g=y.a.number,b=y.a.array,w=y.a.oneOfType,S=y.a.shape,T=y.a.object,E=y.a.func,P=y.a.node,k={url:w([m,b,T]),playing:v,loop:v,controls:v,volume:g,muted:v,playbackRate:g,width:w([m,g]),height:w([m,g]),style:T,progressInterval:g,playsinline:v,pip:v,light:w([v,m]),playIcon:P,wrapper:w([m,E,S({render:E.isRequired})]),config:S({soundcloud:S({options:T}),youtube:S({playerVars:T,embedOptions:T,onUnstarted:E}),facebook:S({appId:m,version:m,playerId:m}),dailymotion:S({params:T}),vimeo:S({playerOptions:T}),file:S({attributes:T,tracks:b,forceVideo:v,forceAudio:v,forceHLS:v,forceDASH:v,hlsOptions:T,hlsVersion:m,dashVersion:m}),wistia:S({options:T,playerId:m}),mixcloud:S({options:T}),twitch:S({options:T,playerId:m}),vidyard:S({options:T})}),onReady:E,onStart:E,onPlay:E,onPause:E,onBuffer:E,onBufferEnd:E,onEnded:E,onError:E,onDuration:E,onSeek:E,onProgress:E,onEnablePIP:E,onDisablePIP:E},x=function(){},A={playing:!1,loop:!1,controls:!1,volume:null,muted:!1,playbackRate:1,width:"640px",height:"360px",style:{},progressInterval:1e3,playsinline:!1,pip:!1,light:!1,wrapper:"div",config:{soundcloud:{options:{visual:!0,buying:!1,liking:!1,download:!1,sharing:!1,show_comments:!1,show_playcount:!1}},youtube:{playerVars:{playsinline:1,showinfo:0,rel:0,iv_load_policy:3,modestbranding:1},embedOptions:{},onUnstarted:x},facebook:{appId:"1309697205772819",version:"v3.3",playerId:null},dailymotion:{params:{api:1,"endscreen-enable":!1}},vimeo:{playerOptions:{autopause:!1,byline:!1,portrait:!1,title:!1}},file:{attributes:{},tracks:[],forceVideo:!1,forceAudio:!1,forceHLS:!1,forceDASH:!1,hlsOptions:{},hlsVersion:"0.13.1",dashVersion:"2.9.2"},wistia:{options:{},playerId:null},mixcloud:{options:{hide_cover:1}},twitch:{options:{},playerId:null},vidyard:{options:{}}},onReady:x,onStart:x,onPlay:x,onPause:x,onBuffer:x,onBufferEnd:x,onEnded:x,onError:x,onDuration:x,onSeek:x,onProgress:x,onEnablePIP:x,onDisablePIP:x};function O(e){return(O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function M(){return(M=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function I(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function R(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function C(e,t){return(C=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function D(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=_(e);if(t){var i=_(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return j(this,n)}}function j(e,t){return!t||"object"!==O(t)&&"function"!=typeof t?N(e):t}function N(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _(e){return(_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function L(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var U=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&C(e,t)}(a,e);var t,n,r,o=D(a);function a(){var e;I(this,a);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return L(N(e=o.call.apply(o,[this].concat(n))),"mounted",!1),L(N(e),"isReady",!1),L(N(e),"isPlaying",!1),L(N(e),"isLoading",!0),L(N(e),"loadOnReady",null),L(N(e),"startOnPlay",!0),L(N(e),"seekOnPlay",null),L(N(e),"onDurationCalled",!1),L(N(e),"handlePlayerMount",(function(t){e.player=t,e.player.load(e.props.url),e.progress()})),L(N(e),"getInternalPlayer",(function(t){return e.player?e.player[t]:null})),L(N(e),"progress",(function(){if(e.props.url&&e.player&&e.isReady){var t=e.getCurrentTime()||0,n=e.getSecondsLoaded(),r=e.getDuration();if(r){var i={playedSeconds:t,played:t/r};null!==n&&(i.loadedSeconds=n,i.loaded=n/r),i.playedSeconds===e.prevPlayed&&i.loadedSeconds===e.prevLoaded||e.props.onProgress(i),e.prevPlayed=i.playedSeconds,e.prevLoaded=i.loadedSeconds}}e.progressTimeout=setTimeout(e.progress,e.props.progressFrequency||e.props.progressInterval)})),L(N(e),"handleReady",(function(){if(e.mounted){e.isReady=!0,e.isLoading=!1;var t=e.props,n=t.onReady,r=t.playing,i=t.volume,o=t.muted;n(),o||null===i||e.player.setVolume(i),e.loadOnReady?(e.player.load(e.loadOnReady,!0),e.loadOnReady=null):r&&e.player.play(),e.handleDurationCheck()}})),L(N(e),"handlePlay",(function(){e.isPlaying=!0,e.isLoading=!1;var t=e.props,n=t.onStart,r=t.onPlay,i=t.playbackRate;e.startOnPlay&&(e.player.setPlaybackRate&&1!==i&&e.player.setPlaybackRate(i),n(),e.startOnPlay=!1),r(),e.seekOnPlay&&(e.seekTo(e.seekOnPlay),e.seekOnPlay=null),e.handleDurationCheck()})),L(N(e),"handlePause",(function(t){e.isPlaying=!1,e.isLoading||e.props.onPause(t)})),L(N(e),"handleEnded",(function(){var t=e.props,n=t.activePlayer,r=t.loop,i=t.onEnded;n.loopOnEnded&&r&&e.seekTo(0),r||(e.isPlaying=!1,i())})),L(N(e),"handleError",(function(){var t;e.isLoading=!1,(t=e.props).onError.apply(t,arguments)})),L(N(e),"handleDurationCheck",(function(){clearTimeout(e.durationCheckTimeout);var t=e.getDuration();t?e.onDurationCalled||(e.props.onDuration(t),e.onDurationCalled=!0):e.durationCheckTimeout=setTimeout(e.handleDurationCheck,100)})),L(N(e),"handleLoaded",(function(){e.isLoading=!1})),e}return t=a,(n=[{key:"componentDidMount",value:function(){this.mounted=!0}},{key:"componentWillUnmount",value:function(){clearTimeout(this.progressTimeout),clearTimeout(this.durationCheckTimeout),this.isReady&&(this.player.stop(),this.player.disablePIP&&this.player.disablePIP()),this.mounted=!1}},{key:"componentDidUpdate",value:function(e){var t=this,n=this.props,r=n.url,i=n.playing,o=n.volume,a=n.muted,s=n.playbackRate,u=n.pip,c=n.loop,l=n.activePlayer;if(!p()(e.url,r)){if(this.isLoading&&!l.forceLoad)return console.warn("ReactPlayer: the attempt to load ".concat(r," is being deferred until the player has loaded")),void(this.loadOnReady=r);this.isLoading=!0,this.startOnPlay=!0,this.onDurationCalled=!1,this.player.load(r,this.isReady)}e.playing||!i||this.isPlaying||this.player.play(),e.playing&&!i&&this.isPlaying&&this.player.pause(),!e.pip&&u&&this.player.enablePIP&&this.player.enablePIP(),e.pip&&!u&&this.player.disablePIP&&this.player.disablePIP(),e.volume!==o&&null!==o&&this.player.setVolume(o),e.muted!==a&&(a?this.player.mute():(this.player.unmute(),null!==o&&setTimeout((function(){return t.player.setVolume(o)})))),e.playbackRate!==s&&this.player.setPlaybackRate&&this.player.setPlaybackRate(s),e.loop!==c&&this.player.setLoop&&this.player.setLoop(c)}},{key:"getDuration",value:function(){return this.isReady?this.player.getDuration():null}},{key:"getCurrentTime",value:function(){return this.isReady?this.player.getCurrentTime():null}},{key:"getSecondsLoaded",value:function(){return this.isReady?this.player.getSecondsLoaded():null}},{key:"seekTo",value:function(e,t){var n=this;if(!this.isReady&&0!==e)return this.seekOnPlay=e,void setTimeout((function(){n.seekOnPlay=null}),5e3);if(t?"fraction"===t:e>0&&e<1){var r=this.player.getDuration();return r?void this.player.seekTo(r*e):void console.warn("ReactPlayer: could not seek using fraction â€“Â duration not yet available")}this.player.seekTo(e)}},{key:"render",value:function(){var e=this.props.activePlayer;return e?i.a.createElement(e,M({},this.props,{onMount:this.handlePlayerMount,onReady:this.handleReady,onPlay:this.handlePlay,onPause:this.handlePause,onEnded:this.handleEnded,onLoaded:this.handleLoaded,onError:this.handleError})):null}}])&&R(t.prototype,n),r&&R(t,r),a}(r.Component);function K(e){return(K="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function B(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function V(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?B(Object(n),!0).forEach((function(t){Q(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):B(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function F(){return(F=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function H(e){return function(e){if(Array.isArray(e))return z(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return z(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return z(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function z(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function q(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function G(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function W(e,t){return(W=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function X(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=J(e);if(t){var i=J(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Y(this,n)}}function Y(e,t){return!t||"object"!==K(t)&&"function"!=typeof t?$(e):t}function $(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function J(e){return(J=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Q(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}L(U,"displayName","Player"),L(U,"propTypes",k),L(U,"defaultProps",A);var Z,ee,te,ne,re=Object(r.lazy)((function(){return Promise.resolve().then(n.bind(null,23))})),ie="undefined"!=typeof window&&window.document,oe=Object.keys(k),ae=ie?r.Suspense:function(){return null},se=[],ue=s[s.length-1];t.default=(Z=s,ee=ue,ne=te=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&W(e,t)}(s,e);var t,n,r,a=X(s);function s(){var e;q(this,s);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Q($(e=a.call.apply(a,[this].concat(n))),"state",{showPreview:!!e.props.light}),Q($(e),"references",{wrapper:function(t){e.wrapper=t},player:function(t){e.player=t}}),Q($(e),"handleClickPreview",(function(){e.setState({showPreview:!1})})),Q($(e),"showPreview",(function(){e.setState({showPreview:!0})})),Q($(e),"getDuration",(function(){return e.player?e.player.getDuration():null})),Q($(e),"getCurrentTime",(function(){return e.player?e.player.getCurrentTime():null})),Q($(e),"getSecondsLoaded",(function(){return e.player?e.player.getSecondsLoaded():null})),Q($(e),"getInternalPlayer",(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"player";return e.player?e.player.getInternalPlayer(t):null})),Q($(e),"seekTo",(function(t,n){if(!e.player)return null;e.player.seekTo(t,n)})),Q($(e),"handleReady",(function(){e.props.onReady($(e))})),Q($(e),"getActivePlayer",f((function(e){for(var t=0,n=[].concat(se,H(Z));t<n.length;t++){var r=n[t];if(r.canPlay(e))return r}return ee||null}))),Q($(e),"getConfig",f((function(t,n){var r=e.props.config;return c.a.all([A.config,A.config[n]||{},r,r[n]||{}])}))),Q($(e),"getAttributes",f((function(t){return Object(o.d)(e.props,oe)}))),Q($(e),"renderActivePlayer",(function(t){if(!t)return null;var n=e.getActivePlayer(t);if(!n)return null;var r=e.getConfig(t,n.key);return i.a.createElement(U,F({},e.props,{key:n.key,ref:e.references.player,config:r,activePlayer:n.lazyPlayer||n,onReady:e.handleReady}))})),e}return t=s,(n=[{key:"shouldComponentUpdate",value:function(e,t){return!p()(this.props,e)||!p()(this.state,t)}},{key:"componentDidUpdate",value:function(e){var t=this.props.light;!e.light&&t&&this.setState({showPreview:!0}),e.light&&!t&&this.setState({showPreview:!1})}},{key:"renderPreview",value:function(e){if(!e)return null;var t=this.props,n=t.light,r=t.playIcon;return i.a.createElement(re,{url:e,light:n,playIcon:r,onClick:this.handleClickPreview})}},{key:"render",value:function(){var e=this.props,t=e.url,n=e.style,r=e.width,o=e.height,a=e.wrapper,s=this.state.showPreview,u=this.getAttributes(t);return i.a.createElement(a,F({ref:this.references.wrapper,style:V(V({},n),{},{width:r,height:o})},u),i.a.createElement(ae,{fallback:null},s?this.renderPreview(t):this.renderActivePlayer(t)))}}])&&G(t.prototype,n),r&&G(t,r),s}(r.Component),Q(te,"displayName","ReactPlayer"),Q(te,"propTypes",k),Q(te,"defaultProps",A),Q(te,"addCustomPlayer",(function(e){se.push(e)})),Q(te,"removeCustomPlayers",(function(){se.length=0})),Q(te,"canPlay",(function(e){for(var t=0,n=[].concat(se,H(Z));t<n.length;t++)if(n[t].canPlay(e))return!0;return!1})),Q(te,"canEnablePIP",(function(e){for(var t=0,n=[].concat(se,H(Z));t<n.length;t++){var r=n[t];if(r.canEnablePIP&&r.canEnablePIP(e))return!0}return!1})),ne)},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return E}));var r=n(0),i=n.n(r),o=n(1),a=n(2);function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){b(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return f(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=g(e);if(t){var i=g(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return m(this,n)}}function m(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?v(e):t}function v(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function b(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var w=/list=([a-zA-Z0-9_-]+)/,S=/user\/([a-zA-Z0-9_-]+)\/?/,T=/youtube-nocookie\.com/,E=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(u,e);var t,n,r,s=y(u);function u(){var e;d(this,u);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return b(v(e=s.call.apply(s,[this].concat(n))),"callPlayer",o.a),b(v(e),"parsePlaylist",(function(t){return t instanceof Array?{listType:"playlist",playlist:t.map(e.getID).join(",")}:w.test(t)?{listType:"playlist",list:l(t.match(w),2)[1]}:S.test(t)?{listType:"user_uploads",list:l(t.match(S),2)[1]}:{}})),b(v(e),"onStateChange",(function(t){var n=t.data,r=e.props,i=r.onPlay,o=r.onPause,a=r.onBuffer,s=r.onBufferEnd,u=r.onEnded,c=r.onReady,l=r.loop,f=r.config,d=f.playerVars,p=f.onUnstarted,h=window.YT.PlayerState,y=h.UNSTARTED,m=h.PLAYING,v=h.PAUSED,g=h.BUFFERING,b=h.ENDED,w=h.CUED;if(n===y&&p(),n===m&&(i(),s()),n===v&&o(),n===g&&a(),n===b){var S=!!e.callPlayer("getPlaylist");l&&!S&&(d.start?e.seekTo(d.start):e.play()),u()}n===w&&c()})),b(v(e),"mute",(function(){e.callPlayer("mute")})),b(v(e),"unmute",(function(){e.callPlayer("unMute")})),b(v(e),"ref",(function(t){e.container=t})),e}return t=u,(n=[{key:"componentDidMount",value:function(){this.props.onMount&&this.props.onMount(this)}},{key:"getID",value:function(e){return!e||e instanceof Array?null:e.match(a.k)[1]}},{key:"load",value:function(e,t){var n=this,r=this.props,i=r.playing,a=r.muted,s=r.playsinline,u=r.controls,l=r.loop,f=r.config,d=r.onError,p=f.playerVars,h=f.embedOptions,y=this.getID(e);if(t)return w.test(e)||S.test(e)||e instanceof Array?void this.player.loadPlaylist(this.parsePlaylist(e)):void this.player.cueVideoById({videoId:y,startSeconds:Object(o.f)(e)||p.start,endSeconds:Object(o.e)(e)||p.end});Object(o.b)("https://www.youtube.com/iframe_api","YT","onYouTubeIframeAPIReady",(function(e){return e.loaded})).then((function(t){n.container&&(n.player=new t.Player(n.container,c({width:"100%",height:"100%",videoId:y,playerVars:c(c({autoplay:i?1:0,mute:a?1:0,controls:u?1:0,start:Object(o.f)(e),end:Object(o.e)(e),origin:window.location.origin,playsinline:s},n.parsePlaylist(e)),p),events:{onReady:function(){l&&n.player.setLoop(!0),n.props.onReady()},onStateChange:n.onStateChange,onError:function(e){return d(e.data)}},host:T.test(e)?"https://www.youtube-nocookie.com":void 0},h)))}),d)}},{key:"play",value:function(){this.callPlayer("playVideo")}},{key:"pause",value:function(){this.callPlayer("pauseVideo")}},{key:"stop",value:function(){document.body.contains(this.callPlayer("getIframe"))&&this.callPlayer("stopVideo")}},{key:"seekTo",value:function(e){this.callPlayer("seekTo",e),this.props.playing||this.pause()}},{key:"setVolume",value:function(e){this.callPlayer("setVolume",100*e)}},{key:"setPlaybackRate",value:function(e){this.callPlayer("setPlaybackRate",e)}},{key:"setLoop",value:function(e){this.callPlayer("setLoop",e)}},{key:"getDuration",value:function(){return this.callPlayer("getDuration")}},{key:"getCurrentTime",value:function(){return this.callPlayer("getCurrentTime")}},{key:"getSecondsLoaded",value:function(){return this.callPlayer("getVideoLoadedFraction")*this.getDuration()}},{key:"render",value:function(){var e={width:"100%",height:"100%",display:this.props.display};return i.a.createElement("div",{style:e},i.a.createElement("div",{ref:this.ref}))}}])&&p(t.prototype,n),r&&p(t,r),u}(r.Component);b(E,"displayName","YouTube"),b(E,"canPlay",a.l.youtube)},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return g}));var r=n(0),i=n.n(r),o=n(1),a=n(2);function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){v(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=m(e);if(t){var i=m(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return h(this,n)}}function h(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?y(e):t}function y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(s,e);var t,n,r,a=p(s);function s(){var e;l(this,s);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return v(y(e=a.call.apply(a,[this].concat(n))),"callPlayer",o.a),v(y(e),"duration",null),v(y(e),"currentTime",null),v(y(e),"fractionLoaded",null),v(y(e),"mute",(function(){e.setVolume(0)})),v(y(e),"unmute",(function(){null!==e.props.volume&&e.setVolume(e.props.volume)})),v(y(e),"ref",(function(t){e.iframe=t})),e}return t=s,(n=[{key:"componentDidMount",value:function(){this.props.onMount&&this.props.onMount(this)}},{key:"load",value:function(e,t){var n=this;Object(o.b)("https://w.soundcloud.com/player/api.js","SC").then((function(r){if(n.iframe){var i=r.Widget.Events,o=i.PLAY,a=i.PLAY_PROGRESS,s=i.PAUSE,u=i.FINISH,l=i.ERROR;t||(n.player=r.Widget(n.iframe),n.player.bind(o,n.props.onPlay),n.player.bind(s,(function(){n.duration-n.currentTime<.05||n.props.onPause()})),n.player.bind(a,(function(e){n.currentTime=e.currentPosition/1e3,n.fractionLoaded=e.loadedProgress})),n.player.bind(u,(function(){return n.props.onEnded()})),n.player.bind(l,(function(e){return n.props.onError(e)}))),n.player.load(e,c(c({},n.props.config.options),{},{callback:function(){n.player.getDuration((function(e){n.duration=e/1e3,n.props.onReady()}))}}))}}))}},{key:"play",value:function(){this.callPlayer("play")}},{key:"pause",value:function(){this.callPlayer("pause")}},{key:"stop",value:function(){}},{key:"seekTo",value:function(e){this.callPlayer("seekTo",1e3*e)}},{key:"setVolume",value:function(e){this.callPlayer("setVolume",100*e)}},{key:"getDuration",value:function(){return this.duration}},{key:"getCurrentTime",value:function(){return this.currentTime}},{key:"getSecondsLoaded",value:function(){return this.fractionLoaded*this.duration}},{key:"render",value:function(){var e={width:"100%",height:"100%",display:this.props.display};return i.a.createElement("iframe",{ref:this.ref,src:"https://w.soundcloud.com/player/?url=".concat(encodeURIComponent(this.props.url)),style:e,frameBorder:0,allow:"autoplay"})}}])&&f(t.prototype,n),r&&f(t,r),s}(r.Component);v(g,"displayName","SoundCloud"),v(g,"canPlay",a.l.soundcloud),v(g,"loopOnEnded",!0)},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return v}));var r=n(0),i=n.n(r),o=n(1),a=n(2);function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=y(e);if(t){var i=y(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p(this,n)}}function p(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?h(e):t}function h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var v=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(s,e);var t,n,r,a=d(s);function s(){var e;c(this,s);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return m(h(e=a.call.apply(a,[this].concat(n))),"callPlayer",o.a),m(h(e),"duration",null),m(h(e),"currentTime",null),m(h(e),"secondsLoaded",null),m(h(e),"mute",(function(){e.setVolume(0)})),m(h(e),"unmute",(function(){null!==e.props.volume&&e.setVolume(e.props.volume)})),m(h(e),"ref",(function(t){e.container=t})),e}return t=s,(n=[{key:"componentDidMount",value:function(){this.props.onMount&&this.props.onMount(this)}},{key:"load",value:function(e){var t=this;this.duration=null,Object(o.b)("https://player.vimeo.com/api/player.js","Vimeo").then((function(n){t.container&&(t.player=new n.Player(t.container,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){m(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({url:e,autoplay:t.props.playing,muted:t.props.muted,loop:t.props.loop,playsinline:t.props.playsinline,controls:t.props.controls},t.props.config.playerOptions)),t.player.ready().then((function(){var e=t.container.querySelector("iframe");e.style.width="100%",e.style.height="100%"})).catch(t.props.onError),t.player.on("loaded",(function(){t.props.onReady(),t.refreshDuration()})),t.player.on("play",(function(){t.props.onPlay(),t.refreshDuration()})),t.player.on("pause",t.props.onPause),t.player.on("seeked",(function(e){return t.props.onSeek(e.seconds)})),t.player.on("ended",t.props.onEnded),t.player.on("error",t.props.onError),t.player.on("timeupdate",(function(e){var n=e.seconds;t.currentTime=n})),t.player.on("progress",(function(e){var n=e.seconds;t.secondsLoaded=n})))}),this.props.onError)}},{key:"refreshDuration",value:function(){var e=this;this.player.getDuration().then((function(t){e.duration=t}))}},{key:"play",value:function(){var e=this.callPlayer("play");e&&e.catch(this.props.onError)}},{key:"pause",value:function(){this.callPlayer("pause")}},{key:"stop",value:function(){this.callPlayer("unload")}},{key:"seekTo",value:function(e){this.callPlayer("setCurrentTime",e)}},{key:"setVolume",value:function(e){this.callPlayer("setVolume",e)}},{key:"setLoop",value:function(e){this.callPlayer("setLoop",e)}},{key:"setPlaybackRate",value:function(e){this.callPlayer("setPlaybackRate",e)}},{key:"getDuration",value:function(){return this.duration}},{key:"getCurrentTime",value:function(){return this.currentTime}},{key:"getSecondsLoaded",value:function(){return this.secondsLoaded}},{key:"render",value:function(){var e={width:"100%",height:"100%",overflow:"hidden",display:this.props.display};return i.a.createElement("div",{key:this.props.url,ref:this.ref,style:e})}}])&&l(t.prototype,n),r&&l(t,r),s}(r.Component);m(v,"displayName","Vimeo"),m(v,"canPlay",a.l.vimeo),m(v,"forceLoad",!0)},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return v}));var r=n(0),i=n.n(r),o=n(1),a=n(2);function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h(e);if(t){var i=h(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return d(this,n)}}function d(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?p(e):t}function p(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var m="https://connect.facebook.net/en_US/sdk.js",v=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(s,e);var t,n,r,a=f(s);function s(){var e;u(this,s);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return y(p(e=a.call.apply(a,[this].concat(n))),"callPlayer",o.a),y(p(e),"playerID",e.props.config.playerId||"".concat("facebook-player-").concat(Object(o.h)())),y(p(e),"mute",(function(){e.callPlayer("mute")})),y(p(e),"unmute",(function(){e.callPlayer("unmute")})),e}return t=s,(n=[{key:"componentDidMount",value:function(){this.props.onMount&&this.props.onMount(this)}},{key:"load",value:function(e,t){var n=this;t?Object(o.b)(m,"FB","fbAsyncInit").then((function(e){return e.XFBML.parse()})):Object(o.b)(m,"FB","fbAsyncInit").then((function(e){e.init({appId:n.props.config.appId,xfbml:!0,version:n.props.config.version}),e.Event.subscribe("xfbml.render",(function(e){n.props.onLoaded()})),e.Event.subscribe("xfbml.ready",(function(e){"video"===e.type&&e.id===n.playerID&&(n.player=e.instance,n.player.subscribe("startedPlaying",n.props.onPlay),n.player.subscribe("paused",n.props.onPause),n.player.subscribe("finishedPlaying",n.props.onEnded),n.player.subscribe("startedBuffering",n.props.onBuffer),n.player.subscribe("finishedBuffering",n.props.onBufferEnd),n.player.subscribe("error",n.props.onError),n.props.muted||n.callPlayer("unmute"),n.props.onReady(),document.getElementById(n.playerID).querySelector("iframe").style.visibility="visible")}))}))}},{key:"play",value:function(){this.callPlayer("play")}},{key:"pause",value:function(){this.callPlayer("pause")}},{key:"stop",value:function(){}},{key:"seekTo",value:function(e){this.callPlayer("seek",e)}},{key:"setVolume",value:function(e){this.callPlayer("setVolume",e)}},{key:"getDuration",value:function(){return this.callPlayer("getDuration")}},{key:"getCurrentTime",value:function(){return this.callPlayer("getCurrentPosition")}},{key:"getSecondsLoaded",value:function(){return null}},{key:"render",value:function(){return i.a.createElement("div",{style:{width:"100%",height:"100%"},id:this.playerID,className:"fb-video","data-href":this.props.url,"data-autoplay":this.props.playing?"true":"false","data-allowfullscreen":"true","data-controls":this.props.controls?"true":"false"})}}])&&c(t.prototype,n),r&&c(t,r),s}(r.Component);y(v,"displayName","Facebook"),y(v,"canPlay",a.l.facebook),y(v,"loopOnEnded",!0)},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return m}));var r=n(0),i=n.n(r),o=n(1),a=n(2);function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h(e);if(t){var i=h(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return d(this,n)}}function d(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?p(e):t}function p(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var m=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(d,e);var t,n,r,s=f(d);function d(){var e;u(this,d);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return y(p(e=s.call.apply(s,[this].concat(n))),"callPlayer",o.a),y(p(e),"duration",null),y(p(e),"currentTime",null),y(p(e),"secondsLoaded",null),y(p(e),"mute",(function(){e.callPlayer("mute")})),y(p(e),"unmute",(function(){e.callPlayer("unmute")})),y(p(e),"ref",(function(t){e.iframe=t})),e}return t=d,(n=[{key:"componentDidMount",value:function(){this.props.onMount&&this.props.onMount(this)}},{key:"load",value:function(e){var t=this;Object(o.b)("https://cdn.embed.ly/player-0.1.0.min.js","playerjs").then((function(e){t.iframe&&(t.player=new e.Player(t.iframe),t.player.setLoop(t.props.loop),t.player.on("ready",t.props.onReady),t.player.on("play",t.props.onPlay),t.player.on("pause",t.props.onPause),t.player.on("seeked",t.props.onSeek),t.player.on("ended",t.props.onEnded),t.player.on("error",t.props.onError),t.player.on("timeupdate",(function(e){var n=e.duration,r=e.seconds;t.duration=n,t.currentTime=r})),t.player.on("buffered",(function(e){var n=e.percent;t.duration&&(t.secondsLoaded=t.duration*n)})),t.props.muted&&t.player.mute())}),this.props.onError)}},{key:"play",value:function(){this.callPlayer("play")}},{key:"pause",value:function(){this.callPlayer("pause")}},{key:"stop",value:function(){}},{key:"seekTo",value:function(e){this.callPlayer("setCurrentTime",e)}},{key:"setVolume",value:function(e){this.callPlayer("setVolume",100*e)}},{key:"setLoop",value:function(e){this.callPlayer("setLoop",e)}},{key:"getDuration",value:function(){return this.duration}},{key:"getCurrentTime",value:function(){return this.currentTime}},{key:"getSecondsLoaded",value:function(){return this.secondsLoaded}},{key:"render",value:function(){var e=this.props.url.match(a.f)[1];return i.a.createElement("iframe",{ref:this.ref,src:"https://streamable.com/o/".concat(e),frameBorder:"0",scrolling:"no",style:{width:"100%",height:"100%"},allowFullScreen:!0})}}])&&c(t.prototype,n),r&&c(t,r),d}(r.Component);y(m,"displayName","Streamable"),y(m,"canPlay",a.l.streamable)},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return g}));var r=n(0),i=n.n(r),o=n(1),a=n(2);function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){v(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=m(e);if(t){var i=m(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return h(this,n)}}function h(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?y(e):t}function y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(u,e);var t,n,r,s=p(u);function u(){var e;l(this,u);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return v(y(e=s.call.apply(s,[this].concat(n))),"callPlayer",o.a),v(y(e),"playerID",e.props.config.playerId||"".concat("wistia-player-").concat(Object(o.h)())),v(y(e),"onPlay",(function(){var t;return(t=e.props).onPlay.apply(t,arguments)})),v(y(e),"onPause",(function(){var t;return(t=e.props).onPause.apply(t,arguments)})),v(y(e),"onSeek",(function(){var t;return(t=e.props).onSeek.apply(t,arguments)})),v(y(e),"onEnded",(function(){var t;return(t=e.props).onEnded.apply(t,arguments)})),v(y(e),"mute",(function(){e.callPlayer("mute")})),v(y(e),"unmute",(function(){e.callPlayer("unmute")})),e}return t=u,(n=[{key:"componentDidMount",value:function(){this.props.onMount&&this.props.onMount(this)}},{key:"load",value:function(e){var t=this,n=this.props,r=n.playing,i=n.muted,a=n.controls,s=n.onReady,u=n.config,l=n.onError;Object(o.b)("https://fast.wistia.com/assets/external/E-v1.js","Wistia").then((function(){window._wq=window._wq||[],window._wq.push({id:t.playerID,options:c({autoPlay:r,silentAutoPlay:"allow",muted:i,controlsVisibleOnLoad:a,fullscreenButton:a,playbar:a,playbackRateControl:a,qualityControl:a,volumeControl:a,settingsControl:a,smallPlayButton:a},u.options),onReady:function(e){t.player=e,t.unbind(),t.player.bind("play",t.onPlay),t.player.bind("pause",t.onPause),t.player.bind("seek",t.onSeek),t.player.bind("end",t.onEnded),s()}})}),l)}},{key:"unbind",value:function(){this.player.unbind("play",this.onPlay),this.player.unbind("pause",this.onPause),this.player.unbind("seek",this.onSeek),this.player.unbind("end",this.onEnded)}},{key:"play",value:function(){this.callPlayer("play")}},{key:"pause",value:function(){this.callPlayer("pause")}},{key:"stop",value:function(){this.unbind(),this.callPlayer("remove")}},{key:"seekTo",value:function(e){this.callPlayer("time",e)}},{key:"setVolume",value:function(e){this.callPlayer("volume",e)}},{key:"setPlaybackRate",value:function(e){this.callPlayer("playbackRate",e)}},{key:"getDuration",value:function(){return this.callPlayer("duration")}},{key:"getCurrentTime",value:function(){return this.callPlayer("time")}},{key:"getSecondsLoaded",value:function(){return null}},{key:"render",value:function(){var e=this.props.url,t=e&&e.match(a.j)[1],n="wistia_embed wistia_async_".concat(t);return i.a.createElement("div",{id:this.playerID,key:t,className:n,style:{width:"100%",height:"100%"}})}}])&&f(t.prototype,n),r&&f(t,r),u}(r.Component);v(g,"displayName","Wistia"),v(g,"canPlay",a.l.wistia),v(g,"loopOnEnded",!0)},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return v}));var r=n(0),i=n.n(r),o=n(1),a=n(2);function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=y(e);if(t){var i=y(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p(this,n)}}function p(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?h(e):t}function h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var v=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(p,e);var t,n,r,s=d(p);function p(){var e;c(this,p);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return m(h(e=s.call.apply(s,[this].concat(n))),"callPlayer",o.a),m(h(e),"playerID",e.props.config.playerId||"".concat("twitch-player-").concat(Object(o.h)())),m(h(e),"mute",(function(){e.callPlayer("setMuted",!0)})),m(h(e),"unmute",(function(){e.callPlayer("setMuted",!1)})),e}return t=p,(n=[{key:"componentDidMount",value:function(){this.props.onMount&&this.props.onMount(this)}},{key:"load",value:function(e,t){var n=this,r=this.props,i=r.playsinline,s=r.onError,c=r.config,l=r.controls,f=a.g.test(e),d=f?e.match(a.g)[1]:e.match(a.h)[1];t?f?this.player.setChannel(d):this.player.setVideo("v"+d):Object(o.b)("https://player.twitch.tv/js/embed/v1.js","Twitch").then((function(e){n.player=new e.Player(n.playerID,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){m(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({video:f?"":d,channel:f?d:"",height:"100%",width:"100%",playsinline:i,autoplay:n.props.playing,muted:n.props.muted,controls:!!f||l},c.options));var t=e.Player,r=t.READY,o=t.PLAYING,a=t.PAUSE,s=t.ENDED,p=t.ONLINE,h=t.OFFLINE;n.player.addEventListener(r,n.props.onReady),n.player.addEventListener(o,n.props.onPlay),n.player.addEventListener(a,n.props.onPause),n.player.addEventListener(s,n.props.onEnded),n.player.addEventListener(p,n.props.onLoaded),n.player.addEventListener(h,n.props.onLoaded)}),s)}},{key:"play",value:function(){this.callPlayer("play")}},{key:"pause",value:function(){this.callPlayer("pause")}},{key:"stop",value:function(){this.callPlayer("pause")}},{key:"seekTo",value:function(e){this.callPlayer("seek",e)}},{key:"setVolume",value:function(e){this.callPlayer("setVolume",e)}},{key:"getDuration",value:function(){return this.callPlayer("getDuration")}},{key:"getCurrentTime",value:function(){return this.callPlayer("getCurrentTime")}},{key:"getSecondsLoaded",value:function(){return null}},{key:"render",value:function(){return i.a.createElement("div",{style:{width:"100%",height:"100%"},id:this.playerID})}}])&&l(t.prototype,n),r&&l(t,r),p}(r.Component);m(v,"displayName","Twitch"),m(v,"canPlay",a.l.twitch),m(v,"loopOnEnded",!0)},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return w}));var r=n(0),i=n.n(r),o=n(1),a=n(2);function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){b(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return f(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=g(e);if(t){var i=g(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return m(this,n)}}function m(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?v(e):t}function v(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function b(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var w=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(u,e);var t,n,r,s=y(u);function u(){var e;d(this,u);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return b(v(e=s.call.apply(s,[this].concat(n))),"callPlayer",o.a),b(v(e),"onDurationChange",(function(){var t=e.getDuration();e.props.onDuration(t)})),b(v(e),"mute",(function(){e.callPlayer("setMuted",!0)})),b(v(e),"unmute",(function(){e.callPlayer("setMuted",!1)})),b(v(e),"ref",(function(t){e.container=t})),e}return t=u,(n=[{key:"componentDidMount",value:function(){this.props.onMount&&this.props.onMount(this)}},{key:"load",value:function(e){var t=this,n=this.props,r=n.controls,i=n.config,s=n.onError,u=n.playing,f=l(e.match(a.d),2)[1];this.player?this.player.load(f,{start:Object(o.f)(e),autoplay:u}):Object(o.b)("https://api.dmcdn.net/all.js","DM","dmAsyncInit",(function(e){return e.player})).then((function(n){if(t.container){var a=n.player;t.player=new a(t.container,{width:"100%",height:"100%",video:f,params:c({controls:r,autoplay:t.props.playing,mute:t.props.muted,start:Object(o.f)(e),origin:window.location.origin},i.params),events:{apiready:t.props.onReady,seeked:function(){return t.props.onSeek(t.player.currentTime)},video_end:t.props.onEnded,durationchange:t.onDurationChange,pause:t.props.onPause,playing:t.props.onPlay,waiting:t.props.onBuffer,error:function(e){return s(e)}}})}}),s)}},{key:"play",value:function(){this.callPlayer("play")}},{key:"pause",value:function(){this.callPlayer("pause")}},{key:"stop",value:function(){}},{key:"seekTo",value:function(e){this.callPlayer("seek",e)}},{key:"setVolume",value:function(e){this.callPlayer("setVolume",e)}},{key:"getDuration",value:function(){return this.player.duration||null}},{key:"getCurrentTime",value:function(){return this.player.currentTime}},{key:"getSecondsLoaded",value:function(){return this.player.bufferedTime}},{key:"render",value:function(){var e={width:"100%",height:"100%",display:this.props.display};return i.a.createElement("div",{style:e},i.a.createElement("div",{ref:this.ref}))}}])&&p(t.prototype,n),r&&p(t,r),u}(r.Component);b(w,"displayName","DailyMotion"),b(w,"canPlay",a.l.dailymotion),b(w,"loopOnEnded",!0)},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return g}));var r=n(0),i=n.n(r),o=n(1),a=n(2);function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){v(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=m(e);if(t){var i=m(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return h(this,n)}}function h(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?y(e):t}function y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(u,e);var t,n,r,s=p(u);function u(){var e;l(this,u);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return v(y(e=s.call.apply(s,[this].concat(n))),"callPlayer",o.a),v(y(e),"duration",null),v(y(e),"currentTime",null),v(y(e),"secondsLoaded",null),v(y(e),"mute",(function(){})),v(y(e),"unmute",(function(){})),v(y(e),"ref",(function(t){e.iframe=t})),e}return t=u,(n=[{key:"componentDidMount",value:function(){this.props.onMount&&this.props.onMount(this)}},{key:"load",value:function(e){var t=this;Object(o.b)("https://widget.mixcloud.com/media/js/widgetApi.js","Mixcloud").then((function(e){t.player=e.PlayerWidget(t.iframe),t.player.ready.then((function(){t.player.events.play.on(t.props.onPlay),t.player.events.pause.on(t.props.onPause),t.player.events.ended.on(t.props.onEnded),t.player.events.error.on(t.props.error),t.player.events.progress.on((function(e,n){t.currentTime=e,t.duration=n})),t.props.onReady()}))}),this.props.onError)}},{key:"play",value:function(){this.callPlayer("play")}},{key:"pause",value:function(){this.callPlayer("pause")}},{key:"stop",value:function(){}},{key:"seekTo",value:function(e){this.callPlayer("seek",e)}},{key:"setVolume",value:function(e){}},{key:"getDuration",value:function(){return this.duration}},{key:"getCurrentTime",value:function(){return this.currentTime}},{key:"getSecondsLoaded",value:function(){return null}},{key:"render",value:function(){var e=this.props,t=e.url,n=e.config,r=t.match(a.e)[1],s=Object(o.g)(c(c({},n.options),{},{feed:"/".concat(r,"/")}));return i.a.createElement("iframe",{key:r,ref:this.ref,style:{width:"100%",height:"100%"},src:"https://www.mixcloud.com/widget/iframe/?".concat(s),frameBorder:"0"})}}])&&f(t.prototype,n),r&&f(t,r),u}(r.Component);v(g,"displayName","Mixcloud"),v(g,"canPlay",a.l.mixcloud),v(g,"loopOnEnded",!0)},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return v}));var r=n(0),i=n.n(r),o=n(1),a=n(2);function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=y(e);if(t){var i=y(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p(this,n)}}function p(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?h(e):t}function h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var v=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(p,e);var t,n,r,s=d(p);function p(){var e;c(this,p);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return m(h(e=s.call.apply(s,[this].concat(n))),"callPlayer",o.a),m(h(e),"mute",(function(){e.setVolume(0)})),m(h(e),"unmute",(function(){null!==e.props.volume&&e.setVolume(e.props.volume)})),m(h(e),"ref",(function(t){e.container=t})),e}return t=p,(n=[{key:"componentDidMount",value:function(){this.props.onMount&&this.props.onMount(this)}},{key:"load",value:function(e){var t=this,n=this.props,r=n.playing,i=n.config,s=n.onError,c=n.onDuration,l=e&&e.match(a.i)[1];this.player&&this.stop(),Object(o.b)("https://play.vidyard.com/embed/v4.js","VidyardV4","onVidyardAPI").then((function(e){t.container&&(e.api.addReadyListener((function(e,n){t.player=n,t.player.on("ready",t.props.onReady),t.player.on("play",t.props.onPlay),t.player.on("pause",t.props.onPause),t.player.on("seek",t.props.onSeek),t.player.on("playerComplete",t.props.onEnded)}),l),e.api.renderPlayer(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){m(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({uuid:l,container:t.container,autoplay:r?1:0},i.options)),e.api.getPlayerMetadata(l).then((function(e){t.duration=e.length_in_seconds,c(e.length_in_seconds)})))}),s)}},{key:"play",value:function(){this.callPlayer("play")}},{key:"pause",value:function(){this.callPlayer("pause")}},{key:"stop",value:function(){window.VidyardV4.api.destroyPlayer(this.player)}},{key:"seekTo",value:function(e){this.callPlayer("seek",e)}},{key:"setVolume",value:function(e){this.callPlayer("setVolume",e)}},{key:"setPlaybackRate",value:function(e){this.callPlayer("setPlaybackSpeed",e)}},{key:"getDuration",value:function(){return this.duration}},{key:"getCurrentTime",value:function(){return this.callPlayer("currentTime")}},{key:"getSecondsLoaded",value:function(){return null}},{key:"render",value:function(){var e={width:"100%",height:"100%",display:this.props.display};return i.a.createElement("div",{style:e},i.a.createElement("div",{ref:this.ref}))}}])&&l(t.prototype,n),r&&l(t,r),p}(r.Component);m(v,"displayName","Vidyard"),m(v,"canPlay",a.l.vidyard)},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return T}));var r=n(0),i=n.n(r),o=n(6),a=n.n(o),s=n(1),u=n(2);function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(){return(l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v(e);if(t){var i=v(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return y(this,n)}}function y(e,t){return!t||"object"!==c(t)&&"function"!=typeof t?m(e):t}function m(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function g(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var b="undefined"!=typeof navigator&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,w=/www\.dropbox\.com\/.+/,S=/https:\/\/watch\.cloudflarestream\.com\/([a-z0-9]+)/,T=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(c,e);var t,n,r,o=h(c);function c(){var e;f(this,c);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return g(m(e=o.call.apply(o,[this].concat(n))),"onReady",(function(){var t;return(t=e.props).onReady.apply(t,arguments)})),g(m(e),"onPlay",(function(){var t;return(t=e.props).onPlay.apply(t,arguments)})),g(m(e),"onBuffer",(function(){var t;return(t=e.props).onBuffer.apply(t,arguments)})),g(m(e),"onBufferEnd",(function(){var t;return(t=e.props).onBufferEnd.apply(t,arguments)})),g(m(e),"onPause",(function(){var t;return(t=e.props).onPause.apply(t,arguments)})),g(m(e),"onEnded",(function(){var t;return(t=e.props).onEnded.apply(t,arguments)})),g(m(e),"onError",(function(){var t;return(t=e.props).onError.apply(t,arguments)})),g(m(e),"onEnablePIP",(function(){var t;return(t=e.props).onEnablePIP.apply(t,arguments)})),g(m(e),"onDisablePIP",(function(t){var n=e.props,r=n.onDisablePIP,i=n.playing;r(t),i&&e.play()})),g(m(e),"onPresentationModeChange",(function(t){if(e.player&&Object(s.i)(e.player)){var n=e.player.webkitPresentationMode;"picture-in-picture"===n?e.onEnablePIP(t):"inline"===n&&e.onDisablePIP(t)}})),g(m(e),"onSeek",(function(t){e.props.onSeek(t.target.currentTime)})),g(m(e),"mute",(function(){e.player.muted=!0})),g(m(e),"unmute",(function(){e.player.muted=!1})),g(m(e),"renderSourceElement",(function(e,t){return"string"==typeof e?i.a.createElement("source",{key:t,src:e}):i.a.createElement("source",l({key:t},e))})),g(m(e),"renderTrack",(function(e,t){return i.a.createElement("track",l({key:t},e))})),g(m(e),"ref",(function(t){e.player&&(e.prevPlayer=e.player),e.player=t})),e}return t=c,(n=[{key:"componentDidMount",value:function(){this.props.onMount&&this.props.onMount(this),this.addListeners(this.player),b&&this.player.load()}},{key:"componentDidUpdate",value:function(e){this.shouldUseAudio(this.props)!==this.shouldUseAudio(e)&&(this.removeListeners(this.prevPlayer),this.addListeners(this.player))}},{key:"componentWillUnmount",value:function(){this.removeListeners(this.player),this.hls&&this.hls.destroy()}},{key:"addListeners",value:function(e){var t=this.props.playsinline;e.addEventListener("canplay",this.onReady),e.addEventListener("play",this.onPlay),e.addEventListener("waiting",this.onBuffer),e.addEventListener("playing",this.onBufferEnd),e.addEventListener("pause",this.onPause),e.addEventListener("seeked",this.onSeek),e.addEventListener("ended",this.onEnded),e.addEventListener("error",this.onError),e.addEventListener("enterpictureinpicture",this.onEnablePIP),e.addEventListener("leavepictureinpicture",this.onDisablePIP),e.addEventListener("webkitpresentationmodechanged",this.onPresentationModeChange),t&&(e.setAttribute("playsinline",""),e.setAttribute("webkit-playsinline",""),e.setAttribute("x5-playsinline",""))}},{key:"removeListeners",value:function(e){e.removeEventListener("canplay",this.onReady),e.removeEventListener("play",this.onPlay),e.removeEventListener("waiting",this.onBuffer),e.removeEventListener("playing",this.onBufferEnd),e.removeEventListener("pause",this.onPause),e.removeEventListener("seeked",this.onSeek),e.removeEventListener("ended",this.onEnded),e.removeEventListener("error",this.onError),e.removeEventListener("enterpictureinpicture",this.onEnablePIP),e.removeEventListener("leavepictureinpicture",this.onDisablePIP),e.removeEventListener("webkitpresentationmodechanged",this.onPresentationModeChange)}},{key:"shouldUseAudio",value:function(e){return!e.config.forceVideo&&!e.config.attributes.poster&&(u.a.test(e.url)||e.config.forceAudio)}},{key:"shouldUseHLS",value:function(e){return!!this.props.config.forceHLS||!b&&(u.c.test(e)||S.test(e))}},{key:"shouldUseDASH",value:function(e){return u.b.test(e)||this.props.config.forceDASH}},{key:"load",value:function(e){var t=this,n=this.props.config,r=n.hlsVersion,i=n.hlsOptions,o=n.dashVersion,u=n.drm,c=n.forceSHAKA,l=this.props,f=l.setHlsPolyNet,d=l.setDashPolyNet,p=l.setPrometheanTv;if(this.hls&&this.hls.destroy(),this.dash&&this.dash.reset(),this.shouldUseHLS(e)&&Object(s.b)("https://cdn.jsdelivr.net/npm/hls.js@VERSION/dist/hls.min.js".replace("VERSION",r),"Hls").then((function(n){if(t.hls=new n(i),t.hls.on(n.Events.ERROR,(function(e,r){t.props.onError(e,r,t.hls,n)})),f&&f(t.hls),S.test(e)){var r=e.match(S)[1];console.log("https://videodelivery.net/{id}/manifest/video.m3u8".replace("{id}",r)),t.hls.loadSource("https://videodelivery.net/{id}/manifest/video.m3u8".replace("{id}",r))}else t.hls.loadSource(e);t.hls.attachMedia(t.player)})),this.shouldUseDASH(e)&&(c?(a.a.polyfill.installAll(),a.a.Player.isBrowserSupported()?(this.shaka=new a.a.Player(this.player),d&&d(this.shaka),u&&Object.keys(u).length&&this.shaka.configure({drm:u}),this.shaka.load(e).then((function(){return console.log("Video loaded successfully")})).catch((function(e){return console.error("Failed to load video",e)}))):console.error("Browser not supported!")):Object(s.b)("https://cdnjs.cloudflare.com/ajax/libs/dashjs/VERSION/dash.all.min.js".replace("VERSION",o),"dashjs").then((function(n){if(t.dash=n.MediaPlayer().create(),d&&d(t.dash),t.dash.initialize(t.player,e,t.props.playing),p&&p("dash",t.dash),t.dash.on("error",t.props.onError),parseInt(o)<3?t.dash.getDebug().setLogToBrowserConsole(!1):t.dash.updateSettings({debug:{logLevel:n.Debug.LOG_LEVEL_NONE}}),u&&u.servers){var r=Object.keys(u.servers);r.length&&t.dash.setProtectionData(g({},r[0],{serverURL:u.servers[r[0]]}))}}))),e instanceof Array)this.player.load();else if(Object(s.c)(e))try{this.player.srcObject=e}catch(t){this.player.src=window.URL.createObjectURL(e)}}},{key:"play",value:function(){var e=this.player.play();e&&e.catch(this.props.onError)}},{key:"pause",value:function(){this.player.pause()}},{key:"stop",value:function(){this.player.removeAttribute("src"),this.dash&&this.dash.reset()}},{key:"seekTo",value:function(e){this.player.currentTime=e}},{key:"setVolume",value:function(e){this.player.volume=e}},{key:"enablePIP",value:function(){this.player.requestPictureInPicture&&document.pictureInPictureElement!==this.player?this.player.requestPictureInPicture():Object(s.i)(this.player)&&"picture-in-picture"!==this.player.webkitPresentationMode&&this.player.webkitSetPresentationMode("picture-in-picture")}},{key:"disablePIP",value:function(){document.exitPictureInPicture&&document.pictureInPictureElement===this.player?document.exitPictureInPicture():Object(s.i)(this.player)&&"inline"!==this.player.webkitPresentationMode&&this.player.webkitSetPresentationMode("inline")}},{key:"setPlaybackRate",value:function(e){this.player.playbackRate=e}},{key:"getDuration",value:function(){if(!this.player)return null;var e=this.player,t=e.duration,n=e.seekable;return t===1/0&&n.length>0?n.end(n.length-1):t}},{key:"getCurrentTime",value:function(){return this.player?this.player.currentTime:null}},{key:"getSecondsLoaded",value:function(){if(!this.player)return null;var e=this.player.buffered;if(0===e.length)return 0;var t=e.end(e.length-1),n=this.getDuration();return t>n?n:t}},{key:"getSource",value:function(e){var t=this.shouldUseHLS(e),n=this.shouldUseDASH(e);if(!(e instanceof Array||Object(s.c)(e)||t||n))return w.test(e)?e.replace("www.dropbox.com","dl.dropboxusercontent.com"):e}},{key:"render",value:function(){var e=this.props,t=e.url,n=e.playing,r=e.loop,o=e.controls,a=e.muted,s=e.config,u=e.width,c=e.height,f=this.shouldUseAudio(this.props)?"audio":"video",d={width:"auto"===u?u:"100%",height:"auto"===c?c:"100%"};return i.a.createElement(f,l({ref:this.ref,src:this.getSource(t),style:d,preload:"auto",autoPlay:n||void 0,controls:o,muted:a,loop:r},s.attributes),t instanceof Array&&t.map(this.renderSourceElement),s.tracks.map(this.renderTrack))}}])&&d(t.prototype,n),r&&d(t,r),c}(r.Component);g(T,"displayName","FilePlayer"),g(T,"canPlay",u.l.file)},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return v}));var r=n(0),i=n.n(r);function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){y(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h(e);if(t){var i=h(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return d(this,n)}}function d(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?p(e):t}function p(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var m={},v=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(a,e);var t,n,r,o=f(a);function a(){var e;u(this,a);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return y(p(e=o.call.apply(o,[this].concat(n))),"mounted",!1),y(p(e),"state",{image:null}),y(p(e),"handleKeyPress",(function(t){"Enter"!==t.key&&" "!==t.key||e.props.onClick()})),e}return t=a,(n=[{key:"componentDidMount",value:function(){this.mounted=!0,this.fetchImage(this.props)}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.url,r=t.light;e.url===n&&e.light===r||this.fetchImage(this.props)}},{key:"componentWillUnmount",value:function(){this.mounted=!1}},{key:"fetchImage",value:function(e){var t=this,n=e.url,r=e.light;if("string"!=typeof r){if(!m[n])return this.setState({image:null}),window.fetch("https://noembed.com/embed?url=".concat(n)).then((function(e){return e.json()})).then((function(e){if(e.thumbnail_url&&t.mounted){var r=e.thumbnail_url.replace("height=100","height=480");t.setState({image:r}),m[n]=r}}));this.setState({image:m[n]})}else this.setState({image:r})}},{key:"render",value:function(){var e=this.props,t=e.onClick,n=e.playIcon,r=this.state.image,o={display:"flex",alignItems:"center",justifyContent:"center"},a={preview:s({width:"100%",height:"100%",backgroundImage:r?"url(".concat(r,")"):void 0,backgroundSize:"cover",backgroundPosition:"center",cursor:"pointer"},o),shadow:s({background:"radial-gradient(rgb(0, 0, 0, 0.3), rgba(0, 0, 0, 0) 60%)",borderRadius:"64px",width:"64px",height:"64px"},o),playIcon:{borderStyle:"solid",borderWidth:"16px 0 16px 26px",borderColor:"transparent transparent transparent white",marginLeft:"7px"}},u=i.a.createElement("div",{style:a.shadow,className:"react-player__shadow"},i.a.createElement("div",{style:a.playIcon,className:"react-player__play-icon"}));return i.a.createElement("div",{style:a.preview,className:"react-player__preview",onClick:t,tabIndex:0,onKeyPress:this.handleKeyPress},n||u)}}])&&c(t.prototype,n),r&&c(t,r),a}(r.Component)}]).default;
//# sourceMappingURL=ReactPlayer.js.map